<!doctype html><html lang=ko dir=ltr class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>"php" 태그로 연결된 49개 게시물개의 게시물이 있습니다. | gracefullight.dev</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:url content=https://gracefullight.dev/tags/php/page/3/ /><meta data-rh=true property=og:locale content=ko /><meta data-rh=true property=og:locale:alternate content=en /><meta data-rh=true name=docusaurus_locale content=ko /><meta data-rh=true name=docsearch:language content=ko /><meta data-rh=true content=gcY9SiftHgQoJjBZ7IgwNNN5_atLPAX6kWb1nFVfa6E name=google-site-verification /><meta data-rh=true content=65AD1E28C0D057CEB3C68FBC0293E55B name=msvalidate.01 /><meta data-rh=true content=d024c2837887f72dc7b3792b958be74d69ba9593 name=naver-site-verification /><meta data-rh=true content=f7c93483a6f87c79 name=yandex-verification /><meta data-rh=true content=yZEdU1ABcR name=baidu-site-verification /><meta data-rh=true content=uelupjqqsm5egzlhy1aev2rfxow5yt name=facebook-domain-verification /><meta data-rh=true property=og:title content='"php" 태그로 연결된 49개 게시물개의 게시물이 있습니다. | gracefullight.dev'/><meta data-rh=true name=docusaurus_tag content=blog_tags_posts /><meta data-rh=true name=docsearch:docusaurus_tag content=blog_tags_posts /><link data-rh=true rel=icon href=/img/favicon.ico /><link data-rh=true rel=canonical href=https://gracefullight.dev/tags/php/page/3/ /><link data-rh=true rel=alternate href=https://gracefullight.dev/tags/php/page/3/ hreflang=ko /><link data-rh=true rel=alternate href=https://gracefullight.dev/en/tags/php/page/3/ hreflang=en /><link data-rh=true rel=alternate href=https://gracefullight.dev/tags/php/page/3/ hreflang=x-default /><link data-rh=true rel=preconnect href=https://RFS69RSYOJ-dsn.algolia.net crossorigin=anonymous /><link rel=alternate type=application/rss+xml href=/rss.xml title="gracefullight.dev RSS Feed"><link rel=alternate type=application/atom+xml href=/atom.xml title="gracefullight.dev Atom Feed"><link rel=alternate type=application/json href=/feed.json title="gracefullight.dev JSON Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-E99DNE7S05"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-E99DNE7S05",{})</script><link rel=search type=application/opensearchdescription+xml title=gracefullight.dev href=/opensearch.xml><link href=/img/favicon-32x32.png rel=icon><link href=/manifest.json rel=manifest><meta content=#f28913 name=theme-color><meta content=yes name=mobile-web-app-capable><meta content=#f28913 name=apple-mobile-web-app-status-bar-style><link href=/img/apple-touch-icon.png rel=apple-touch-icon><link rel=preconnect href=https://pagead2.googlesyndication.com><script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3004788392777865" async crossorigin=anonymous></script><link rel=preconnect href=https://www.clarity.ms><script>!function(t,e,n,a,c,i,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(i=e.createElement(a)).async=1,i.src="https://www.clarity.ms/tag/"+c,(r=e.getElementsByTagName(a)[0]).parentNode.insertBefore(i,r)}(window,document,"clarity","script","aongv9xgi6")</script><link rel=preconnect href=https://wcs.naver.net><script src=https://wcs.naver.net/wcslog.js async></script><script>if(!wcs_add)var wcs_add={};wcs_add.wa="156bc73a81e3bd0",window.wcs&&wcs_do()</script><link rel=preconnect href=https://cdn.channel.io><script>!function(){var n=window;if(n.ChannelIO)return(window.console.error||window.console.log||function(){})("ChannelIO script included twice.");var e=function(){e.c(arguments)};function t(){if(!n.ChannelIOInitialized){n.ChannelIOInitialized=!0;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://cdn.channel.io/plugin/ch-plugin-web.js",e.charset="UTF-8";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}}e.q=[],e.c=function(n){e.q.push(n)},n.ChannelIO=e,"complete"===document.readyState?t():window.attachEvent?window.attachEvent("onload",t):(window.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1))}(),ChannelIO("boot",{pluginKey:"0fd130ba-a1a6-4b7e-802a-e82a885a7fd8"})</script><link rel=preconnect href=https://static.cloudflareinsights.com><script src=https://static.cloudflareinsights.com/beacon.min.js defer data-cf-beacon='{"token":"c0899829e72b45e98dff77241127252c"}'></script><link href=https://mc.yandex.ru rel=preconnect><script>!function(e,t,c,n,r,a,s){e[r]=e[r]||function(){(e[r].a=e[r].a||[]).push(arguments)},e[r].l=+new Date;for(var i=0;i<document.scripts.length;i++)if(document.scripts[i].src===n)return;a=t.createElement(c),s=t.getElementsByTagName(c)[0],a.async=1,a.src=n,s.parentNode.insertBefore(a,s)}(window,document,"script","https://mc.yandex.ru/metrika/tag.js?id=104072655","ym"),ym(0x63405cf,"init",{ssr:!0,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!1})</script><link href=https://cdn.jsdelivr.net rel=preconnect><script type=application/ld+json>{"@context":"http://schema.org","@type":"Person","email":"mailto:gracefullight.dev@gmail.com","image":"https://avatars.githubusercontent.com/u/11773683?v=4","jobTitle":"FullStack JavaScript Developer","logo":"https://gracefullight.dev/img/apple-touch-icon.png","name":"Eunkwang Shin","nationality":"Korean","sameAs":["https://github.com/gracefullight","https://linkedin.com/in/gracefullight"],"url":"https://gracefullight.dev"}</script><link rel=stylesheet crossorigin=anonymous href=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css type=text/css><link rel=stylesheet href=/assets/css/styles.775e2857.css /><script src=/assets/js/runtime~main.8c99d553.js defer></script><script src=/assets/js/main.55b7c064.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/img/favicon-32x32.png /><link rel=preload as=image href="https://avatars.githubusercontent.com/u/11773683?v=4"/><div role=region aria-label="본문으로 건너뛰기"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>본문으로 건너뛰기</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/favicon-32x32.png alt="gracefullight.dev blog logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/img/favicon-32x32.png alt="gracefullight.dev blog logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">gracefullight.dev</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>한국어</a><ul class=dropdown__menu><li><a href=/tags/php/page/3/ target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=ko>한국어</a><li><a href=/en/tags/php/page/3/ target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a></ul></div><a class="navbar__item navbar__link" href=/archive/>Archives</a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/tags/>Tags</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="어두운 모드와 밝은 모드 전환하기 (현재 system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="검색 (Meta+k)" aria-keyshortcuts=Meta+k><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 24 24" aria-hidden=true><circle cx=11 cy=11 r=8 stroke=currentColor fill=none stroke-width=1.4 /><path d="m21 21-4.3-4.3" stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>검색</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class=row><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="최근 블로그 문서 둘러보기"><div class="sidebarItemTitle_pO2u margin-bottom--md">최근 포스트</div><div role=group><h3 class=yearGroupHeading_rMGB>2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/2026/02/27/free-up-storage-space-on-mac/>Free up storage space on mac</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/2026/02/27/promoting-an-opensource-project/>Promoting an opensource project</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/2026/02/24/iqc-002/>IQC 002</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/2026/02/23/tim-002/>TIM 002</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/2026/02/17/innovation-tactics/>Innovation Tactics</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/2026/01/31/agentic-sdlc/>Agentic SDLC</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/2026/01/29/local-docker-env/>로컬 도커 환경 툴 비교</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/vocab/phrasal-verbs-01/>Phrasal Verbs 01</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/vocab/phrasal-verbs-014/>Phrasal Verbs 014</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/vocab/phrasal-verbs-013/>Phrasal Verbs 013</a></ul></div></nav></aside><main class="col col--7"><header class=margin-bottom--xl><h1>"php" 태그로 연결된 49개 게시물개의 게시물이 있습니다.</h1><a href=/tags/>모든 태그 보기</a></header><article class=margin-bottom--xl><header><h2 class=title_f1Hy><a href=/2017/07/21/Laravel-Log-debug-vs-logger/>Laravel - Log::debug vs logger</a></h2><div class="container_mt6G margin-vert--md"><time datetime=2017-07-21T00:46:35.000Z>2017년 7월 21일</time> · <!-- -->약 1분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class=avatar__photo-link href=/authors/me/><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"/></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=/authors/me/><span class=authorName_yefp translate=no>Eunkwang Shin</span></a></div><small class=authorTitle_nd0D title=Owner>Owner</small><div class=authorSocials_rSDt><a href=https://www.linkedin.com/in/gracefullight/ target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=LinkedIn><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em preserveAspectRatio=xMidYMid viewBox="0 0 256 256" style=--dark:#0a66c2;--light:#ffffffe6 class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"/></svg></a><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=GitHub><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 256 250" preserveAspectRatio=xMidYMid style=--dark:#000;--light:#fff class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"/></svg></a><a href=mailto:gracefullight.dev@gmail.com target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=Email><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 class=authorSocialIcon_XYv3><path stroke=none d="M0 0h24v24H0z"/><path d="M7.2 12a4.8 4.8 0 1 0 9.6 0 4.8 4.8 0 1 0-9.6 0"/><path d="M16.8 12v1.8a3 3 0 0 0 6 0V12a10.8 10.8 0 1 0-6.6 9.936"/></svg></a></div></div></div></div></div></header><div class=markdown><p>로그를 찍기 위해서 Log 파사드 또는 logger 헬퍼 함수를 사용할 수 있다.</p>
<p>두 함수의 차이점은 무엇일까?</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=logdebug>Log::debug<a href=#logdebug class=hash-link aria-label="Log::debug에 대한 직접 링크" title="Log::debug에 대한 직접 링크" translate=no>​</a></h2>
<ul>
<li class="">Log 파사드가 정의되어있어야 한다. <code>use Log;</code></li>
<li class="">NULL 값이 들어올시 <strong>NULL이 로그에 출력</strong>된다.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=logger>logger<a href=#logger class=hash-link aria-label="logger에 대한 직접 링크" title="logger에 대한 직접 링크" translate=no>​</a></h2>
<ul>
<li class="">헬퍼함수라 Log 파사드 없이 사용 가능하다.</li>
<li class="">NULL 값이 들어올시 아무 내용도 찍히지 않는다.</li>
<li class="">debug 레벨이 기본이라, 다른 레벨의 로그를 찍으려면 <code>logger()->error('에러 로그');</code> 처럼 함수를 하나 더 호출해야한다.</li>
<li class="">단, info 레벨 로그는 <code>info();</code> 헬퍼 함수를 사용할 수 있다.</li>
</ul></div><footer class="row docusaurus-mt-lg"><div class=col><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/php/>php</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/laravel/>laravel</a></ul></div></footer></article><article class=margin-bottom--xl><header><h2 class=title_f1Hy><a href=/2017/07/19/Laravel-5-4-Mail-to-Japan/>Laravel 5.5 - 일본으로 메일 보내기</a></h2><div class="container_mt6G margin-vert--md"><time datetime=2017-07-19T00:11:01.000Z>2017년 7월 19일</time> · <!-- -->약 2분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class=avatar__photo-link href=/authors/me/><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"/></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=/authors/me/><span class=authorName_yefp translate=no>Eunkwang Shin</span></a></div><small class=authorTitle_nd0D title=Owner>Owner</small><div class=authorSocials_rSDt><a href=https://www.linkedin.com/in/gracefullight/ target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=LinkedIn><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em preserveAspectRatio=xMidYMid viewBox="0 0 256 256" style=--dark:#0a66c2;--light:#ffffffe6 class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"/></svg></a><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=GitHub><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 256 250" preserveAspectRatio=xMidYMid style=--dark:#000;--light:#fff class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"/></svg></a><a href=mailto:gracefullight.dev@gmail.com target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=Email><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 class=authorSocialIcon_XYv3><path stroke=none d="M0 0h24v24H0z"/><path d="M7.2 12a4.8 4.8 0 1 0 9.6 0 4.8 4.8 0 1 0-9.6 0"/><path d="M16.8 12v1.8a3 3 0 0 0 6 0V12a10.8 10.8 0 1 0-6.6 9.936"/></svg></a></div></div></div></div></div></header><div class=markdown><p>일본 통신사 중 소프트뱅크와 AU는 UTF8 메일이 깨져서 들어간다. (도코모는 정상적)
Laravel 뿐아니라 일본으로 메일을 보내고 싶다면, 이 포스팅의 방식대로 접근하면 된다.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=iso-2022-jp>iso-2022-jp<a href=#iso-2022-jp class=hash-link aria-label="iso-2022-jp에 대한 직접 링크" title="iso-2022-jp에 대한 직접 링크" translate=no>​</a></h2>
<p>먼저 인코딩을 iso-2022-jp로 바꿔줘야한다.</p>
<blockquote>
<p>테스트 결과 JIS 인코딩과 같다.
SJIS 인코딩도 있는데 위 인코딩에 몇가지 특수문자가 추가된 형태이다.</p>
</blockquote>
<p>AppServiceProvider에 메일 인코딩을 전역으로 설정하자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Providers/AppServiceProvider.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Swift</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Swift_DependencyContainer</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Swift_Preferences</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"> </span><span class="token class-name-definition class-name">AppServiceProvider</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>extends</span><span class="token plain"> </span><span class="token class-name">ServiceProvider</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>register</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// laravel의 메일 패키지는 Swift이므로 당황하지말자</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token class-name static-context">Swift</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>init</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>function</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// 헤더를 추가하고</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token class-name static-context">Swift_DependencyContainer</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>getInstance</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>register</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'mime.qpheaderencoder'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>asAliasOf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'mime.base64headerencoder'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// 인코딩을 변경한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token class-name static-context">Swift_Preferences</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>getInstance</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>setCharset</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'iso-2022-jp'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=7bit>7bit<a href=#7bit class=hash-link aria-label="7bit에 대한 직접 링크" title="7bit에 대한 직접 링크" translate=no>​</a></h2>
<p>위키를 참조해보면 iso-2022는 문자열을 7bit 또는 8bit로 표현하는 기술이다. 근데, 소프트뱅크 문서에 7bit로 달란다.
메일 폼을 열어서 build시에 인코딩 바이트를 변경하자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Mail/YourMailForm.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Swift_Mime_ContentEncoder_PlainContentEncoder</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"> </span><span class="token class-name-definition class-name">YourMailForm</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>extends</span><span class="token plain"> </span><span class="token class-name">Mailable</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>build</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>subject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'ご注文を承りました。'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>view</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'mail.your_mail_view'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>withSwiftMessage</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>function</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$message</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">              </span><span class="token comment" style=color:#999988;font-style:italic>// 전역으로 설정한 뒤에 이 메소드를 빼보고 테스트를 못 해봤다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">              </span><span class="token comment" style=color:#999988;font-style:italic>// 다음 분이 빼고 테스트 부탁드려요 : )</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">              </span><span class="token variable" style=color:#36acaa>$message</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>setCharset</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'iso-2022-jp'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">              </span><span class="token comment" style=color:#999988;font-style:italic>// 인코딩 바이트를 바꿔준다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">              </span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>setEncoder</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token class-name">Swift_Mime_ContentEncoder_PlainContentEncoder</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'7bit'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">          </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=mailview>mail.view<a href=#mailview class=hash-link aria-label="mail.view에 대한 직접 링크" title="mail.view에 대한 직접 링크" translate=no>​</a></h2>
<p>가장 중요한 것은 Mail View에서도 charset meta tag를 등록해줘야 한다는 것이다.
이 걸 세팅안하고 얼마나 삽질을 해댔는지, 없던 이두근이 생길지경.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>resources/view/mail/your_mail_view.blade.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">html</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">head</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">meta http</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">equiv</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"Content-Type"</span><span class="token plain"> content</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"text/html; charset=iso-2022-jp"</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">head</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">body</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">body</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">html</span><span class="token operator" style=color:#393A34>></span><br/></span></code></pre></div></div>
<p>이렇게 세팅을 하고 메일을 보내면 정상적으로 보내지는 걸 확인할 수 있다.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=여담>여담<a href=#여담 class=hash-link aria-label="여담에 대한 직접 링크" title="여담에 대한 직접 링크" translate=no>​</a></h2>
<p>세 가지만 기억하자.</p>
<ul>
<li class="">iso-2022-jp</li>
<li class="">7bit</li>
<li class="">meta[charset="iso-2022-jp"]</li>
</ul></div><footer class="row docusaurus-mt-lg"><div class=col><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/php/>php</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/laravel/>laravel</a></ul></div></footer></article><article class=margin-bottom--xl><header><h2 class=title_f1Hy><a href=/2017/07/09/Laravel-5-4-Login-with-Auth/>Laravel 5.5 - 로그인(Auth) 붙히기</a></h2><div class="container_mt6G margin-vert--md"><time datetime=2017-07-09T22:46:57.000Z>2017년 7월 9일</time> · <!-- -->약 7분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class=avatar__photo-link href=/authors/me/><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"/></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=/authors/me/><span class=authorName_yefp translate=no>Eunkwang Shin</span></a></div><small class=authorTitle_nd0D title=Owner>Owner</small><div class=authorSocials_rSDt><a href=https://www.linkedin.com/in/gracefullight/ target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=LinkedIn><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em preserveAspectRatio=xMidYMid viewBox="0 0 256 256" style=--dark:#0a66c2;--light:#ffffffe6 class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"/></svg></a><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=GitHub><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 256 250" preserveAspectRatio=xMidYMid style=--dark:#000;--light:#fff class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"/></svg></a><a href=mailto:gracefullight.dev@gmail.com target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=Email><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 class=authorSocialIcon_XYv3><path stroke=none d="M0 0h24v24H0z"/><path d="M7.2 12a4.8 4.8 0 1 0 9.6 0 4.8 4.8 0 1 0-9.6 0"/><path d="M16.8 12v1.8a3 3 0 0 0 6 0V12a10.8 10.8 0 1 0-6.6 9.936"/></svg></a></div></div></div></div></div></header><div class=markdown><p><a class="" href=/2017/06/06/Laravel-5-4-Eloquent-Model/>이전 포스팅</a>에서 데이터를 가져왔으니, 로그인을 구현해보자.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=basic-auth>Basic Auth<a href=#basic-auth class=hash-link aria-label="Basic Auth에 대한 직접 링크" title="Basic Auth에 대한 직접 링크" translate=no>​</a></h2>
<p>라라벨에서 제공하는 회원가입, 로그인, 비밀번호 찾기 기능을 사용하고 싶다면 artisan 명령어로 간단하게 시작할 수 있다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">php artisan make:auth</span><br/></span></code></pre></div></div>
<p>명령어를 실행하면 <strong>resources/views/auth</strong> 폴더에 뷰가 <strong>app/Http/Controllers/Auth</strong>에 로직이 생성되고 <strong>routes/web.php</strong>에 라우팅이 등록된다.
DB도 같이 만들고 싶다면 <a href=https://laravel.com/docs/5.4/authentication target=_blank rel="noopener noreferrer" class="">Docs</a>를 따라하자.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=다른-테이블-사용>다른 테이블 사용<a href=#다른-테이블-사용 class=hash-link aria-label="다른 테이블 사용에 대한 직접 링크" title="다른 테이블 사용에 대한 직접 링크" translate=no>​</a></h3>
<p>제공된 user 테이블을 안 쓰려면 커스터마이징이 필요하다.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=설정-변경>설정 변경<a href=#설정-변경 class=hash-link aria-label="설정 변경에 대한 직접 링크" title="설정 변경에 대한 직접 링크" translate=no>​</a></h4>
<p><strong>config/auth.php</strong> 파일로 이동해 다른 모델을 등록하자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>config/auth.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token string single-quoted-string" style=color:#e3116c>'providers'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token string single-quoted-string" style=color:#e3116c>'users'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'driver'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'eloquent'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 여기에 사용할 모델을 등록한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'model'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified static-context">App</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Models</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Member</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>]</span><br/></span></code></pre></div></div>
<blockquote>
<p>config 안의 파일을 변경하면 config<!-- -->:clear<!-- -->를 실행해 혹시 모를 캐시를 날려주자</p>
</blockquote>
<p>그리고 <strong>app/Models/Member.php</strong>로 이동해 내 모델을 라라벨 기본 인증 모듈을 사용할 수 있게 추가해야한다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Models/Member.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 라라벨 인증 사용</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Foundation</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Auth</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">User</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> Authenticatable</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 비밀번호 변경 메일을 위해 필요한 trait</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Notifications</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Notifiable</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// Authenticatable 를 상속받는다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"> </span><span class="token class-name-definition class-name">Member</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>extends</span><span class="token plain"> </span><span class="token class-name">Authenticatable</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Notifiable trait를 추가한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Notifiable</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$guarded</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'member_id'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'remember_token'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$hidden</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'password'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'remember_token'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=인증-필드-변경>인증 필드 변경<a href=#인증-필드-변경 class=hash-link aria-label="인증 필드 변경에 대한 직접 링크" title="인증 필드 변경에 대한 직접 링크" translate=no>​</a></h4>
<p>Basic Auth는 기본 필드를 email로 잡고 있기 때문에 id 필드를 사용하게 변경해야한다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Http/Controllers/Auth/LoginController.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// username 메소드를 추가</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>username</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 반환할 필드를 선언한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'id'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=회원가입-후-자동로그인>회원가입 후 자동로그인<a href=#회원가입-후-자동로그인 class=hash-link aria-label="회원가입 후 자동로그인에 대한 직접 링크" title="회원가입 후 자동로그인에 대한 직접 링크" translate=no>​</a></h3>
<p>회원가입이 성공하면 세션을 생성해줘야한다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Http/Controllers/Auth/RegisterController.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// registered 메소드를 Override</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>registered</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name type-declaration">Request</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$user</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 세션 생성</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Auth</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>attempt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'id'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>input</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'id'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'password'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>input</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'password'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>response</span><span class="token punctuation" style=color:#393A34>(</span><span class="token constant" style=color:#36acaa>null</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>204</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=ajax-처리>ajax 처리<a href=#ajax-처리 class=hash-link aria-label="ajax 처리에 대한 직접 링크" title="ajax 처리에 대한 직접 링크" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=로그인>로그인<a href=#로그인 class=hash-link aria-label="로그인에 대한 직접 링크" title="로그인에 대한 직접 링크" translate=no>​</a></h4>
<p>로그인을 ajax로 처리해야될 경우 커스터마이징이 필요하다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Http/Controllers/Auth/LoginController.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// authenticated 메소드를 Override</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>authenticated</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name type-declaration">Request</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$user</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 인증이 된 경우 페이지 전환이 아닌 전환될 페이지를 json으로 반환한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>ajax</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>response</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>json</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'href'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token function" style=color:#d73a49>url</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>previous</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>abort</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>405</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=비밀번호-찾기>비밀번호 찾기<a href=#비밀번호-찾기 class=hash-link aria-label="비밀번호 찾기에 대한 직접 링크" title="비밀번호 찾기에 대한 직접 링크" translate=no>​</a></h4>
<p>비밀번호 찾기를 ajax로 처리해야될 경우 커스터마이징이 필요하다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Http/Controllers/Auth/ForgotPasswordController.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>sendResetLinkEmail</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name type-declaration">Request</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>validateId</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$request</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// email이 아닌 아이디로 검색을 해 메일을 찾고 싶다면</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$data</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token class-name static-context">Member</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'id'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>only</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'id'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>first</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string single-quoted-string" style=color:#e3116c>'email'</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$email</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>isset</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$data</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>email</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>?</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$data</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>email</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>null</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 여기서 email이 User Model(Member Model)에 바인딩된다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 아래의 sendPasswordResetNotification 메소드에서 $this->email 값이다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$response</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>broker</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>sendResetLink</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'email'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$email</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 리턴 값을 변경해주자.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>response</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>json</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'email'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$email</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$response</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token class-name static-context">Password</span><span class="token operator" style=color:#393A34>::</span><span class="token constant" style=color:#36acaa>RESET_LINK_SENT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>?</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>200</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>500</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=routing-예외>routing 예외<a href=#routing-예외 class=hash-link aria-label="routing 예외에 대한 직접 링크" title="routing 예외에 대한 직접 링크" translate=no>​</a></h3>
<p>ajax 요청으로 바꿨다면 굳이 필요없는 기본 route는 등록할 필요가 없다. (예를 들면 로그인 페이지)
먼저 <strong>routes/web.php</strong>에서 <code>Auth::routes();</code> 를 지워주고 라라벨 route 파일을 열어보자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>vendor/laravel/Illuminate/Routing/Router.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// 994 라인</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>auth</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Authentication Routes...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'login'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'Auth\LoginController@showLoginForm'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>name</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'login'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>post</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'login'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'Auth\LoginController@login'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>post</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'logout'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'Auth\LoginController@logout'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>name</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'logout'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Registration Routes...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'register'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'Auth\RegisterController@showRegistrationForm'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>name</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'register'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>post</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'register'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'Auth\RegisterController@register'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Password Reset Routes...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'password/reset'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'Auth\ForgotPasswordController@showLinkRequestForm'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>name</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'password.request'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>post</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'password/email'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'Auth\ForgotPasswordController@sendResetLinkEmail'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>name</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'password.email'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'password/reset/{token}'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'Auth\ResetPasswordController@showResetForm'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>name</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'password.reset'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>post</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'password/reset'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'Auth\ResetPasswordController@reset'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<p>입맛에 맞게 web.php로 가져와 사용하자.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=notification-예외>notification 예외<a href=#notification-예외 class=hash-link aria-label="notification 예외에 대한 직접 링크" title="notification 예외에 대한 직접 링크" translate=no>​</a></h3>
<p>Noticifation은 사용자에게 빠르게 알림을 보낼 수 있는 기능이지만, 정해져 있는 템플릿을 사용하므로 커스터마이징이 되게 힘들다.
비밀번호 찾기시에 보낼 메일을 정해진 템플릿을 사용할 수 없다면 메소드를 수정하자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Models/Member.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 이 메소드를 override해야한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 첫 파라미터는 비밀번호 인증용 token이 들어온다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>sendPasswordResetNotification</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$token</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Mail</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>to</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>email</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>send</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token class-name">PasswordReset</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$token</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=auth>Auth<a href=#auth class=hash-link aria-label="Auth에 대한 직접 링크" title="Auth에 대한 직접 링크" translate=no>​</a></h2>
<p>Basic Auth를 사용하는데 건드려야 되는 곳이 많으므로 Auth 모듈만 사용하는게 정신건강에 좋다고 본다.
(Bootstrap 기반의 Laravel에 딱 맞는 모양을 입은 프로젝트라면 기본 인증이 좋겠지만)</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=로그인-1>로그인<a href=#로그인-1 class=hash-link aria-label="로그인에 대한 직접 링크" title="로그인에 대한 직접 링크" translate=no>​</a></h3>
<p><strong>먼저 사용할 모델에 Authenticatable 클래스를 상속 받자</strong>
그리고 LoginController에서 <strong>Auth::attempt()</strong> 메소드를 실행하면 끝이다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Http/Controllers/LoginController.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>login</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name type-declaration">Request</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$password</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>password</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name static-context">Auth</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>attempt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'id'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>id</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'password'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$password</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>response</span><span class="token punctuation" style=color:#393A34>(</span><span class="token constant" style=color:#36acaa>null</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>200</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token keyword" style=color:#00009f>else</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>abort</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>401</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=not-bcrypt>not bcrypt<a href=#not-bcrypt class=hash-link aria-label="not bcrypt에 대한 직접 링크" title="not bcrypt에 대한 직접 링크" translate=no>​</a></h4>
<p>Auth 모듈은 기본으로 bcrypt를 사용해 비밀번호를 암호화하고 비교하는데 다른 암호화 방식을 사용해야하는 경우가 있다.
bcrypt를 사용하지 않게 처리해보자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Models/Member.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// 이 메소드를 override 해야한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>getAuthPassword</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// bcrypt 비교를 하지 않기 위해 강제로 해시를 생성한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token class-name static-context">Hash</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>make</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>password</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<p>이제 <strong>Auth::attempt()</strong> 메소드에 패스워드를 넘길 때 암호화를 해주고 넘기면 된다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=n개의-세션>N개의 세션<a href=#n개의-세션 class=hash-link aria-label="N개의 세션에 대한 직접 링크" title="N개의 세션에 대한 직접 링크" translate=no>​</a></h3>
<p>관리자와 회원은 같은 세션을 사용하면 안 된다. 세션을 분기해보자.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=모델-생성>모델 생성<a href=#모델-생성 class=hash-link aria-label="모델 생성에 대한 직접 링크" title="모델 생성에 대한 직접 링크" translate=no>​</a></h4>
<p>먼저 모델을 하나 만들고 Authenticatable 클래스를 상속받는다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Models/Admin.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Foundation</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Auth</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">User</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> Authenticatable</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"> </span><span class="token class-name-definition class-name">Admin</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>extends</span><span class="token plain"> </span><span class="token class-name">Authenticatable</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 속성은 테이블에 맞게 알아서 정리하자</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=설정-추가>설정 추가<a href=#설정-추가 class=hash-link aria-label="설정 추가에 대한 직접 링크" title="설정 추가에 대한 직접 링크" translate=no>​</a></h4>
<p>만든 모델을 Laravel Auth에서 사용한다고 등록을 해줘야한다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>config/auth.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token string single-quoted-string" style=color:#e3116c>'guards'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 아래에 등록된 provider를 admin이란 이름의 guard로 사용</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'driver'</span><span class="token plain">   </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'session'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'provider'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token string single-quoted-string" style=color:#e3116c>'providers'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 방금 만든 모델을 Auth의 Provider로 등록</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'driver'</span><span class="token plain">   </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'eloquent'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'model'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified static-context">App</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Models</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Admin</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<p>passowrds 속성은 제공되는 password_resets 기능을 사용할 경우에만 추가해주면 된다.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=미들웨어>미들웨어<a href=#미들웨어 class=hash-link aria-label="미들웨어에 대한 직접 링크" title="미들웨어에 대한 직접 링크" translate=no>​</a></h4>
<p>관리자 세션이 인증된 사람만 관리자 페이지에 접근할 수 있어야한다.
<strong>php artisan make<!-- -->:middleware<!-- --> Admin</strong> 명령어를 실행해 Admin Middleware를 만들자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Http/Middleware/Admin.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Auth</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Closure</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"> </span><span class="token class-name-definition class-name">Admin</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>handle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$request</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token class-name type-declaration">Closure</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$next</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// admin session이 있는 경우만 request를 진행한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name static-context">Auth</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>guard</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>check</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$next</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$request</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 아닐경우 관리자 로그인 페이지로 넘긴다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>redirect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>route</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'admin.login'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<p>그리고 Http Kernel에 방금 만든 Admin Middleware를 라우팅에서 사용할 수 있게 등록해준다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Http/Kernel.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$routeMiddleware</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'auth'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Illuminate</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Auth</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Middleware</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Authenticate</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'auth.basic'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Illuminate</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Auth</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Middleware</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">AuthenticateWithBasicAuth</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'bindings'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Illuminate</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Routing</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Middleware</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">SubstituteBindings</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'can'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Illuminate</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Auth</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Middleware</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Authorize</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'guest'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">App</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Http</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Middleware</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">RedirectIfAuthenticated</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'throttle'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Illuminate</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Routing</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Middleware</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">ThrottleRequests</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// admin 이름으로 Admin Middleware를 호출할 수 있게 등록</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">App</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Http</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Middleware</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Admin</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<p>새로운 라우팅 파일로 관리하기 위해 RouteServiceProvider에 설정을 추가한다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Providers/RouteServiceProvider.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>map</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>mapAdminRoutes</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>mapAdminRoutes</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// /admin 으로 들어오는 요청에 대해 처리한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token class-name static-context">Route</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>prefix</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 이런식으로 한 번에 추가할 수도 있다. 하지만 except 함수를 쓸 수 없는 것 같고,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 라우팅 페이지에서 미들웨어를 등록해주는 게 더 편했다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// ->middleware(['web', 'admin'])</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>middleware</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'web'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>namespace</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>namespace</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// routes/admin.php 파일을 관리자 라우팅 파일로 등록한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>group</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>base_path</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'routes/admin.php'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<p>마지막으로 라우팅 파일에 미들웨어를 넣어준다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>routes/admin.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// admin middleware를 사용하고, namespace에 admin.을 추가한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Route</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>group</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string single-quoted-string" style=color:#e3116c>'middleware'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'as'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'admin.'</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 이 라우팅은 route('admin.main') 으로 접근이 가능해진다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Route</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'/'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'AdminController@index'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>name</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'main'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=활용>활용<a href=#활용 class=hash-link aria-label="활용에 대한 직접 링크" title="활용에 대한 직접 링크" translate=no>​</a></h4>
<p>기존 Auth 메소드들에 guard만 추가해주면 쉽게 사용 가능하다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Auth</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>guard</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>attepmt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Auth</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>guard</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>check</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Auth</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>guard</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>user</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Auth</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>guard</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'admin'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>logout</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=로그아웃>로그아웃<a href=#로그아웃 class=hash-link aria-label="로그아웃에 대한 직접 링크" title="로그아웃에 대한 직접 링크" translate=no>​</a></h3>
<p><strong>Auth::logout()</strong> 메소드를 호출하면 된다.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=이슈>이슈<a href=#이슈 class=hash-link aria-label="이슈에 대한 직접 링크" title="이슈에 대한 직접 링크" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=세션-아이디>세션 아이디<a href=#세션-아이디 class=hash-link aria-label="세션 아이디에 대한 직접 링크" title="세션 아이디에 대한 직접 링크" translate=no>​</a></h3>
<p>라라벨에선 로그인을 할 때 세션아이디를 새로운 값으로 엎어쳐버린다.
따라서 같은 환경에서 접근했는데, 로그인을 하면 다른 사용자가 되는 경우가 생긴다.
(로그아웃시에는 그대로다.)</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 로그인 전에 세션아이디를 가져와</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token variable" style=color:#36acaa>$old_session_id</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token class-name static-context">Session</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>getId</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 로그인이 성공하면 DB에서 등록된 세션값을 업데이트하자.</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=소셜-로그인>소셜 로그인<a href=#소셜-로그인 class=hash-link aria-label="소셜 로그인에 대한 직접 링크" title="소셜 로그인에 대한 직접 링크" translate=no>​</a></h2>
<p><code>laravel/socialite</code> 패키지를 설치하고 아주 쉽게 연동이 가능하다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=세팅>세팅<a href=#세팅 class=hash-link aria-label="세팅에 대한 직접 링크" title="세팅에 대한 직접 링크" translate=no>​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> require laravel/socialite</span><br/></span></code></pre></div></div>
<p>기본 socialite 패키지는 <code>facebook</code>, <code>twitter</code>, <code>linkedin</code>, <code>google</code>, <code>github</code> or <code>bitbucket</code> 만 연동이 가능하므로 다른 소셜 로그인을 연동하고 싶을 경우 <a href=https://socialiteproviders.github.io/ target=_blank rel="noopener noreferrer" class=""><code>Socialite Providers</code></a> 패키지를 사용하면 된다.</p>
<blockquote>
<p>Socialite Providers 사이트에는 Naver, Kakao, BattleNet(?) 등의 소셜 연동이 가능한 패키지가 무수히 많다.</p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=여담>여담<a href=#여담 class=hash-link aria-label="여담에 대한 직접 링크" title="여담에 대한 직접 링크" translate=no>​</a></h2>
<p><a class="" href=/2017/11/03/Laravel-5-5-JWT-Auth-Guide/>JWT 인증</a>과 같이본다면 Laravel을 사용한 실무에서 필요한 인증은 다 마무리한 셈일 듯</div><footer class="row docusaurus-mt-lg"><div class=col><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/php/>php</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/laravel/>laravel</a></ul></div></footer></article><article class=margin-bottom--xl><header><h2 class=title_f1Hy><a href=/2017/07/07/PHP-7-1에서-mcrypt-대체하기/>PHP 7.1에서 mcrypt 대체하기</a></h2><div class="container_mt6G margin-vert--md"><time datetime=2017-07-07T22:33:46.000Z>2017년 7월 7일</time> · <!-- -->약 3분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class=avatar__photo-link href=/authors/me/><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"/></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=/authors/me/><span class=authorName_yefp translate=no>Eunkwang Shin</span></a></div><small class=authorTitle_nd0D title=Owner>Owner</small><div class=authorSocials_rSDt><a href=https://www.linkedin.com/in/gracefullight/ target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=LinkedIn><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em preserveAspectRatio=xMidYMid viewBox="0 0 256 256" style=--dark:#0a66c2;--light:#ffffffe6 class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"/></svg></a><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=GitHub><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 256 250" preserveAspectRatio=xMidYMid style=--dark:#000;--light:#fff class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"/></svg></a><a href=mailto:gracefullight.dev@gmail.com target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=Email><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 class=authorSocialIcon_XYv3><path stroke=none d="M0 0h24v24H0z"/><path d="M7.2 12a4.8 4.8 0 1 0 9.6 0 4.8 4.8 0 1 0-9.6 0"/><path d="M16.8 12v1.8a3 3 0 0 0 6 0V12a10.8 10.8 0 1 0-6.6 9.936"/></svg></a></div></div></div></div></div></header><div class=markdown><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=mcrypt>MCRYPT<a href=#mcrypt class=hash-link aria-label="MCRYPT에 대한 직접 링크" title="MCRYPT에 대한 직접 링크" translate=no>​</a></h2>
<ul>
<li class="">암호화 함수인 <code>mcrypt</code> 가 PHP 7.1 버전부터 Deprecated 되었다.</li>
<li class="">왜 사라졌는지는 <a href=https://paragonie.com/blog/2015/05/if-you-re-typing-word-mcrypt-into-your-code-you-re-doing-it-wrong target=_blank rel="noopener noreferrer" class="">링크</a>에 자세하게 나와있다.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=기존-소스>기존 소스<a href=#기존-소스 class=hash-link aria-label="기존 소스에 대한 직접 링크" title="기존 소스에 대한 직접 링크" translate=no>​</a></h3>
<ul>
<li class="">PHP 구버전에서는 <code>mcrypt</code> 와 <code>MCRYPT_RIJNDAEL_128</code> 알고리즘을 통해 AES128 이 구현되어 있을 것이다.</li>
<li class=""><strong>MCRYPT_RIJNDAEL_128</strong>은 <strong>AES 128</strong>과 <strong>동일</strong>하다.</li>
<li class="">타 언어와는 조금 다른데, 호환을 위해선 pkcs5 padding 으로 변경해주는 작업이 필요하다.</li>
<li class="">php mcrypt function 의 기본 패딩은 zeros padding</li>
</ul>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 이런 식이거나</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token variable" style=color:#36acaa>$cipherText</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>mcrypt_encrypt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token constant" style=color:#36acaa>MCRYPT_RIJNDAEL_128</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>pkcs5_pad</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$plainText</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>MCRYPT_MODE_CBC</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$iv</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 이런 식일 것</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token variable" style=color:#36acaa>$td</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>mcrypt_module_open</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string double-quoted-string" style=color:#e3116c>"rijndael-128"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string double-quoted-string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string double-quoted-string" style=color:#e3116c>"cbc"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string double-quoted-string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>mcrypt_generic_init</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$td</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$iv</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token variable" style=color:#36acaa>$cipherText</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> @</span><span class="token function" style=color:#d73a49>mcrypt_generic</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$td</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>pkcs5_pad</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$plainText</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>mcrypt_generic_deinit</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$td</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>mcrypt_module_close</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$td</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>pkcs5_pad</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$blockSize</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>16</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$pad</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$blockSize</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$blockSize</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$text</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>.</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>str_repeat</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>chr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$pad</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$pad</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=대안>대안<a href=#대안 class=hash-link aria-label="대안에 대한 직접 링크" title="대안에 대한 직접 링크" translate=no>​</a></h3>
<ul>
<li class="">PHP 5.3 부터 사용 가능한 <strong>openssl_encrypt</strong> 함수를 쓰면 된다.</li>
<li class="">openssl 확장 모듈이 설치되어야한다.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=openssl>OPENSSL<a href=#openssl class=hash-link aria-label="OPENSSL에 대한 직접 링크" title="OPENSSL에 대한 직접 링크" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=encrypt>Encrypt<a href=#encrypt class=hash-link aria-label="Encrypt에 대한 직접 링크" title="Encrypt에 대한 직접 링크" translate=no>​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token variable" style=color:#36acaa>$cipherText</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>openssl_encrypt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$plainText</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'AES-128-CBC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>OPENSSL_RAW_DATA</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$iv</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// decrypt에서 오류가 발생해 PKCS5로 패딩을 맞춰주고 보내야한다면.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token variable" style=color:#36acaa>$cipherText</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>openssl_encrypt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>pkcs5_pad</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$plainText</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'AES-128-CBC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>OPENSSL_RAW_DATA</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$iv</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=decrypt>Decrypt<a href=#decrypt class=hash-link aria-label="Decrypt에 대한 직접 링크" title="Decrypt에 대한 직접 링크" translate=no>​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token variable" style=color:#36acaa>$plainText</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>openssl_decrypt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$cipherText</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'AES-128-CBC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>OPENSSL_RAW_DATA</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$iv</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// unpad가 필요하다면</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token variable" style=color:#36acaa>$plainText</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>pkcs5_unpad</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>openssl_decrypt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$cipherText</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'AES-128-CBC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>OPENSSL_RAW_DATA</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$iv</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>pkcs5_unpad</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$pad</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>ord</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>{</span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$pad</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>!</span><span class="token function" style=color:#d73a49>strspn</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>chr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$pad</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$pad</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>substr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$pad</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=pkcs5-vs-pkcs7>PKCS5 vs PKCS7<a href=#pkcs5-vs-pkcs7 class=hash-link aria-label="PKCS5 vs PKCS7에 대한 직접 링크" title="PKCS5 vs PKCS7에 대한 직접 링크" translate=no>​</a></h3>
<ul>
<li class=""><code>openssl_encrypt</code>의 default padding 은 PKCS7 padding 인데, 어떻게 호환이 되는 것일까?</li>
<li class=""><a href="https://social.msdn.microsoft.com/Forums/en-US/09fef7b7-b568-4895-8e52-f386be80aa2d/pkcs7-padding-in-net-vs-pkcs5-padding-in-java?forum=csharpgeneral" target=_blank rel="noopener noreferrer" class="">여기</a>서 해답을 찾았다.</li>
</ul>
<blockquote>
<p>The difference between the PKCS#5 and PKCS#7 padding mechanisms is the block size;
PKCS#5 padding is defined for 8-byte block sizes, PKCS#7 padding would work for any block size from 1 to 255 bytes.
So fundamentally PKCS#5 padding is a subset of PKCS#7 padding for 8 byte block sizes.
so, data encrypted with PKCS#5 is able to decrypt with PKCS#7, but data encrypted with PKCS#7 may not be able to decrypt with PKCS#5.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=triple-des>triple des<a href=#triple-des class=hash-link aria-label="triple des에 대한 직접 링크" title="triple des에 대한 직접 링크" translate=no>​</a></h3>
<ul>
<li class=""><code>des-ede3-cbc</code>가 triple des 알고리즘이다.</li>
</ul>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// encrypt</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>openssl_encrypt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$text</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string double-quoted-string" style=color:#e3116c>"des-ede3-cbc"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>OPENSSL_RAW_DATA</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$iv</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// decrypt</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>openssl_decrypt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$cipherText</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string double-quoted-string" style=color:#e3116c>"des-ede3-cbc"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>OPENSSL_RAW_DATA</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$iv</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=패키지>패키지<a href=#패키지 class=hash-link aria-label="패키지에 대한 직접 링크" title="패키지에 대한 직접 링크" translate=no>​</a></h2>
<ul>
<li class="">이 모든 걸 커버하는 라이브러리를 사용하자. <a href=https://github.com/phpseclib/mcrypt_compat target=_blank rel="noopener noreferrer" class="">phpseclib/mcrypt_compat</a></li>
<li class=""><em>phpseclib</em> 는 laravel/passport 에서도 사용되었다.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=여담>여담<a href=#여담 class=hash-link aria-label="여담에 대한 직접 링크" title="여담에 대한 직접 링크" translate=no>​</a></h2>
<p>카카오페이가 PHP 5 버전만 지원해 문의해봤지만 계획이 없어 이번 기회에 모듈을 다 뜯어봤는데 MCRYPT 만 만져주면 정상적으로 결제가 되었다.</p>
<p>곧 이 짓을 안해도 될 듯하다.
<img decoding=async loading=lazy src=https://i.imgur.com/QBA9xnP.jpg alt="KakaoPay 종료" class=img_ev3q /></div><footer class="row docusaurus-mt-lg"><div class=col><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/php/>php</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/openssl/>openssl</a></ul></div></footer></article><article class=margin-bottom--xl><header><h2 class=title_f1Hy><a href=/2017/06/10/CentOS7-LEMP-Stack-적용/>CentOS7 LEMP Stack 설치하기 (HTTP2, PHP7.1, Maria, Letsencrypt)</a></h2><div class="container_mt6G margin-vert--md"><time datetime=2017-06-10T10:05:06.000Z>2017년 6월 10일</time> · <!-- -->약 6분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class=avatar__photo-link href=/authors/me/><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"/></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=/authors/me/><span class=authorName_yefp translate=no>Eunkwang Shin</span></a></div><small class=authorTitle_nd0D title=Owner>Owner</small><div class=authorSocials_rSDt><a href=https://www.linkedin.com/in/gracefullight/ target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=LinkedIn><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em preserveAspectRatio=xMidYMid viewBox="0 0 256 256" style=--dark:#0a66c2;--light:#ffffffe6 class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"/></svg></a><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=GitHub><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 256 250" preserveAspectRatio=xMidYMid style=--dark:#000;--light:#fff class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"/></svg></a><a href=mailto:gracefullight.dev@gmail.com target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=Email><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 class=authorSocialIcon_XYv3><path stroke=none d="M0 0h24v24H0z"/><path d="M7.2 12a4.8 4.8 0 1 0 9.6 0 4.8 4.8 0 1 0-9.6 0"/><path d="M16.8 12v1.8a3 3 0 0 0 6 0V12a10.8 10.8 0 1 0-6.6 9.936"/></svg></a></div></div></div></div></div></header><div class=markdown><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=lemp>LEMP<a href=#lemp class=hash-link aria-label="LEMP에 대한 직접 링크" title="LEMP에 대한 직접 링크" translate=no>​</a></h2>
<p>Linux, Nginx, MariaDB, PHP</p>
<blockquote>
<p><strong>Why LEMP instead of LNMP?</strong>
We go with LEMP due to the pronunciation for Nginx: Engine-X (en-juhn-ecks).
Think of how in English, the article an is used instead of a for hour even though it begins with a consonant.
The importance is the sound of the first letter rather than its written representation.
Besides, LEMP is actually pronounceable and doesn’t sound like reciting the alphabet.</p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=php>PHP<a href=#php class=hash-link aria-label="PHP에 대한 직접 링크" title="PHP에 대한 직접 링크" translate=no>​</a></h2>
<p>repo 를 등록하고 설치하는 방법이 있지만 php71 등의 이름으로 설정해야되서 번거롭다.
yum 명령어의 --enablerepo 옵션을 사용해 php71 repository 를 가져오자.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>## php repo를 가져오기</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ yum </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> http://rpms.famillecollet.com/enterprise/remi-release-7.rpm</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>vi</span><span class="token plain"> /etc/yum.repos.d/remi-php71.repo</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">remi-php71</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>name</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">Remi</span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain">'s PHP </span><span class="token number" style=color:#36acaa>7.1</span><span class="token plain"> RPM repository </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> Enterprise Linux </span><span class="token number" style=color:#36acaa>7</span><span class="token plain"> - </span><span class="token variable" style=color:#36acaa>$basearch</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>#baseurl=http://rpms.remirepo.net/enterprise/7/php71/$basearch/</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>mirrorlist</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">http://rpms.remirepo.net/enterprise/7/php71/mirror</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 이 값을 1로 바꿔준다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>enabled</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>gpgcheck</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>gpgkey</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ yum </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> php php-fpm php-devel php-curl php-mcrypt php-mysql php-xmlrpc php-mbstring php-zip 등등</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ systemctl start php-fpm</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> php-fpm</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=maria>Maria<a href=#maria class=hash-link aria-label="Maria에 대한 직접 링크" title="Maria에 대한 직접 링크" translate=no>​</a></h2>
<p><a class="" href=/2016/12/23/CentOS-Maria-DB-설치/>예전 포스팅</a>으로 대체한다. 설치방법은 똑같고 버전만 다르게 해주면 된다.
설치 후 서비스 실행만 <code>systemctl</code> 명령어로 해주자.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=xtrabackup>Xtrabackup<a href=#xtrabackup class=hash-link aria-label="Xtrabackup에 대한 직접 링크" title="Xtrabackup에 대한 직접 링크" translate=no>​</a></h3>
<p>이제 mysqldump 를 좀 놓아주고 Incremental Backup 을 해주자.
이게 왜 좋은지는 <a href=https://www.percona.com/software/mysql-database/percona-xtrabackup/feature-comparison target=_blank rel="noopener noreferrer" class="">공홈</a>이나 <a href="http://www.yes24.com/24/goods/12982561?scode=032&OzSrank=1" target=_blank rel="noopener noreferrer" class="">책</a>이나 다른 블로그에 자세히 설명되어있다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>## xtrabackup 설치</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ yum </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> xtrabackup</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 증분백업을 위해 전체 백업이 한 번 필요하다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## root가 아닌 유저일 경우 해당 DB를 백업하기 위해 PROCESS 등 여러 권한을 추가해야한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## (로그 메세지로 추가하라고 나온다.)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ innobackupex </span><span class="token parameter variable" style=color:#36acaa>--user</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'root'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--password</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'암호'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--databases</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'DB'</span><span class="token plain"> --no-timestamp /백업위치</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 증분백업</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ innobackupex </span><span class="token parameter variable" style=color:#36acaa>--user</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'root'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--password</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'암호'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--incremental</span><span class="token plain"> --incremental-basedir</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'/백업위치/xtrabackup_checkpoints'</span><span class="token plain"> --no-timestamp /증분백업위치</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 증분백업을 전체백업 위에 얹기</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ innobackupex --apply-log --redo-only --incremental-dir</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'/증분백업위치'</span><span class="token plain"> /백업위치</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 증분백업 삭제</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>rm</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-rf</span><span class="token plain"> /증분백업위치</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 복원</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ systemctl stop mariadb</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 데이터 폴더를 날려야한다. (만약을 대비해 백업)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>rm</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-rf</span><span class="token plain"> /var/lib/mysql/*</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ innobackupex --copy-back /백업위치</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 권한부여</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>chown</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-R</span><span class="token plain"> mysql:mysql /var/lib/mysql</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ systemctl start mariadb</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=nginx>Nginx<a href=#nginx class=hash-link aria-label="Nginx에 대한 직접 링크" title="Nginx에 대한 직접 링크" translate=no>​</a></h2>
<p><strong>HTTP2 를 적용하기 위해서는 Nginx 1.9 버전과 Openssl 1.0.2 버전 이상이 필요</strong>한데, 기본 repository 에는 이 버전이 적용되어있지 않다.
따라서 검색해보면 컴파일 설치를 해야 된다는 글이 다수다. 모든 패키지는 패키지 매니져로 관리하는게 좋다고 생각하는 나로썬 그냥 넘어갈 수 없다.
Nginx 최신 repository 를 관리해주는 <a href=https://brouken.com/brouken-centos-7-repo/ target=_blank rel="noopener noreferrer" class="">나이스한 곳</a>을 찾았다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ yum </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> yum-utils</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ yum-config-manager --add-repo https://brouken.com/brouken.repo</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 기존 nginx repo를 사용하지 않는다는 옵션</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ yum-config-manager </span><span class="token parameter variable" style=color:#36acaa>--save</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--setopt</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">epel.exclude</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">nginx*</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ yum </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> nginx</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ systemctl start nginx</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> nginx</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## nginx 버전 확인</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ Nginx </span><span class="token parameter variable" style=color:#36acaa>-V</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">nginx version: nginx/1.13.1</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">built with OpenSSL </span><span class="token number" style=color:#36acaa>1.0</span><span class="token plain">.2k </span><span class="token number" style=color:#36acaa>26</span><span class="token plain"> Jan </span><span class="token number" style=color:#36acaa>2017</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=setopt-가-오류가-날-경우>setopt 가 오류가 날 경우<a href=#setopt-가-오류가-날-경우 class=hash-link aria-label="setopt 가 오류가 날 경우에 대한 직접 링크" title="setopt 가 오류가 날 경우에 대한 직접 링크" translate=no>​</a></h3>
<p>ngixn.repo 를 만들어주고 연결하자.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>vi</span><span class="token plain"> /etc/yum.repos.d/nginx.repo</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## vim /etc/yum.repos.d/nginx.repo</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">nginx</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>name</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">nginx repo</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>baseurl</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">http://nginx.org/packages/mainline/centos/7/</span><span class="token variable" style=color:#36acaa>$basearch</span><span class="token plain">/</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>gpgcheck</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>enabled</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 저장하고 설치 시작</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ yum update</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ yum </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> nginx</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ systemctl start nginx</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> nginx</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=letsencrypt>LetsEncrypt<a href=#letsencrypt class=hash-link aria-label="LetsEncrypt에 대한 직접 링크" title="LetsEncrypt에 대한 직접 링크" translate=no>​</a></h2>
<p>공짜 SSL 인 LetsEncrypt 의 이름이 certbot 으로 바뀌었다. <a href=https://certbot.eff.org/#centosrhel7-nginx target=_blank rel="noopener noreferrer" class="">공홈</a>을 참조해도 좋다.
인증을 받기위해 먼저 도메인을 따야한다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ yum </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> certbot</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 인증</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ certbot certonly </span><span class="token parameter variable" style=color:#36acaa>--standalone</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-d</span><span class="token plain"> example.com </span><span class="token parameter variable" style=color:#36acaa>-d</span><span class="token plain"> www.example.com</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 갱신 확인</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ certbot renew --dry-run</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 갱신하면서 nginx 재부팅</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 이 명령어를 적절히 cron에 넣어주자.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ certbot renew --pre-hook</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"systemctl stop nginx"</span><span class="token plain"> --post-hook</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"systemctl start nginx"</span><br/></span></code></pre></div></div>
<p>인증이 성공하면 <strong>/etc/letsencrypt/live/example.com/</strong> 경로 아래에 키가 떨어질 것이다.
자세한 명령어 옵션은 <a href=https://certbot.eff.org/docs/using.html target=_blank rel="noopener noreferrer" class="">Docs</a> 참조.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=nginx-연동>nginx 연동<a href=#nginx-연동 class=hash-link aria-label="nginx 연동에 대한 직접 링크" title="nginx 연동에 대한 직접 링크" translate=no>​</a></h3>
<p>ssl 을 적용하면서 HTTP2 도 붙혀보자.
HTTP2 에서는 bundling 보다 파일을 쪼개서 보내는게 더 효율적이라고 한다. (non-blocking 이니까)</p>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">## HTTP</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">server {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    listen 80;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    server_name example.com www.example.com;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    # certbot --webroot 인증을 받기위한 설정</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    #location ^~ /.well-known/acme-challenge/ {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    # default_type "text/plain";</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    # root /var/www/letsencrypt;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    #}</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    # 80 접속시 443으로 redirect</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    location / {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">       return 301 https://$server_name$request_uri;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">## HTTPS</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">server {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  listen 443 ssl http2;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  listen [::]:443 ssl http2;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  server_name example.com www.example.com;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  root /var/nginx/www/public;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  index index.php index.html;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  # 지저분한 보안 옵션은 추천옵션이니 넣어주자.</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl on;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_trusted_certificate /etc/letsencrypt/live/example.com/fullchain.pem;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_session_timeout 1d;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_session_cache shared:SSL:50m;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_session_tickets off;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  #ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_protocols TLSv1.2;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_ciphers EECDH+AESGCM:EECDH+AES;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_ecdh_curve secp384r1;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_prefer_server_ciphers on;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_stapling on;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  ssl_stapling_verify on;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  location / {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    try_files $uri $uri/ /index.php?$query_string;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  location ~ \.php {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    fastcgi_split_path_info ^(.+\.php)(/.+)$;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    include fastcgi_params;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    fastcgi_param SCRIPT_NAME $fastcgi_script_name;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    fastcgi_index index.php;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    fastcgi_pass 127.0.0.1:9000;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  location ~ /\.ht {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    deny all;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  # 캐싱할 데이터가 있다면 추가</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  location ~* \.(?:jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm|htc|woff)$ {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    expires 1M;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    add_header Cache-Control "public";</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  location ~* \.(?:css|js)$ {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    expires 7d;</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    add_header Cache-Control "public";</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br/></span></code></pre></div></div>
<p>해당 세팅은 Laravel5.4 용이다.</p>
<p>nginx.conf 에는 해당 옵션들도 추가해주자.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>nginx.conf</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic># CPU 물리 코어에 따라 설정한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic># 1코어에선 1로 나머지는 auto로 설정하면 된다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic># grep ^processor /proc/cpuinfo | wc -l 로 확인 가능</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  worker_processes </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  events </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># 각 worker process에서 한 번에 처리할 수 있는 최대 연결 수</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># ulimit -n의 값과 같게 설정하자.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    worker_connections </span><span class="token number" style=color:#36acaa>1024</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># I/O event 노티 방식을 epoll로 사용. (poll보다 발전한 방식)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    use epoll</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># worker가 한 번에 모든 연결을 수용할 수 있도록 설정</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    multi_accept on</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  http </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># access_log 제거</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    access_log off</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    server_tokens off</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># iframe 보안 이슈 DENY</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    add_header X-Frame-Options DENY</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    add_header X-Content-Type-Options nosniff</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    add_header X-XSS-Protection </span><span class="token string" style=color:#e3116c>"1; mode=block"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># PHP 서버라는 header 제거</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    fastcgi_hide_header X-Powered-By</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># static file 제공 최적화</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    sendfile       on</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># TCP multiple buffer를 individual packet으로 전송하게 변경</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    tcp_nopush     on</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># TCP에서 TCP_CORK 옵션을 활성화</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># MTU에서 IP 헤더의 40-60 Byte를 뺀값과 같다는데 뭐라는건지 모르겠다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    tcp_nodelay    on</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># keep alive 설정</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    keepalive_timeout  </span><span class="token number" style=color:#36acaa>65</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># keepalive_requests 100000;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># gzip 압축설정</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>gzip</span><span class="token plain"> on</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    gzip_min_length </span><span class="token number" style=color:#36acaa>1000</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    gzip_types application/x-javascript text/css application/javascript text/javascript text/plain text/xml application/json application/vnd.ms-fontobject application/x-font-opentype application/x-font-truetype application/x-font-ttf application/xml font/eot font/opentype font/otf image/svg+xml image/vnd.microsoft.icon</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    gzip_disable </span><span class="token string" style=color:#e3116c>"MSIE [1-6]\."</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<p>적용 후에 <a href="https://chrome.google.com/webstore/detail/http2-and-spdy-indicator/mpbpobfflnpcgagjijhmgnchggcjblin?utm_source=chrome-ntp-icon" target=_blank rel="noopener noreferrer" class="">HTTP2 확인 확장프로그램</a> 설치 후 이 프로그램에 파란불이 들어오면 성공이다.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=파일-백업>파일 백업<a href=#파일-백업 class=hash-link aria-label="파일 백업에 대한 직접 링크" title="파일 백업에 대한 직접 링크" translate=no>​</a></h2>
<p>소스는 git 으로 관리가 되는데 static 파일은 주기적으로 백업이 필요하다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>file_backup.sh</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token assign-left variable" style=color:#36acaa>NOW_DATE</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>`</span><span class="token variable function" style=color:#d73a49>date</span><span class="token variable" style=color:#36acaa>`</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>BACKUP_DATE</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>`</span><span class="token variable function" style=color:#d73a49>date</span><span class="token variable" style=color:#36acaa> +</span><span class="token variable string" style=color:#e3116c>"%Y%m%d"</span><span class="token variable" style=color:#36acaa>`</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>FILE_DIR</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">백업할 폴더 경로</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>BACKUP_DIR</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">백업된 파일 경로</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## gz 압축</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>tar</span><span class="token plain"> zcvf </span><span class="token variable" style=color:#36acaa>${BACKUP_DIR}</span><span class="token plain">/</span><span class="token variable" style=color:#36acaa>${BACKUP_DATE}</span><span class="token plain">.tar.gz </span><span class="token variable" style=color:#36acaa>${FILE_DIR}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 3일 이상된 백업파일은 제거</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>find</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>${BACKUP_DIR}</span><span class="token plain">/ </span><span class="token parameter variable" style=color:#36acaa>-mtime</span><span class="token plain"> +3 </span><span class="token parameter variable" style=color:#36acaa>-exec</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>rm</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-f</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## find ${BACKUP_DIR}/ -mtime 3 -delete</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=여담>여담<a href=#여담 class=hash-link aria-label="여담에 대한 직접 링크" title="여담에 대한 직접 링크" translate=no>​</a></h2>
<p>다음부터 Ubuntu 쓸까 생각했는데, Nginx 최신 Repo 를 찾은게 컸다. 하지만 빨리 Docker 책 읽자.
Nginx, Reverse Proxy, Redis, PHP, Jenkins 를 한 번에 해결해주겠지.
이제 DockerFile 이 잘 읽히긴 하는데, 언제쯤 갈아탈 수 있으려나</div><footer class="row docusaurus-mt-lg"><div class=col><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/linux/>linux</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/php/>php</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/nginx/>nginx</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/mariadb/>mariadb</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/letsencrypt/>letsencrypt</a></ul></div></footer></article><article class=margin-bottom--xl><header><h2 class=title_f1Hy><a href=/2017/06/06/Laravel-5-4-Eloquent-Model/>Laravel 5.5 - Eloquent ORM 사용하기</a></h2><div class="container_mt6G margin-vert--md"><time datetime=2017-06-06T11:49:33.000Z>2017년 6월 6일</time> · <!-- -->약 10분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class=avatar__photo-link href=/authors/me/><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"/></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=/authors/me/><span class=authorName_yefp translate=no>Eunkwang Shin</span></a></div><small class=authorTitle_nd0D title=Owner>Owner</small><div class=authorSocials_rSDt><a href=https://www.linkedin.com/in/gracefullight/ target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=LinkedIn><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em preserveAspectRatio=xMidYMid viewBox="0 0 256 256" style=--dark:#0a66c2;--light:#ffffffe6 class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"/></svg></a><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=GitHub><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 256 250" preserveAspectRatio=xMidYMid style=--dark:#000;--light:#fff class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"/></svg></a><a href=mailto:gracefullight.dev@gmail.com target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=Email><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 class=authorSocialIcon_XYv3><path stroke=none d="M0 0h24v24H0z"/><path d="M7.2 12a4.8 4.8 0 1 0 9.6 0 4.8 4.8 0 1 0-9.6 0"/><path d="M16.8 12v1.8a3 3 0 0 0 6 0V12a10.8 10.8 0 1 0-6.6 9.936"/></svg></a></div></div></div></div></div></header><div class=markdown><p>Eloquent ORM을 사용해 데이터를 가져와보자.
<a class="" href=/2017/05/16/Laravel-5-4-Start/>이전 포스팅</a>에서 이어진다. (Eloquent ORM 기능만 필요하다면 3.Model 부터 보면 된다)</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=migration>Migration<a href=#migration class=hash-link aria-label="Migration에 대한 직접 링크" title="Migration에 대한 직접 링크" translate=no>​</a></h2>
<p>DBMS에 상관 없이 테이블을 똑같이 생성하기 위한 기능이다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=생성>생성<a href=#생성 class=hash-link aria-label="생성에 대한 직접 링크" title="생성에 대한 직접 링크" translate=no>​</a></h3>
<p>artisan 명령어로 간단히 생성할 수 있다. 날짜_테이블 형식의 파일이 database/migrations 밑에 생성된다.
<strong>이 파일들의 자동 생성된 이름을 절대 변경하지 말자</strong> 내부적으로 언더스코어를 <em>explode</em>해 class를 호출하기 때문에 건들면 고생한다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>## 모델을 생성하면서 같이 생성</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## m 옵션을 추가한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ php artisan make:model </span><span class="token parameter variable" style=color:#36acaa>-m</span><span class="token plain"> 모델명</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 마이그레이션만 생성</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ php artisan make:migration 마이그레이션명</span><br/></span></code></pre></div></div>
<p>생성 후에 up 메소드 안에 테이블을 꾸며주고 down 메소드에 테이블을 지울 때 실행할 로직을 구현한다.
컬럼 타입을 지정하는 메소드는 <a href=https://laravel.com/docs/5.4/migrations#columns target=_blank rel="noopener noreferrer" class="">여기</a>를 참조하면 된다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>up</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Schema</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>create</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'table_name'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name type-declaration">Blueprint</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$table</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$table</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>increments</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'idx'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$table</span><span class="token operator" style=color:#393A34>-></span><span class="token keyword type-declaration" style=color:#00009f>string</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'id'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>20</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>unique</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$table</span><span class="token operator" style=color:#393A34>-></span><span class="token keyword type-declaration" style=color:#00009f>string</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'name'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>30</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$table</span><span class="token operator" style=color:#393A34>-></span><span class="token keyword type-declaration" style=color:#00009f>string</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'email'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>unique</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$table</span><span class="token operator" style=color:#393A34>-></span><span class="token keyword type-declaration" style=color:#00009f>string</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'password'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>250</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$table</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>tinyInteger</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'tiny'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>nullable</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$table</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>timestamps</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 테이블에 외래키 제약조건이 걸려있을 경우 migration으로 일괄 삭제시에</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 오류가 발생하므로, 외래키 체크 옵션을 비활성화 해줘야될 수 도 있다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>down</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">DB</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>statement</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'SET FOREIGN_KEY_CHECKS = 0'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Schema</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>dropIfExists</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'table_name'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">DB</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>statement</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'SET FOREIGN_KEY_CHECKS = 1'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=실행>실행<a href=#실행 class=hash-link aria-label="실행에 대한 직접 링크" title="실행에 대한 직접 링크" translate=no>​</a></h3>
<p>php artisan migrate 명령어로 실행하면 된다.</p>
<ul>
<li class="">migrate => 전체 실행</li>
<li class="">migrate<!-- -->:refresh<!-- --> => 다시 실행</li>
<li class="">migrate<!-- -->:rollback<!-- --> => 마지막 migrate 시점으로 돌림</li>
<li class="">migrate<!-- -->:reset<!-- --> => 제거</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=tinker>Tinker<a href=#tinker class=hash-link aria-label="Tinker에 대한 직접 링크" title="Tinker에 대한 직접 링크" translate=no>​</a></h3>
<p>이미 데이터가 들어간 테이블이 있어 migrate --path로 한 파일만을 실행해야 하는데, tinker를 사용하면 더 쉽게 해당 마이그레이션을 실행시킬 수 있다.
Tinker는 커맨드로 라라벨 쉘(실행환경)으로 들어간다고 생각하면 된다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>## tinker</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ php artisan tinker</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## shell로 접속된다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">Psy Shell v0.8.5 </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">PHP </span><span class="token number" style=color:#36acaa>7.0</span><span class="token plain">.7 ??cli</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> by Justin Hileman</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">New version is available </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">current: v0.8.5, latest: v0.8.8</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>>></span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## blueprint 의존성을 추가해주고 (Blueprint는 up 메소드에 DI로 들어가 있기에 읽지 못한다.)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ use Illuminate</span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain">Database</span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain">Schema</span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain">Blueprint</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 새로 실행하려 했던 스키마를 실행시켜주기만 하면 된다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ Schema::create</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'new_table'</span><span class="token plain">, </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Blueprint </span><span class="token variable" style=color:#36acaa>$table</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$table</span><span class="token plain">-</span><span class="token operator" style=color:#393A34>></span><span class="token plain">increments</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'idx'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$table</span><span class="token plain">-</span><span class="token operator" style=color:#393A34>></span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'id'</span><span class="token plain">, </span><span class="token number" style=color:#36acaa>20</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">-</span><span class="token operator" style=color:#393A34>></span><span class="token plain">unique</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$table</span><span class="token plain">-</span><span class="token operator" style=color:#393A34>></span><span class="token plain">timestamps</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<p>DB에 해당 테이블이 생성된 걸 확인할 수 있다.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=seed>Seed<a href=#seed class=hash-link aria-label="Seed에 대한 직접 링크" title="Seed에 대한 직접 링크" translate=no>​</a></h2>
<p>Seed는 테이블에 필수 데이터 또는 더미 데이터를 심어주는 과정이다.
테스트에 필요한 데이터를 넣어주는데 아주 효과적이다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=생성-1>생성<a href=#생성-1 class=hash-link aria-label="생성에 대한 직접 링크" title="생성에 대한 직접 링크" translate=no>​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">php artisan make:seeder 시더명</span><br/></span></code></pre></div></div>
<p>database/seeds 아래에 파일이 생성된다.
파일을 열어보면 run() 메소드 하나가 있는데, 여기에 시드파일이 호출될 때 실행할 로직을 구현해주면 된다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>database/seeds/BoardSeed.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>run</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 모델로 생성하기</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Board</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>create</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'title'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'공지'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'author'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'관리자'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'content'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'공지입니다'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// DB 파사드로 생성하기</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">DB</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>table</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'board'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>insert</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'title'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'공지'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'author'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'관리자'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'content'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'공지입니다'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=faker>Faker<a href=#faker class=hash-link aria-label="Faker에 대한 직접 링크" title="Faker에 대한 직접 링크" translate=no>​</a></h4>
<p>랜덤한 테스트용 데이터가 많이 필요하다면, 가짜(더미) 데이터를 생성해주는 <a href=https://github.com/fzaninotto/Faker target=_blank rel="noopener noreferrer" class="">라이브러리</a>를 사용할 수 있다.
링크를 따라가보면 정말 엄청난 종류의 랜덤 데이터를 생성할 수 있음에 놀랄 것이다.</p>
<p>faker를 사용하려면 ModelFactory를 먼저 정의해야한다.
상품 모델을 가져와 가짜 데이터 타입을 정의해보자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>database/factories/ModelFactory.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token variable" style=color:#36acaa>$factory</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>define</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name class-name-fully-qualified static-context">App</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Models</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Product</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name class-name-fully-qualified type-declaration">Faker</span><span class="token class-name class-name-fully-qualified type-declaration punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified type-declaration">Generator</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$faker</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// 메소드는 위의 라이브러리를 참고하자.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// 상품명을 중복되지 않게 city(도시명)으로 가져온다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'name'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$faker</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>unique</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>city</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// 색상 헥스코드를 가져온다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'color'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$faker</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>safeColorName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// 1000~50000원 사이의 가격을 가져온다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'price'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$faker</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>numberBetween</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1000</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>50000</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// lorempixel의 랜덤 이미지를 가져온다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'thumbnail'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$faker</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>imageUrl</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>200</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'detail_image'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$faker</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>imageUrl</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>300</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>600</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'qty'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$faker</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>numberBetween</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1000</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'status'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'owner'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$faker</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>name</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'sorting'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$faker</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>numberBetween</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>9999</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=실행-1>실행<a href=#실행-1 class=hash-link aria-label="실행에 대한 직접 링크" title="실행에 대한 직접 링크" translate=no>​</a></h3>
<p>위에서 선언한 faker 모델을 seed에서 호출해보자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>database/seeds/ProductSeed.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>run</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 두번째 인자로 실행시킬 횟수를 넣어주면 된다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function" style=color:#d73a49>factory</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name class-name-fully-qualified static-context">App</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Models</span><span class="token class-name class-name-fully-qualified static-context punctuation" style=color:#393A34>\</span><span class="token class-name class-name-fully-qualified static-context">Product</span><span class="token operator" style=color:#393A34>::</span><span class="token keyword" style=color:#00009f>class</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>create</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">php artisan db:seed</span><br/></span></code></pre></div></div>
<p>테이블에 상품 더미데이터가 100개 생성된 것을 확인할 수 있다.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=model>Model<a href=#model class=hash-link aria-label="Model에 대한 직접 링크" title="Model에 대한 직접 링크" translate=no>​</a></h2>
<p>모델은 하나의 테이블의 타입을 정해 놓은 것이라 보면 된다.
데이터를 가져오거나 넣을 때 모델에 정의된 형태로 가져온다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=기본-구조>기본 구조<a href=#기본-구조 class=hash-link aria-label="기본 구조에 대한 직접 링크" title="기본 구조에 대한 직접 링크" translate=no>​</a></h3>
<p>아래 구조 정도만 알아두면 된다. 더 자세한건 <a href=https://github.com/laravel/framework/blob/5.4/src/Illuminate/Database/Eloquent/Model.php target=_blank rel="noopener noreferrer" class="">Eloquent Model Class</a>를 확인해보자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Models/Board.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>namespace</span><span class="token plain"> </span><span class="token package">App</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Models</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Database</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Eloquent</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Model</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"> </span><span class="token class-name-definition class-name">Board</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>extends</span><span class="token plain"> </span><span class="token class-name">Model</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 임의의 생성 필드가 있다면 설정해준다. (기본값 created_at)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>CREATED_AT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'created_dt'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 사용하지 않을 경우 Null로 초기화해주자. (기본값 updated_at)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>UPDATED_AT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>null</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 둘 다 사용하지 않을 경우 timestamps만 꺼주면 된다. (기본값 true)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$timestamps</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant boolean" style=color:#36acaa>false</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// PK가 auto increment가 아닐경우 false로 바꿔준다. (기본값 true)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$incrementing</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant boolean" style=color:#36acaa>false</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// PK 값을 변경한다. (기본값 id)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$primaryKey</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'idx'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 테이블 명을 변경한다. (기본값 모델명의 복수형)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$table</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'board'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// dump insert 및 dump update가 안되는 필드를 설정한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$guarded</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'idx'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// guarded와 fillable 중 하나만 있으면 된다. (써보니 guarded가 편하더라.)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// dump insert 및 dump update가 가능한 필드를 설정한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>//protected $fillable = [</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>//  'title', 'content'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>//];</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 노출시키지 않을 필드가 있을 경우</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$hidden</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'password'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=relationship>Relationship<a href=#relationship class=hash-link aria-label="Relationship에 대한 직접 링크" title="Relationship에 대한 직접 링크" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=11>1:1<a href=#11 class=hash-link aria-label="1:1에 대한 직접 링크" title="1:1에 대한 직접 링크" translate=no>​</a></h4>
<p>hasOne과 belongsTo로 연결한다.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=1>1<!-- -->:n<a href=#1 class=hash-link aria-label="1에 대한 직접 링크" title="1에 대한 직접 링크" translate=no>​</a></h4>
<p>hasMany와 belongsTo로 연결한다.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=n>n<!-- -->:m<a href=#n class=hash-link aria-label="n에 대한 직접 링크" title="n에 대한 직접 링크" translate=no>​</a></h4>
<p>belongsToMany로 연결한다.
처음에 제일 감이 안왔던 Relationship이지만 코드를 보면 이해하기가 쉽다.
주문(Order) - 주문 상품(OrderProduct) - 상품(Product) 테이블이 있다고 가정한다. 각각 시작 - 링크(피벗) - 종료 테이블이다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"> App</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">Models</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">Order</span><span class="token operator" style=color:#393A34>.</span><span class="token plain">php</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>product</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 마지막으로 연결될 모델명, 링크 테이블 명, 시작->링크를 연결시킬 인덱스, 링크->종료를 연결시킬 인덱스</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>belongsToMany</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'App\Models\Product'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'order_product'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'order_id'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'product_id'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">          </span><span class="token comment" style=color:#999988;font-style:italic>// 링크 테이블의 컬럼을 가져와야할 때</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">          </span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>withPivot</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string single-quoted-string" style=color:#e3116c>'price'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'quantity'</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<p>이렇게 정의하면 뷰에서 <strong>order->product</strong>를 <em>foreach</em>로 돌려 <strong>product->product_id</strong>처럼 접근할 수 있고
<strong>product->pivot->price</strong>로 pivot 테이블의 데이터도 가져올 수 있다.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=111>1:1:1<a href=#111 class=hash-link aria-label="1:1:1에 대한 직접 링크" title="1:1:1에 대한 직접 링크" translate=no>​</a></h4>
<p>이런 관계가 있을 경우에 라라벨에서 관계메소드를 직접 지원하지는 않는다.
억지로 사용하려면, <code>hasOne</code>을 두 번 사용해 연결해야하는데, Select Query를 두 번 날려야 된다는 소리다. (참을 수 없다)</p>
<p><a href=https://github.com/znck/belongs-to-through target=_blank rel="noopener noreferrer" class="">BelongsToThrough</a> trait 패키지를 통해 깔끔하게 해결할 수 있다.
메소드에서 <code>belongsToMany</code>처럼 커스텀 외래키를 사용해야할 경우엔 5번째 파라미터로 <strong>[ 클래스 => 키 ]</strong> 형식으로 넘겨주면 된다. (<a href=https://github.com/znck/belongs-to-through/pull/25/files target=_blank rel="noopener noreferrer" class="">여기</a>의 소스를 참고하자)</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=이슈>이슈<a href=#이슈 class=hash-link aria-label="이슈에 대한 직접 링크" title="이슈에 대한 직접 링크" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=orm의-join-방식>ORM의 Join 방식<a href=#orm의-join-방식 class=hash-link aria-label="ORM의 Join 방식에 대한 직접 링크" title="ORM의 Join 방식에 대한 직접 링크" translate=no>​</a></h4>
<p>한 방 쿼리가 불가능하다. 오직 PK를 통해 Select된 데이터들을 다시 PHP 단에서 합쳐서 보여준다.
한 방이 필요할 때는 Database에서 View를 이용하거나 DB 파사드를 써야한다.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=composite-key>Composite Key<a href=#composite-key class=hash-link aria-label="Composite Key에 대한 직접 링크" title="Composite Key에 대한 직접 링크" translate=no>​</a></h4>
<p>라라벨 Eloquent Model에서 복합키를 사용할 수는 없다. 편법으로 <a href=https://stackoverflow.com/questions/31415213/how-i-can-put-composite-keys-in-models-in-laravel-5 target=_blank rel="noopener noreferrer" class="">trait를 추가</a>할 수 있는데 find 메소드도 overriding 해야 된다.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=timestamps>Timestamps<a href=#timestamps class=hash-link aria-label="Timestamps에 대한 직접 링크" title="Timestamps에 대한 직접 링크" translate=no>​</a></h4>
<p>created_at과 updated_at은 timestamps 형식이라 date_format과 같은 쿼리함수 대신 whereDate 메소드로 연산을 실행해야한다.
물론 DB에 데이터가 들어가기 전 datetime으로 해당 컬럼을 변경해주면 된다.
(timestamps의 유효기간은 2035년까지므로.)</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=group-by>Group By<a href=#group-by class=hash-link aria-label="Group By에 대한 직접 링크" title="Group By에 대한 직접 링크" translate=no>​</a></h4>
<p>GroupBy를 이용한 쿼리 사용시에 <strong>Syntax error or access violation: 1055 'table.column' isn't in GROUP BY</strong>라는 오류 메세지가 보이며 실행이 안 되는 경우가 있다. 해당 컬럼으로 GroupBy를 하지 않았는데도 발생한다.</p>
<p>database config의 strict 모드 중 <strong>ONLY_FULL_GROUP_BY</strong> 모드가 활성화 되어있어서 그런데 이 모드만 제외를 시켜주면 된다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>config/database.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token string single-quoted-string" style=color:#e3116c>'connections'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token string single-quoted-string" style=color:#e3116c>'mysql'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// strict 속성을 false로 바꿔준다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'strict'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token constant boolean" style=color:#36acaa>false</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// modes 속성을 추가해 기본 strict 옵션을 다시 추가한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'modes'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'STRICT_TRANS_TABLES'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'NO_ZERO_IN_DATE'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'NO_ZERO_DATE'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'ERROR_FOR_DIVISION_BY_ZERO'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'NO_AUTO_CREATE_USER'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'NO_ENGINE_SUBSTITUTION'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><br/></span></code></pre></div></div>
<p>변경 후 config<!-- -->:cache<!-- -->로 config 파일들을 다시 캐싱해주자.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=연동>연동<a href=#연동 class=hash-link aria-label="연동에 대한 직접 링크" title="연동에 대한 직접 링크" translate=no>​</a></h3>
<p>만든 모델을 선언만 하면 <a href=https://laravel.com/docs/5.4/eloquent#inserting-and-updating-models target=_blank rel="noopener noreferrer" class="">Eloquent Model 메소드</a>와 <a href=https://laravel.com/docs/5.4/queries target=_blank rel="noopener noreferrer" class="">Query Builder 메소드</a>를 사용할 수 있다.</p>
<p>CRUD는 다음과 같다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>YourController.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">App</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Model</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>test</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// PK로 데이터 1개 반환</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>find</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'idx'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>first</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 전체 데이터 반환</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>all</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 조건 데이터 반환</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Insert</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$model</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token class-name">Model</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$model</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>column</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'추가 값'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$model</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>column2</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'추가 값2'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$model</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>save</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Mass Insert</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>create</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'column'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'추가 값'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'column2'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'추가 값2'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Bulk Insert</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>insert</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'column'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'추가 값'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'column2'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'추가 값2'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'column'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'추가 값'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'column2'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'추가 값2'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Update</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$model</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>find</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$model</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>column</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'변경 값'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$model</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>column2</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'변경 값2'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$model</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>save</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Mass Update</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>update</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'column'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'변경 값'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'column2'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'변경 값2'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Delete</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>destory</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>find</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>delete</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>delete</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=collection과-model의-차이>Collection과 Model의 차이<a href=#collection과-model의-차이 class=hash-link aria-label="Collection과 Model의 차이에 대한 직접 링크" title="Collection과 Model의 차이에 대한 직접 링크" translate=no>​</a></h3>
<p>Model에서 쓸 수 있는 메소드와 Collection에서 쓸 수 있는 메소드가 다르다.
Model Class에서 정의하는 관계 메소드들은 Model에서만 사용 가능하다.</p>
<ul>
<li class=""><strong>Collection</strong>: <code>Array&lt;Model></code> 즉 모델의 집합이다.</li>
<li class=""><strong>Model</strong>: 테이블에서 하나의 행이라고 생각하자.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=paging>Paging<a href=#paging class=hash-link aria-label="Paging에 대한 직접 링크" title="Paging에 대한 직접 링크" translate=no>​</a></h2>
<p>모델에서 paginate 메소드를 사용하면, querystring에 page 변수가 붙어 페이징이 된다. (예를들면 /boards?page=1)
라라벨의 기본 페이징은 Bootstrap의 Class를 사용한다.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 이렇게 모델을 가지고 왔다면</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// get을 paginate로 바꿔주기만 하면 된다. (뿌려지는 list item의 기본값은 15이다.)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>paginate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// next와 prev 버튼이 없는 pagination을 구현하고 싶다면</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>simplePaginate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<p>페이징 뷰를 꾸미고 싶다면 아래 명령어를 실행해 <strong>resources/views/vendor/pagination</strong>에 view가 생기고 <strong>default.blade.php</strong>를 수정하면 된다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">php artisan vendor:publish </span><span class="token parameter variable" style=color:#36acaa>--tag</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">laravel-pagination</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=ajax-pagination>ajax pagination<a href=#ajax-pagination class=hash-link aria-label="ajax pagination에 대한 직접 링크" title="ajax pagination에 대한 직접 링크" translate=no>​</a></h3>
<p>실무에선 Paging 호출을 GET보단 AJAX를 쓰는게 깔끔한데 List View와 ListItem View, Controller 세부분을 모두 변경해줘야한다.
아래 소스는 jQuery를 사용하고 있다고 가정한다. (Frontend Framework를 같이 사용하고 있다면 더 깔끔하게 처리 될 수 있을듯)</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=controller>Controller<a href=#controller class=hash-link aria-label="Controller에 대한 직접 링크" title="Controller에 대한 직접 링크" translate=no>​</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>YourController.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>list</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name type-declaration">Request</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// ajax 요청일 경우에 listitem 뷰 반환</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>ajax</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>view</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'listitem'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'data'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>paginate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// get 요청일 경우에 list 뷰 반환</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>view</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'list'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'data'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>paginate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=list-view>List view<a href=#list-view class=hash-link aria-label="List view에 대한 직접 링크" title="List view에 대한 직접 링크" translate=no>​</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>list.blade.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">div id</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"list"</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  @</span><span class="token keyword" style=color:#00009f>include</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'listitem'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">div</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">script</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>var</span><span class="token plain"> paging_listener </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 페이지 버튼에 click listener 등록</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  $</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'.pagination a'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>click</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">e</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// a href 로 페이지가 이동하는걸 방지한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    e</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>preventDefault</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>get_list</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">$</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">this</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>attr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'href'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>var</span><span class="token plain"> get_list </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">url</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  $</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">url</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>then</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>function</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">html</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    $</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'#list'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>html</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">html</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 페이지가 다시 그려졌으므로 listener를 다시 등록한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>paging_listener</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function" style=color:#d73a49>paging_listener</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">script</span><span class="token operator" style=color:#393A34>></span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=listitem-view>ListItem view<a href=#listitem-view class=hash-link aria-label="ListItem view에 대한 직접 링크" title="ListItem view에 대한 직접 링크" translate=no>​</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>listitem.blade.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">ul</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token keyword" style=color:#00009f>foreach</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$data</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$item</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">li</span><span class="token operator" style=color:#393A34>></span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$item</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>name</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>}</span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">li</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token keyword" style=color:#00009f>endforeach</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">ul</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// pagination html이 반환되어 자동으로 보여진다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$data</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>links</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=multiple-pagination>multiple pagination<a href=#multiple-pagination class=hash-link aria-label="multiple pagination에 대한 직접 링크" title="multiple pagination에 대한 직접 링크" translate=no>​</a></h3>
<p>한 페이지에 여러 리스트가 있는 경우가 종종 있다. 먼저 <a href=https://github.com/laravel/framework/blob/5.4/src/Illuminate/Database/Query/Builder.php#L1723 target=_blank rel="noopener noreferrer" class="">paginate 메소드</a>를 살펴보자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/**</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>* Paginate the given query into a simple paginator.</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>*</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>* @param  int  $perPage</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>* @param  array  $columns</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>* @param  string  $pageName</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>* @param  int|null  $page</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>* @return \Illuminate\Contracts\Pagination\LengthAwarePaginator</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>*/</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>paginate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$perPage</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>15</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$columns</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token string single-quoted-string" style=color:#e3116c>'*'</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$pageName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'page'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$page</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>null</span><span class="token punctuation" style=color:#393A34>)</span><br/></span></code></pre></div></div>
<ul>
<li class=""><strong>perPage</strong>: 한 페이지에 표시될 Item 수</li>
<li class=""><strong>columns</strong>: 가져올 컬럼명의 배열</li>
<li class=""><strong>pageName</strong>: page 변수명 (예를들면 /boards?page=1 에서 page 변수명을 변경 가능)</li>
<li class=""><strong>page</strong>: 가져올 페이지</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=controller-1>Controller<a href=#controller-1 class=hash-link aria-label="Controller에 대한 직접 링크" title="Controller에 대한 직접 링크" translate=no>​</a></h4>
<p>Controller에서 paginate 메소드를 활용해보자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>YourController.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>list</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name type-declaration">Request</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>ajax</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// list1_page 값이 들어올 경우</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>has</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'list1_page'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>// list1_item 뷰에 바인딩해준다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>view</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'list1_item'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string single-quoted-string" style=color:#e3116c>'data1'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>get_list1</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>has</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'list2_page'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>view</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'list2_item'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string single-quoted-string" style=color:#e3116c>'data2'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>get_list2</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 메인 요청</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$data1</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>get_list1</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token variable" style=color:#36acaa>$data2</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$this</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>get_list2</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>view</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'list'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'data1'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$data1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'data2'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$data2</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>get_list1</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>orderBy</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>paginate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token string single-quoted-string" style=color:#e3116c>'*'</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'list1_page'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>protected</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>get_list2</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token class-name static-context">Model</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>where</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>paginate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token string single-quoted-string" style=color:#e3116c>'*'</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'list2_page'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=list-view-1>List view<a href=#list-view-1 class=hash-link aria-label="List view에 대한 직접 링크" title="List view에 대한 직접 링크" translate=no>​</a></h4>
<p>위의 script에서 조금만 수정해주면 된다.
(list item view는 위와 동일한 코드의 반복이므로 생략)</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>list.blade.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">div id</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"list1"</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  @</span><span class="token keyword" style=color:#00009f>include</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'list1_item'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">div</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">div id</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"list2"</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  @</span><span class="token keyword" style=color:#00009f>include</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'list2_item'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">div</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">script</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>var</span><span class="token plain"> paging_listener </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  $</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'.pagination a'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>click</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">e</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    e</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>preventDefault</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>var</span><span class="token plain"> page </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> $</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">this</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>attr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'href'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>split</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'?'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// page.split('=')[0]은 페이지 변수명을 가져온다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>var</span><span class="token plain"> paging_type </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> page</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>split</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'='</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>===</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'list1_page'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                      </span><span class="token operator" style=color:#393A34>?</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'list1'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                      </span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'list2'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>get_list</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">$</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">this</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>attr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'href'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> paging_type</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>var</span><span class="token plain"> get_list </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">url</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> target</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  $</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">url</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>then</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>function</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">html</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    $</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string backtick-quoted-string" style=color:#e3116c>`#${target}`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>html</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">html</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>paging_listener</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">script</span><span class="token operator" style=color:#393A34>></span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=여담>여담<a href=#여담 class=hash-link aria-label="여담에 대한 직접 링크" title="여담에 대한 직접 링크" translate=no>​</a></h2>
<p>이제 DB에서 데이터를 가져오는 것까지 끝났다.
<a class="" href=/2017/07/09/Laravel-5-4-Login-with-Auth/>다음 포스팅</a>에서는 User Login을 구현해보자.</div><footer class="row docusaurus-mt-lg"><div class=col><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/php/>php</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/laravel/>laravel</a></ul></div></footer></article><article class=margin-bottom--xl><header><h2 class=title_f1Hy><a href=/2017/05/24/composer-zlib-decode와-content-length-mismatch-오류/>composer zlib_decode와 content-length mismatch 오류</a></h2><div class="container_mt6G margin-vert--md"><time datetime=2017-05-24T22:14:22.000Z>2017년 5월 24일</time> · <!-- -->약 2분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class=avatar__photo-link href=/authors/me/><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"/></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=/authors/me/><span class=authorName_yefp translate=no>Eunkwang Shin</span></a></div><small class=authorTitle_nd0D title=Owner>Owner</small><div class=authorSocials_rSDt><a href=https://www.linkedin.com/in/gracefullight/ target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=LinkedIn><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em preserveAspectRatio=xMidYMid viewBox="0 0 256 256" style=--dark:#0a66c2;--light:#ffffffe6 class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"/></svg></a><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=GitHub><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 256 250" preserveAspectRatio=xMidYMid style=--dark:#000;--light:#fff class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"/></svg></a><a href=mailto:gracefullight.dev@gmail.com target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=Email><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 class=authorSocialIcon_XYv3><path stroke=none d="M0 0h24v24H0z"/><path d="M7.2 12a4.8 4.8 0 1 0 9.6 0 4.8 4.8 0 1 0-9.6 0"/><path d="M16.8 12v1.8a3 3 0 0 0 6 0V12a10.8 10.8 0 1 0-6.6 9.936"/></svg></a></div></div></div></div></div></header><div class=markdown><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=오류>오류<a href=#오류 class=hash-link aria-label="오류에 대한 직접 링크" title="오류에 대한 직접 링크" translate=no>​</a></h2>
<p>컴포저로 패키지를 다운 받은 후에 갑자기 오류가 나면서 다른 설치조차 안되는 경우가 있다.
오류 메세지는 아래 두 경우로 나타난다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=zlib_decode>zlib_decode<a href=#zlib_decode class=hash-link aria-label="zlib_decode에 대한 직접 링크" title="zlib_decode에 대한 직접 링크" translate=no>​</a></h3>
<p>json 파일 디코딩이 실패했다는 오류이다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">Failed to decode response: zlib_decode</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">: data error</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">Retrying with degraded mode, check https://getcomposer.org/doc/articles/troubleshooting.md</span><span class="token comment" style=color:#999988;font-style:italic>#degraded-mode for more info</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ErrorException</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">zlib_decode</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">: data error</span><br/></span></code></pre></div></div>
<p>위의 링크를 따라가 보면 해결책으로 다음과 같이 제시가 되는데
ESET antivirus는 아직 국내에서 쓰는 사람을 못 봤고, IPv6을 막아도 그대로일 것이다.</p>
<ul>
<li class="">If you are using ESET antivirus, go in "Advanced Settings" and disable "HTTP-scanner" under "web access protection"</li>
<li class="">If you are using IPv6, try disabling it. If that solves your issues, get in touch with your ISP or server host, the problem is not at the Packagist level but in the routing rules between you and Packagist (i.e. the internet at large). The best way to get these fixed is raise awareness to the network engineers that have the power to fix it. Take a look at the next section for IPv6 workarounds.</li>
<li class="">If none of the above helped, please report the error.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=content-length-mismatch>content-length mismatch<a href=#content-length-mismatch class=hash-link aria-label="content-length mismatch에 대한 직접 링크" title="content-length mismatch에 대한 직접 링크" translate=no>​</a></h3>
<p>composer의 패키지 list를 가지고 있는 json파일이 다 안받아졌다는 내용의 오류이다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Composer</span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain">Downloader</span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain">TransportException</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">Content-Length mismatch</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=해결>해결<a href=#해결 class=hash-link aria-label="해결에 대한 직접 링크" title="해결에 대한 직접 링크" translate=no>​</a></h2>
<p>구글링 해보면 clear-cache를 한 뒤에 composer -vvv 명령어를 사용해 디버깅 로그를 확인해보라는 내용이 주류인데 별 도움은 안 된다.
http 연결이아닌 https로 packagist에 붙어보라는 것도 해결되지 않았다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=packagist-repository-변경>packagist repository 변경<a href=#packagist-repository-변경 class=hash-link aria-label="packagist repository 변경에 대한 직접 링크" title="packagist repository 변경에 대한 직접 링크" translate=no>​</a></h3>
<p>packagist는 유럽에 있어서 한국에서 유럽까지 갔다가 다시 돌아오는 구조라,
<a href=https://packagist.jp/ target=_blank rel="noopener noreferrer" class="">packagist 일본 미러</a>를 이용하면 이 문제가 해결된다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>## 이 명령어로 global config에 repos.packagist 를 추가한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> config </span><span class="token parameter variable" style=color:#36acaa>-g</span><span class="token plain"> repos.packagist </span><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> https://packagist.jp</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 설정이 되었는지 확인한다..</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> config -gl</span><span class="token operator" style=color:#393A34>|</span><span class="token function" style=color:#d73a49>grep</span><span class="token plain"> repo</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 아래 설정이 보이면 추가가 된 것이다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">repositories.packagist.org.type</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>composer</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">repositories.packagist.org.url</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> https://packagist.jp</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=캐시-제거>캐시 제거<a href=#캐시-제거 class=hash-link aria-label="캐시 제거에 대한 직접 링크" title="캐시 제거에 대한 직접 링크" translate=no>​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> global clear-cache</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> clear-cache</span><br/></span></code></pre></div></div>
<p>이제 다시 패키지를 설치하면 설치가 될 것이다.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=다운로드-속도-향상>다운로드 속도 향상<a href=#다운로드-속도-향상 class=hash-link aria-label="다운로드 속도 향상에 대한 직접 링크" title="다운로드 속도 향상에 대한 직접 링크" translate=no>​</a></h2>
<p>병렬 다운로드를 가능하게 하는 <a href=https://github.com/hirak/prestissimo target=_blank rel="noopener noreferrer" class="">hirak/prestissimo</a> 패키지를 설치하자.
288s -> 26s 가 되는 마법이 일어난다고 한다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> global require hirak/prestissimo</span><br/></span></code></pre></div></div></div><footer class="row docusaurus-mt-lg"><div class=col><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/php/>php</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/composer/>composer</a></ul></div></footer></article><article class=margin-bottom--xl><header><h2 class=title_f1Hy><a href=/2017/05/16/Laravel-5-4-Start/>Laravel 5.5 - 시작하기</a></h2><div class="container_mt6G margin-vert--md"><time datetime=2017-05-16T22:34:39.000Z>2017년 5월 16일</time> · <!-- -->약 6분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class=avatar__photo-link href=/authors/me/><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"/></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=/authors/me/><span class=authorName_yefp translate=no>Eunkwang Shin</span></a></div><small class=authorTitle_nd0D title=Owner>Owner</small><div class=authorSocials_rSDt><a href=https://www.linkedin.com/in/gracefullight/ target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=LinkedIn><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em preserveAspectRatio=xMidYMid viewBox="0 0 256 256" style=--dark:#0a66c2;--light:#ffffffe6 class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"/></svg></a><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=GitHub><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 256 250" preserveAspectRatio=xMidYMid style=--dark:#000;--light:#fff class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"/></svg></a><a href=mailto:gracefullight.dev@gmail.com target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=Email><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 class=authorSocialIcon_XYv3><path stroke=none d="M0 0h24v24H0z"/><path d="M7.2 12a4.8 4.8 0 1 0 9.6 0 4.8 4.8 0 1 0-9.6 0"/><path d="M16.8 12v1.8a3 3 0 0 0 6 0V12a10.8 10.8 0 1 0-6.6 9.936"/></svg></a></div></div></div></div></div></header><div class=markdown><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=왜-라라벨인가>왜 라라벨인가?<a href=#왜-라라벨인가 class=hash-link aria-label="왜 라라벨인가?에 대한 직접 링크" title="왜 라라벨인가?에 대한 직접 링크" translate=no>​</a></h2>
<p><img decoding=async loading=lazy src=https://i.imgur.com/TuwFZD4.png alt="image from hexo" class=img_ev3q /></p>
<p>1등이 된지가 14년 7월이다. 이 글은 17년 글이다.
다른 장점이 궁금하다면 다른 포스트나 stackoverflow에서 해결해줄 것 같다.</p>
<p>이 글을 읽어주시는 분들은 <strong>Modern PHP에 대해 이해</strong>하고 있다고 생각했기 떄문에 문법적인 것들은 설명하지 않을 것이다.
<em>더군다나 라라벨을 도입하면서 삽질한 내용을 정리하고 있기에, 입문용은 절대 아니다.</em>
기본적으로 아래와 같은 PHP 개념을 알고 있어야한다.</p>
<ul>
<li class="">PSR</li>
<li class="">Composer</li>
<li class="">Class</li>
<li class="">Namespace</li>
<li class="">Closure</li>
<li class="">Trait</li>
<li class="">PDO</li>
</ul>
<p>추가적으로 이런 걸 사용해 봤다면 더 쉬울 듯하다.</p>
<ul>
<li class="">Monolog</li>
<li class="">다른 MVC 프레임워크</li>
<li class="">Lodash</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=설치>설치<a href=#설치 class=hash-link aria-label="설치에 대한 직접 링크" title="설치에 대한 직접 링크" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=php>PHP<a href=#php class=hash-link aria-label="PHP에 대한 직접 링크" title="PHP에 대한 직접 링크" translate=no>​</a></h3>
<p>PHP 7 이상을 설치해주고, 아래 Extension은 웬만하면 열어주는 것들이니 크게 신경쓰지 말자.</p>
<ul>
<li class="">PHP >= 7.0.0</li>
<li class="">OpenSSL PHP Extension</li>
<li class="">PDO PHP Extension</li>
<li class="">Mbstring PHP Extension</li>
<li class="">Tokenizer PHP Extension</li>
<li class="">XML PHP Extension</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=composer>Composer<a href=#composer class=hash-link aria-label="Composer에 대한 직접 링크" title="Composer에 대한 직접 링크" translate=no>​</a></h3>
<p><a href=https://getcomposer.org/download/ target=_blank rel="noopener noreferrer" class="">Composer 홈페이지</a>에서 다운받고 전역설정만 해주면 된다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=laravel-cli>Laravel Cli<a href=#laravel-cli class=hash-link aria-label="Laravel Cli에 대한 직접 링크" title="Laravel Cli에 대한 직접 링크" translate=no>​</a></h3>
<p>Laravel 명령어를 사용할 수 있게 composer로 전역 설치하자.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> global require </span><span class="token string" style=color:#e3116c>"laravel/installer"</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=프로젝트-생성>프로젝트 생성<a href=#프로젝트-생성 class=hash-link aria-label="프로젝트 생성에 대한 직접 링크" title="프로젝트 생성에 대한 직접 링크" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=초기-생성>초기 생성<a href=#초기-생성 class=hash-link aria-label="초기 생성에 대한 직접 링크" title="초기 생성에 대한 직접 링크" translate=no>​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">laravel new 프로젝트명</span><br/></span></code></pre></div></div>
<p>위 명령어를 실행하면, 알아서 composer 패키지까지 설치된다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=clone-했을-때>clone 했을 때<a href=#clone-했을-때 class=hash-link aria-label="clone 했을 때에 대한 직접 링크" title="clone 했을 때에 대한 직접 링크" translate=no>​</a></h3>
<p>환경 설정 파일과 프로젝트 키가 없으므로 적절하게 세팅해줘야한다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>## 패키지 의존성 설치</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## .env 파일 복사 (설정파일 생성)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## post-root-package-install scripts로 들어가 있긴한데, 복사가 안 되는 경우</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>cp</span><span class="token plain"> .env.example .env</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 프로젝트 키 생성</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ php artisan key:generate</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=실행>실행<a href=#실행 class=hash-link aria-label="실행에 대한 직접 링크" title="실행에 대한 직접 링크" translate=no>​</a></h3>
<p>프로젝트를 실행해보자.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">php artisan serve</span><br/></span></code></pre></div></div>
<p>이제 localhost:8000으로 라라벨 프로젝트에 접근이 가능하다.</p>
<blockquote>
<p>php artisan 명령어는 laravel에서 사용하는 커맨드 쉘이다.
<strong>php artisan</strong>로 명령어 리스트가 나오고 <strong>php artisan help 명령어</strong> 로 해당 명령어의 옵션을 볼 수 있다.</p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=프로젝트-구조>프로젝트 구조<a href=#프로젝트-구조 class=hash-link aria-label="프로젝트 구조에 대한 직접 링크" title="프로젝트 구조에 대한 직접 링크" translate=no>​</a></h2>
<p><a href=https://laravel.kr/docs/5.4/structure target=_blank rel="noopener noreferrer" class="">라라벨 한글 메뉴얼</a>이나 <a href=https://laravel.com/docs/5.4/structure target=_blank rel="noopener noreferrer" class="">공식 메뉴얼</a>을 보면 되는데 마치 사전을 펴놓았는데 어떤 단어를 찾는지 까먹은 느낌이 들 것이다.</p>
<p>모든 프레임워크는 Model, View, Controller, Routing만 알면 끝이라는 것을 잠시 기억 속에서 꺼내보고 <strong>딱 3가지 경로만 기억</strong>하자.</p>
<ul>
<li class=""><strong>Route</strong>: routes/</li>
<li class=""><strong>Controller</strong>: app/Http/Controllers/</li>
<li class=""><strong>View</strong> : resources/views/</li>
</ul>
<blockquote>
<p>모델은 어딨어? 라고 생각할 것 같은데 Model을 완벽하게 사용하려면 ORM을 써야하고 DB를 ORM에 맞게 정규화해야하며 이 작업은 처음 진행하기에 고통스럽다.
다음 포스트에 진행해보자.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=route>Route<a href=#route class=hash-link aria-label="Route에 대한 직접 링크" title="Route에 대한 직접 링크" translate=no>​</a></h3>
<p>모든 웹 프레임워크의 기본은 Routing이다.
routes 폴더에 기본으로 api, channels, console, web 파일이 보이는데 그 중 2가지만 알면 된다.</p>
<ul>
<li class="">api.php: Token 인증이 필요한 라우터로 <code>/api/{route}</code> 로 접근이 가능하다.</li>
<li class="">web.php: 기본적인 Route이다. GET이 아닌 다른 메소드는 CSRF Token이 있어야만 호출이 가능하다.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=controller>Controller<a href=#controller class=hash-link aria-label="Controller에 대한 직접 링크" title="Controller에 대한 직접 링크" translate=no>​</a></h3>
<p>Routing 요청을 처리하는 로직이 들어있는 부분이다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=view>View<a href=#view class=hash-link aria-label="View에 대한 직접 링크" title="View에 대한 직접 링크" translate=no>​</a></h3>
<p>Controller에서 처리된 데이터를 플랫폼에 보여주는 부분이다.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=프로젝트-세팅>프로젝트 세팅<a href=#프로젝트-세팅 class=hash-link aria-label="프로젝트 세팅에 대한 직접 링크" title="프로젝트 세팅에 대한 직접 링크" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=app-설정>App 설정<a href=#app-설정 class=hash-link aria-label="App 설정에 대한 직접 링크" title="App 설정에 대한 직접 링크" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=env-파일>env 파일<a href=#env-파일 class=hash-link aria-label="env 파일에 대한 직접 링크" title="env 파일에 대한 직접 링크" translate=no>​</a></h4>
<p>.env 파일에서 APP_NAME과 DB로 시작하는 설정을 바꿔준다.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=app-파일>app 파일<a href=#app-파일 class=hash-link aria-label="app 파일에 대한 직접 링크" title="app 파일에 대한 직접 링크" translate=no>​</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>config/app.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 시간대 세팅을 한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token string single-quoted-string" style=color:#e3116c>'timezone'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'Asia/Seoul'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 언어 설정을 한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// fallback_locale은 언어팩이있어야 하므로 아래에서 진행할 laravel-lang 설치 후 바꿔주자.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token string single-quoted-string" style=color:#e3116c>'locale'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'ko'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>]</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=database-파일>database 파일<a href=#database-파일 class=hash-link aria-label="database 파일에 대한 직접 링크" title="database 파일에 대한 직접 링크" translate=no>​</a></h4>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>config/database.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token string single-quoted-string" style=color:#e3116c>'connections'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'mysql'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// mysql일 경우 utf8로 설정해준다 (maria는 utf8mb4)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// DB 설정과 다르게 Model 이용시 charset 및 collation이 지정되어 들어가기에 꼭 설정해줘야한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'charset'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'utf8'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'collation'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'utf8_general_ci'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// 내 테이블의 접두사가 필요하다면 여기서 설정한다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// 예를들어 test_member, test_product 이런식의 테이블 명명규칙이라면 아래처럼 주면된다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'prefix'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'test_'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// engine 옵션은 my.ini에서 만져주자..</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'engine'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>null</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<blockquote>
<p>config 내의 파일과 .env파일을 건드릴 경우 laravel 환경을 다시 캐싱해주거나 아예 삭제해야 적용이 된다.
<strong>php artisan config<!-- -->:cache</strong> 명령어 또는 <strong>php artisan config<!-- -->:clear</strong> 명령어를 실행해주자.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=debug-bar>Debug Bar<a href=#debug-bar class=hash-link aria-label="Debug Bar에 대한 직접 링크" title="Debug Bar에 대한 직접 링크" translate=no>​</a></h3>
<p>정말 멋진 디버깅 툴이다.
간단히 설치 후에 .env 파일의 <strong>APP_DEBUG</strong> 옵션이 true이면 자동으로 View 하단에 생성된다.
아래와 같은 데이터를 확인할 수 있다.</p>
<ul>
<li class="">로그 내역</li>
<li class="">뷰 데이터 바인딩 확인</li>
<li class="">오류</li>
<li class="">라우팅</li>
<li class="">쿼리 실행</li>
<li class="">메일 발송 데이터</li>
<li class="">실행 시간</li>
<li class="">Request</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=설치-1>설치<a href=#설치-1 class=hash-link aria-label="설치에 대한 직접 링크" title="설치에 대한 직접 링크" translate=no>​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> require barryvdh/laravel-debugbar</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=laravel-lang>laravel-lang<a href=#laravel-lang class=hash-link aria-label="laravel-lang에 대한 직접 링크" title="laravel-lang에 대한 직접 링크" translate=no>​</a></h3>
<p>기본 오류 메세지들의 localization 패키지이다.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=설치-2>설치<a href=#설치-2 class=hash-link aria-label="설치에 대한 직접 링크" title="설치에 대한 직접 링크" translate=no>​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>composer</span><span class="token plain"> require caouecs/laravel-lang:~3.0</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=적용>적용<a href=#적용 class=hash-link aria-label="적용에 대한 직접 링크" title="적용에 대한 직접 링크" translate=no>​</a></h4>
<p><code>vendor/caouecs/laravel-lang/src/{국가}</code> 폴더를
<code>resources/lang/{국가}</code> 로 복사하고 <strong>config/app.php</strong> 의 <strong>fallback_locale</strong>을 <code>{국가}</code>로 바꿔주면 된다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>## 귀찮으니 git bash에서 날려봅시다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>cp</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-r</span><span class="token plain"> ./vendor/caouecs/laravel-lang/src/ko ./resources/lang/ko</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=라우팅>라우팅<a href=#라우팅 class=hash-link aria-label="라우팅에 대한 직접 링크" title="라우팅에 대한 직접 링크" translate=no>​</a></h2>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>routes/web.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// url 변수</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Route</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'/your_url/{id}'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Route</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'/your_url/{id?}'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$id</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>null</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=컨트롤러>컨트롤러<a href=#컨트롤러 class=hash-link aria-label="컨트롤러에 대한 직접 링크" title="컨트롤러에 대한 직접 링크" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=생성>생성<a href=#생성 class=hash-link aria-label="생성에 대한 직접 링크" title="생성에 대한 직접 링크" translate=no>​</a></h3>
<p>artisan 명령어로 간단히 생성할 수 있다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>## make:controller 폴더명/컨트롤러명</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ php artisan make:controller TestController</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>## 리소스 메소드를 같이 생성</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ php artisan make:controller TestController </span><span class="token parameter variable" style=color:#36acaa>--resource</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=연결>연결<a href=#연결 class=hash-link aria-label="연결에 대한 직접 링크" title="연결에 대한 직접 링크" translate=no>​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>routes/web.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 컨트롤러명@메소드명 으로 바로 연결시킬 수 있다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Route</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'/url/{id}'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'TestController@get'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Route</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>post</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'/url'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'TestContoller@post'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// CRUD가 명확한 컨트롤러인 경우 Resource를 사용하는 게 편할 수 있다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Route</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>resource</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'tests'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'TestController'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// only 또는 except로 원하는 resource만 가져갈 수 있다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token class-name static-context">Route</span><span class="token operator" style=color:#393A34>::</span><span class="token function" style=color:#d73a49>resource</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'tests'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'TestController'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token string single-quoted-string" style=color:#e3116c>'only'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string single-quoted-string" style=color:#e3116c>'index'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string single-quoted-string" style=color:#e3116c>'show'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>app/Http/Controllers/TestController.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Http</span><span class="token package punctuation" style=color:#393A34>\</span><span class="token package">Request</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"> </span><span class="token class-name-definition class-name">TestController</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>extends</span><span class="token plain"> </span><span class="token class-name">Controller</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 뷰를 호출</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>view</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'test.detail'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'data'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$data</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>post</span><span class="token punctuation" style=color:#393A34>(</span><span class="token class-name type-declaration">Request</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$id</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Request 데이터를 제어할 수 있다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$input</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>all</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$name</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$request</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>input</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'name'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$data</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// json body와 201 http code를 반환</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>response</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>json</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string single-quoted-string" style=color:#e3116c>'data'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$data</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>201</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=resource>Resource<a href=#resource class=hash-link aria-label="Resource에 대한 직접 링크" title="Resource에 대한 직접 링크" translate=no>​</a></h4>
<p>리소스 사용시라면 아래와 같은 메소드로 구성되어야한다.
게시판 컨트롤러라면 아래와 같은 구성일 것이다.</p>
<table><thead><tr><th>메소드<th>경로<th>액션<th>라우트.메소드<tbody><tr><td>GET<td>/boards<td>게시판 메인<td>boards.index<tr><td>GET<td>/boards/create<td>게시글 생성페이지<td>boards.create<tr><td>POST<td>/boards<td>게시글 저장<td>boards.store<tr><td>GET<td><code>/boards/{id}</code><td>게시글 상세페이지<td>boards.show<tr><td>GET<td><code>/boards/{id}/edit</code><td>게시글 수정페이지<td>boards.edit<tr><td>PUT/PATCH<td><code>/boards/{id}</code><td>게시글 수정로직<td>boards.update<tr><td>DELETE<td><code>/boards/{id}</code><td>게시글 삭제<td>boards.destroy</table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=뷰>뷰<a href=#뷰 class=hash-link aria-label="뷰에 대한 직접 링크" title="뷰에 대한 직접 링크" translate=no>​</a></h2>
<p>블레이드 템플릿을 사용하며 <a href=https://laravel.com/docs/5.4/blade#control-structures target=_blank rel="noopener noreferrer" class="">홈페이지</a> 설명이 꽤나 자세하다.
당장 알아야 할건 아래 두 개 정도 뿐이다. 나머지는 그때 그때 문서를 참조하자.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>resources/views/test/detail.blade.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// 바인딩한 데이터를 {{ }} 구문으로 바로 접근할 수 있다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$data</span><span class="token operator" style=color:#393A34>-></span><span class="token property" style=color:#36acaa>name</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain">님의 정보입니다</span><span class="token operator" style=color:#393A34>.</span><br/></span></code></pre></div></div>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>resources/views/test/create.blade.php</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// post로 전송시</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">form method</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"post"</span><span class="token plain"> url</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"/url"</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// post로 데이터를 전송시 csrf 토큰이 필요하다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 이 헬퍼함수를 호출하면 자동으로 토큰 값이 들어간 input hidden 필드가 생성된다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>csrf_field</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  이름</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">input type</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"text"</span><span class="token plain"> name</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"name"</span><span class="token plain"> vavlue</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>""</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">form</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 기타 메소드로 전송시</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">form method</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"post"</span><span class="token plain"> url</span><span class="token operator" style=color:#393A34>=</span><span class="token string double-quoted-string" style=color:#e3116c>"/url"</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>crsf_field</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// PUT, PATCH, DELETE 와 같은 메소드로 전송시 form 태그에서는 지원을 해주지 않으므로 method spoofing이 필요하다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 이 헬퍼함수를 호출하면 해결된다.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>method_field</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string single-quoted-string" style=color:#e3116c>'PUT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">form</span><span class="token operator" style=color:#393A34>></span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=여담>여담<a href=#여담 class=hash-link aria-label="여담에 대한 직접 링크" title="여담에 대한 직접 링크" translate=no>​</a></h2>
<p>이제 라라벨을 이용해 데이터를 서버에 보내고 뷰를 구성할 수 있게 되었다.
<a class="" href=/2017/06/06/Laravel-5-4-Eloquent-Model/>다음 포스팅</a>에서는 DB 연동과 ORM 모델을 사용해 데이터를 가져오고 페이징 처리를 해보자.</div><footer class="row docusaurus-mt-lg"><div class=col><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/php/>php</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/laravel/>laravel</a></ul></div></footer></article><article class=margin-bottom--xl><header><h2 class=title_f1Hy><a href=/2017/02/13/php-get-text-between-tags/>PHP에서 HTML tag 사이의 문자 가져오기</a></h2><div class="container_mt6G margin-vert--md"><time datetime=2017-02-13T15:00:14.000Z>2017년 2월 13일</time> · <!-- -->약 1분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class=avatar__photo-link href=/authors/me/><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"/></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=/authors/me/><span class=authorName_yefp translate=no>Eunkwang Shin</span></a></div><small class=authorTitle_nd0D title=Owner>Owner</small><div class=authorSocials_rSDt><a href=https://www.linkedin.com/in/gracefullight/ target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=LinkedIn><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em preserveAspectRatio=xMidYMid viewBox="0 0 256 256" style=--dark:#0a66c2;--light:#ffffffe6 class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"/></svg></a><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=GitHub><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 256 250" preserveAspectRatio=xMidYMid style=--dark:#000;--light:#fff class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"/></svg></a><a href=mailto:gracefullight.dev@gmail.com target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=Email><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 class=authorSocialIcon_XYv3><path stroke=none d="M0 0h24v24H0z"/><path d="M7.2 12a4.8 4.8 0 1 0 9.6 0 4.8 4.8 0 1 0-9.6 0"/><path d="M16.8 12v1.8a3 3 0 0 0 6 0V12a10.8 10.8 0 1 0-6.6 9.936"/></svg></a></div></div></div></div></div></header><div class=markdown><p>PHP 로 페이지를 크롤링한 후 HTML tag 안의 데이터가 필요할 때 함수 하나로 해결할 수 있다.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=소스>소스<a href=#소스 class=hash-link aria-label="소스에 대한 직접 링크" title="소스에 대한 직접 링크" translate=no>​</a></h2>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-php codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/**</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> * [splitBetweenStr 텍스트 사이의 문자열을 배열로 반환]</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> * @param  [string] $str        [전체 문자열]</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> * @param  [string] $startWord  [찾을 시작 문자열]</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> * @param  [string] $endWord    [찾을 종료 문자열]</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> * @return [array]              [텍스트 사이의 문자열 배열]</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> *</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> * ex) splitBetweenStr('&lt;br/>hi&lt;/br>&lt;b>test&lt;/b>&lt;br/>graceful_light&lt;/br>', '&lt;br/>', '&lt;/br>')</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> *     => ['hi', 'graceful_light']</span><br/></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> */</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function-definition function" style=color:#d73a49>splitBetweenStr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$str</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$startWord</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$endWord</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$i</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$len</span><span class="token operator" style=color:#393A34>=</span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$str</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$i</span><span class="token operator" style=color:#393A34>&lt;</span><span class="token variable" style=color:#36acaa>$len</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$target</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>substr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$str</span><span class="token punctuation" style=color:#393A34>,</span><span class="token variable" style=color:#36acaa>$i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$prevStartIdx</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>strpos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$target</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$startWord</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$startIdx</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$prevStartIdx</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$startWord</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>$endIdx</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>strpos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>substr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$target</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$startIdx</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$endWord</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$prevStartIdx</span><span class="token operator" style=color:#393A34>===</span><span class="token keyword type-declaration" style=color:#00009f>false</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>||</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$endIdx</span><span class="token operator" style=color:#393A34>===</span><span class="token constant boolean" style=color:#36acaa>false</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>break</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token variable" style=color:#36acaa>$betweenStrings</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>substr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$target</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$startIdx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$endIdx</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token variable" style=color:#36acaa>$i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$startIdx</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$endIdx</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>$endWord</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$betweenStrings</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=여담>여담<a href=#여담 class=hash-link aria-label="여담에 대한 직접 링크" title="여담에 대한 직접 링크" translate=no>​</a></h2>
<p>물론 <a href="https://packagist.org/search/?q=crawl&orderBys%5B0%5D%5Bsort%5D=downloads&orderBys%5B0%5D%5Border%5D=desc" target=_blank rel="noopener noreferrer" class="">다른 크롤러 라이브러리</a>를 사용하는게 속편하다.
호스팅 환경에서는 유용하게 사용할 수 있다.</div><footer class="row docusaurus-mt-lg"><div class=col><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/php/>php</a></ul></div></footer></article><article class=margin-bottom--xl><header><h2 class=title_f1Hy><a href=/2017/02/02/cURL-SSL-certificate-problem/>cURL error 60 SSL certificate problem</a></h2><div class="container_mt6G margin-vert--md"><time datetime=2017-02-02T23:50:09.000Z>2017년 2월 2일</time> · <!-- -->약 1분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class=avatar__photo-link href=/authors/me/><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"/></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=/authors/me/><span class=authorName_yefp translate=no>Eunkwang Shin</span></a></div><small class=authorTitle_nd0D title=Owner>Owner</small><div class=authorSocials_rSDt><a href=https://www.linkedin.com/in/gracefullight/ target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=LinkedIn><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em preserveAspectRatio=xMidYMid viewBox="0 0 256 256" style=--dark:#0a66c2;--light:#ffffffe6 class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"/></svg></a><a href=https://github.com/gracefullight target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=GitHub><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 256 250" preserveAspectRatio=xMidYMid style=--dark:#000;--light:#fff class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"/></svg></a><a href=mailto:gracefullight.dev@gmail.com target=_blank rel="noopener noreferrer" class=authorSocialLink_owbf title=Email><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 class=authorSocialIcon_XYv3><path stroke=none d="M0 0h24v24H0z"/><path d="M7.2 12a4.8 4.8 0 1 0 9.6 0 4.8 4.8 0 1 0-9.6 0"/><path d="M16.8 12v1.8a3 3 0 0 0 6 0V12a10.8 10.8 0 1 0-6.6 9.936"/></svg></a></div></div></div></div></div></header><div class=markdown><p>window localhost php 에서 cURL 함수 사용시
cURL error 60: SSL certificate problem...으로 시작하는 오류가 발생할 때가 있다.</p>
<p><img decoding=async loading=lazy src=https://i.imgur.com/u6XZCfz.png alt="image from hexo" class=img_ev3q /></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=해결>해결<a href=#해결 class=hash-link aria-label="해결에 대한 직접 링크" title="해결에 대한 직접 링크" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=키-다운로드>키 다운로드<a href=#키-다운로드 class=hash-link aria-label="키 다운로드에 대한 직접 링크" title="키 다운로드에 대한 직접 링크" translate=no>​</a></h3>
<p><a href=https://curl.haxx.se/ca/cacert.pem target=_blank rel="noopener noreferrer" class="">root certificate bundle</a>을 다운로드 받아 php 하위 경로로 넣어준다.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=등록>등록<a href=#등록 class=hash-link aria-label="등록에 대한 직접 링크" title="등록에 대한 직접 링크" translate=no>​</a></h3>
<p><strong>php.ini</strong>에서 키를 추가한다.</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>php.ini</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token section punctuation" style=color:#393A34>[</span><span class="token section section-name selector" style=color:#00009f>curl</span><span class="token section punctuation" style=color:#393A34>]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>; A default value for the CURLOPT_CAINFO option. This is required to be an</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>; absolute path.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token key attr-name" style=color:#00a4db>curl.cainfo</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>=</span><span class="token plain"> </span><span class="token value attr-value" style=color:#e3116c>D:/php7/extras/ssl/cacert.pem</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=참조>참조<a href=#참조 class=hash-link aria-label="참조에 대한 직접 링크" title="참조에 대한 직접 링크" translate=no>​</a></h2>
<ul>
<li class=""><a href=http://stackoverflow.com/questions/21114371/php-curl-error-code-60 target=_blank rel="noopener noreferrer" class="">PHP cURL error code 60</a></li>
</ul></div><footer class="row docusaurus-mt-lg"><div class=col><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/tags/php/>php</a></ul></div></footer></article><nav class=pagination-nav aria-label="블로그 게시물 목록 탐색"><a class="pagination-nav__link pagination-nav__link--prev" href=/tags/php/page/2/><div class=pagination-nav__label>이전 페이지</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/tags/php/page/4/><div class=pagination-nav__label>다음 페이지</div></a></nav></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Support Me</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://www.buymeacoffee.com/LOUB2kN target=_blank rel="noopener noreferrer" style="cursor: pointer;">
                <img src=https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png style="height: auto !important;width: auto !important;">
              </a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Feeds</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://gracefullight.dev/rss.xml target=_blank rel="noopener noreferrer" class=footer__link-item>RSS<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://gracefullight.dev/atom.xml target=_blank rel="noopener noreferrer" class=footer__link-item>Atom<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2016-2026 Eunkwang Shin.</div></div></div></footer></div></body>