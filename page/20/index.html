<!doctype html>
<html lang="ko" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Blog | gracefullight.dev</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://gracefullight.dev/page/20/"><meta data-rh="true" property="og:locale" content="ko"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="google-site-verification" content="gcY9SiftHgQoJjBZ7IgwNNN5_atLPAX6kWb1nFVfa6E"><meta data-rh="true" name="msvalidate.01" content="65AD1E28C0D057CEB3C68FBC0293E55B"><meta data-rh="true" name="naver-site-verification" content="d024c2837887f72dc7b3792b958be74d69ba9593"><meta data-rh="true" name="yandex-verification" content="6672f93d837354fb"><meta data-rh="true" name="baidu-site-verification" content="yZEdU1ABcR"><meta data-rh="true" name="facebook-domain-verification" content="uelupjqqsm5egzlhy1aev2rfxow5yt"><meta data-rh="true" property="og:title" content="Blog | gracefullight.dev"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://gracefullight.dev/page/20/"><link data-rh="true" rel="alternate" href="https://gracefullight.dev/page/20/" hreflang="ko"><link data-rh="true" rel="alternate" href="https://gracefullight.dev/en/page/20/" hreflang="en"><link data-rh="true" rel="alternate" href="https://gracefullight.dev/page/20/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://RFS69RSYOJ-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"Blog","@id":"https://gracefullight.dev/page/20","mainEntityOfPage":"https://gracefullight.dev/page/20","headline":"Blog","description":"Blog","blogPost":[{"@type":"BlogPosting","@id":"https://gracefullight.dev/2018/01/03/nginx-letsencrypt-fastest-way","mainEntityOfPage":"https://gracefullight.dev/2018/01/03/nginx-letsencrypt-fastest-way","url":"https://gracefullight.dev/2018/01/03/nginx-letsencrypt-fastest-way","headline":"nginx에 letsencrypt 인증서로 https 가장 빨리 적용하기","name":"nginx에 letsencrypt 인증서로 https 가장 빨리 적용하기","description":"centos7 기준","datePublished":"2018-01-03T13:29:33.000Z","author":{"@type":"Person","name":"Eunkwang Shin","description":"Owner","url":"https://github.com/gracefullight","image":"https://avatars.githubusercontent.com/u/11773683?v=4"},"keywords":[]},{"@type":"BlogPosting","@id":"https://gracefullight.dev/2018/01/01/react-native-windows-network-setting","mainEntityOfPage":"https://gracefullight.dev/2018/01/01/react-native-windows-network-setting","url":"https://gracefullight.dev/2018/01/01/react-native-windows-network-setting","headline":"리액트 네이티브 윈도우 네트워크 설정 (react-native)","name":"리액트 네이티브 윈도우 네트워크 설정 (react-native)","description":"리액트 네이티브로 개발한 앱을 Expo로 구동 중 network response timed out 에러 메세지가 보인다면 다음과 같이 해결하면 된다.","datePublished":"2018-01-01T23:50:31.000Z","author":{"@type":"Person","name":"Eunkwang Shin","description":"Owner","url":"https://github.com/gracefullight","image":"https://avatars.githubusercontent.com/u/11773683?v=4"},"keywords":[]},{"@type":"BlogPosting","@id":"https://gracefullight.dev/2017/12/27/utf8-charset에서-emoji-필터링","mainEntityOfPage":"https://gracefullight.dev/2017/12/27/utf8-charset에서-emoji-필터링","url":"https://gracefullight.dev/2017/12/27/utf8-charset에서-emoji-필터링","headline":"utf8 charset에서 emoji 필터링하기","name":"utf8 charset에서 emoji 필터링하기","description":"utf8 charset 에서는 이모지를 처리할 수 없다.","datePublished":"2017-12-27T13:05:20.000Z","author":{"@type":"Person","name":"Eunkwang Shin","description":"Owner","url":"https://github.com/gracefullight","image":"https://avatars.githubusercontent.com/u/11773683?v=4"},"keywords":[]},{"@type":"BlogPosting","@id":"https://gracefullight.dev/2017/12/26/Docker로-Swagger-설치-후-테마-설정하기","mainEntityOfPage":"https://gracefullight.dev/2017/12/26/Docker로-Swagger-설치-후-테마-설정하기","url":"https://gracefullight.dev/2017/12/26/Docker로-Swagger-설치-후-테마-설정하기","headline":"Docker로 스웨거 설치 후 테마 설정하기 (swagger)","name":"Docker로 스웨거 설치 후 테마 설정하기 (swagger)","description":"Swagger UI와 Swagger Editor를 Docker 로 띄워서 빠르게 사용해보자.","datePublished":"2017-12-26T22:03:44.000Z","author":{"@type":"Person","name":"Eunkwang Shin","description":"Owner","url":"https://github.com/gracefullight","image":"https://avatars.githubusercontent.com/u/11773683?v=4"},"keywords":[]},{"@type":"BlogPosting","@id":"https://gracefullight.dev/2017/12/22/PWA-ServiceWorker-Web-Caching","mainEntityOfPage":"https://gracefullight.dev/2017/12/22/PWA-ServiceWorker-Web-Caching","url":"https://gracefullight.dev/2017/12/22/PWA-ServiceWorker-Web-Caching","headline":"PWA - 서비스 워커 웹 캐싱 (Web Caching)","name":"PWA - 서비스 워커 웹 캐싱 (Web Caching)","description":"Progressive Web App의 시대가 왔다.","datePublished":"2017-12-22T20:53:41.000Z","author":{"@type":"Person","name":"Eunkwang Shin","description":"Owner","url":"https://github.com/gracefullight","image":"https://avatars.githubusercontent.com/u/11773683?v=4"},"keywords":[]},{"@type":"BlogPosting","@id":"https://gracefullight.dev/2017/12/21/adonisjs-custom-log-format","mainEntityOfPage":"https://gracefullight.dev/2017/12/21/adonisjs-custom-log-format","url":"https://gracefullight.dev/2017/12/21/adonisjs-custom-log-format","headline":"adonisjs 로그 포맷 변경하기 (custom log format)","name":"adonisjs 로그 포맷 변경하기 (custom log format)","description":"아도니스는 로깅 모듈로 winston 을 사용하는데 winston 은 로그를 json 포맷으로 출력하고 심지어 timezone 변수가 따로 나온다.","datePublished":"2017-12-21T15:25:45.000Z","author":{"@type":"Person","name":"Eunkwang Shin","description":"Owner","url":"https://github.com/gracefullight","image":"https://avatars.githubusercontent.com/u/11773683?v=4"},"keywords":[]},{"@type":"BlogPosting","@id":"https://gracefullight.dev/2017/12/06/Why-redux-saga","mainEntityOfPage":"https://gracefullight.dev/2017/12/06/Why-redux-saga","url":"https://gracefullight.dev/2017/12/06/Why-redux-saga","headline":"왜 리덕스 사가(Redux-saga) 인가?","name":"왜 리덕스 사가(Redux-saga) 인가?","description":"redux, redux-thunk, redux-promise-middleware, redux-actions, redux-saga 머리가 뽀개질 지경이다. 결국엔 redux-saga를 써야만 했고 왜 saga로 수렴하게 되는지에 대한 삽질기다.","datePublished":"2017-12-06T09:50:37.000Z","author":{"@type":"Person","name":"Eunkwang Shin","description":"Owner","url":"https://github.com/gracefullight","image":"https://avatars.githubusercontent.com/u/11773683?v=4"},"keywords":[]},{"@type":"BlogPosting","@id":"https://gracefullight.dev/2017/11/28/Vue-Laravel-Pagination-연동","mainEntityOfPage":"https://gracefullight.dev/2017/11/28/Vue-Laravel-Pagination-연동","url":"https://gracefullight.dev/2017/11/28/Vue-Laravel-Pagination-연동","headline":"Vue - Laravel Pagination 연동","name":"Vue - Laravel Pagination 연동","description":"Laravel에서 paginate 메소드를 json으로 받았을 시에 데이터는 다음과 같다.","datePublished":"2017-11-28T15:36:34.000Z","author":{"@type":"Person","name":"Eunkwang Shin","description":"Owner","url":"https://github.com/gracefullight","image":"https://avatars.githubusercontent.com/u/11773683?v=4"},"keywords":[]},{"@type":"BlogPosting","@id":"https://gracefullight.dev/2017/11/23/React-Router-Code-Splitting-가장-쉬운-방법","mainEntityOfPage":"https://gracefullight.dev/2017/11/23/React-Router-Code-Splitting-가장-쉬운-방법","url":"https://gracefullight.dev/2017/11/23/React-Router-Code-Splitting-가장-쉬운-방법","headline":"React-Router Code Splitting - 가장 쉬운 방법","name":"React-Router Code Splitting - 가장 쉬운 방법","description":"create-react-app으로 생성한 리액트 앱에 시작시 가져오는 컴포넌트 빼고는 비동기로 불러와야 메인이 가벼워진다.","datePublished":"2017-11-23T10:58:22.000Z","author":{"@type":"Person","name":"Eunkwang Shin","description":"Owner","url":"https://github.com/gracefullight","image":"https://avatars.githubusercontent.com/u/11773683?v=4"},"keywords":[]},{"@type":"BlogPosting","@id":"https://gracefullight.dev/2017/11/22/Laravel-5-5-Model-Collection-데이터-처리하기","mainEntityOfPage":"https://gracefullight.dev/2017/11/22/Laravel-5-5-Model-Collection-데이터-처리하기","url":"https://gracefullight.dev/2017/11/22/Laravel-5-5-Model-Collection-데이터-처리하기","headline":"Laravel 5.5 - Model Collection 데이터 처리하기","name":"Laravel 5.5 - Model Collection 데이터 처리하기","description":"Model Collection의 데이터를 처리하는 메소드를 사용하고 싶을 때 아래처럼 접근하면 된다.","datePublished":"2017-11-22T16:39:54.000Z","author":{"@type":"Person","name":"Eunkwang Shin","description":"Owner","url":"https://github.com/gracefullight","image":"https://avatars.githubusercontent.com/u/11773683?v=4"},"keywords":[]}]}</script><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="gracefullight.dev RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="gracefullight.dev Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="gracefullight.dev JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E99DNE7S05"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-E99DNE7S05",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="gracefullight.dev" href="/opensearch.xml">
<link rel="icon" href="/img/favicon-32x32.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#f28913">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f28913">
<link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
<link rel="preconnect" href="https://pagead2.googlesyndication.com">
<script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3004788392777865" async crossorigin="anonymous"></script>
<link rel="preconnect" href="https://www.clarity.ms">
<script>!function(t,e,n,a,c,i,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(i=e.createElement(a)).async=1,i.src="https://www.clarity.ms/tag/aongv9xgi6",(r=e.getElementsByTagName(a)[0]).parentNode.insertBefore(i,r)}(window,document,"clarity","script")</script>
<link rel="preconnect" href="https://wcs.naver.net">
<script src="https://wcs.naver.net/wcslog.js" async></script>
<script>if(!wcs_add)var wcs_add={};wcs_add.wa="156bc73a81e3bd0",window.wcs&&wcs_do()</script>
<link rel="preconnect" href="https://cdn.channel.io">
<script>!function(){var n=window;if(n.ChannelIO)return(window.console.error||window.console.log||function(){})("ChannelIO script included twice.");var e=function(){e.c(arguments)};function t(){if(!n.ChannelIOInitialized){n.ChannelIOInitialized=!0;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://cdn.channel.io/plugin/ch-plugin-web.js",e.charset="UTF-8";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}}e.q=[],e.c=function(n){e.q.push(n)},n.ChannelIO=e,"complete"===document.readyState?t():window.attachEvent?window.attachEvent("onload",t):(window.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1))}(),ChannelIO("boot",{pluginKey:"0fd130ba-a1a6-4b7e-802a-e82a885a7fd8"})</script>
<link rel="preconnect" href="https://static.cloudflareinsights.com">
<script src="https://static.cloudflareinsights.com/beacon.min.js" defer="defer" data-cf-beacon="{&quot;token&quot;:&quot;c0899829e72b45e98dff77241127252c&quot;}"></script>

<link rel="preconnect" href="https://cdn.jsdelivr.net">
<script type="application/ld+json">{"@context":"http://schema.org","@type":"Person","name":"Eunkwang Shin","url":"https://gracefullight.dev","logo":"https://gracefullight.dev/img/apple-touch-icon.png","image":"https://avatars.githubusercontent.com/u/11773683?v=4","email":"mailto:gracefullight.dev@gmail.com","jobTitle":"FullStack JavaScript Developer","nationality":"Korean","sameAs":["https://github.com/gracefullight","https://linkedin.com/in/gracefullight"]}</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.790b4b5e.css">
<script src="/assets/js/runtime~main.854585d2.js" defer="defer"></script>
<script src="/assets/js/main.454df1d4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_WBrX" href="#__docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon-32x32.png" alt="gracefullight.dev blog logo" class="themedComponent_loFd themedComponent--light_aQTj"><img src="/img/favicon-32x32.png" alt="gracefullight.dev blog logo" class="themedComponent_loFd themedComponent--dark_iQnR"></div><b class="navbar__title text--truncate">gracefullight.dev</b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" href="/page/20/"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_KyAb"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>한국어</a><ul class="dropdown__menu"><li><a href="/page/20/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ko">한국어</a></li><li><a href="/en/page/20/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li></ul></div><a class="navbar__item navbar__link" href="/archive/">Archives</a><a class="navbar__item navbar__link" href="/tags/">Tags</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_DA5m"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.linkedin.com/in/gracefullight" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_DA5m"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_OR63"><button type="button" class="DocSearch DocSearch-Button" aria-label="검색"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">검색</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_JLL2"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_S4Gl thin-scrollbar" aria-label="최근 블로그 문서 둘러보기"><div class="sidebarItemTitle_Iclf margin-bottom--md">최근 포스트</div><ul class="sidebarItemList_doLt clean-list"><li class="sidebarItem_O1y5"><a class="sidebarItemLink_PcYN" href="/pe/convergence/matter/">매터</a></li><li class="sidebarItem_O1y5"><a class="sidebarItemLink_PcYN" href="/pe/convergence/metaverse/">메타버스</a></li><li class="sidebarItem_O1y5"><a class="sidebarItemLink_PcYN" href="/pe/convergence/digital-literacy/">디지털 리터러시</a></li><li class="sidebarItem_O1y5"><a class="sidebarItemLink_PcYN" href="/pe/convergence/quantum-computer/">양자컴퓨터</a></li><li class="sidebarItem_O1y5"><a class="sidebarItemLink_PcYN" href="/pe/management/digital-transformation/">DX, 디지털 트랜스포메이션</a></li><li class="sidebarItem_O1y5"><a class="sidebarItemLink_PcYN" href="/pe/architecture/semahpore/">Semahpore, 세마포어</a></li><li class="sidebarItem_O1y5"><a class="sidebarItemLink_PcYN" href="/pe/engineering/pmo-project-management-office/">전자정부사업관리 위탁, PMO</a></li><li class="sidebarItem_O1y5"><a class="sidebarItemLink_PcYN" href="/pe/convergence/deepfake/">딥페이크</a></li><li class="sidebarItem_O1y5"><a class="sidebarItemLink_PcYN" href="/pe/engineering/3R-reuse-reengineering-reverseengineering/">3R, Reuse, Re-engineering, Reverse-engineering</a></li><li class="sidebarItem_O1y5"><a class="sidebarItemLink_PcYN" href="/pe/engineering/canary-test/">카나리 테스트</a></li></ul></nav></aside><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="title_cZeS"><a href="/2018/01/03/nginx-letsencrypt-fastest-way/">nginx에 letsencrypt 인증서로 https 가장 빨리 적용하기</a></h2><div class="container_lqpW margin-vert--md"><time datetime="2018-01-03T13:29:33.000Z">2018년 1월 3일</time> · <!-- -->약 1분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_AS4B"><div class="avatar margin-bottom--sm"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer"><span>Eunkwang Shin</span></a></div><small class="avatar__subtitle">Owner</small></div></div></div></div></header><div class="markdown"><blockquote>
<p>centos7 기준</p>
</blockquote>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ vi /etc/yum.repos.d/nginx.repo</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">[nginx]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">name=nginx repo</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">baseurl=http://nginx.org/packages/centos/7/$basearch/</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">gpgcheck=0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">enabled=1</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ yum makecache</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ yum install -y nginx</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ vi /etc/nginx/conf.d/default.conf</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># server_name에 도메인 연결</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 문법 체크</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ nginx -t</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># nginx 시작</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ systemctl enable nginx</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ systemctl start nginx</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>certbot 설치</h1>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ yum install -y epel-release</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ yum install -y certbot-nginx</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># 인증</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ certbot --nginx -d my.domain.com</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>ssl nginx 설정</h1>
<p><a href="/2017/06/10/CentOS7-LEMP-Stack-적용/#nginx-%EC%97%B0%EB%8F%99">기존 포스트</a> nginx 연동 탭 참조</p>
<h1>renew 설정</h1>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ crontab -e</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">1 0 1 * * certbot renew --nginx</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ systemctl restart crond</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>systemctl restart nginx</code> 하면 완료</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>태그:</b><ul class="tags_cJ0C padding--none margin-left--sm"><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/linux/">linux</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/nginx/">nginx</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/letsencrypt/">letsencrypt</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_cZeS"><a href="/2018/01/01/react-native-windows-network-setting/">리액트 네이티브 윈도우 네트워크 설정 (react-native)</a></h2><div class="container_lqpW margin-vert--md"><time datetime="2018-01-01T23:50:31.000Z">2018년 1월 1일</time> · <!-- -->약 2분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_AS4B"><div class="avatar margin-bottom--sm"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer"><span>Eunkwang Shin</span></a></div><small class="avatar__subtitle">Owner</small></div></div></div></div></header><div class="markdown"><p>리액트 네이티브로 개발 한 앱을 <code>Expo</code>로 구동 중 <code>network response timed out</code> 에러 메세지가 보인다면 다음과 같이 해결하면 된다.</p>
<p>인바운드로 19000, 19001 포트를 열어줘야한다.
<strong>방화벽 &gt; 고급 설정 &gt; 인바운드 규칙 &gt; 새 규칙 &gt; 포트</strong> 에서 아래와 같이 설정해주고 이름은 <code>react-native-expo</code> 등 원하는 이름으로 규칙을 생성하자.</p>
<p><img decoding="async" loading="lazy" src="https://i.imgur.com/fQkG1tn.png" alt="image from hexo" class="img_Y9wi"></p>
<h1>Hostname 설정</h1>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="아이피-확인">아이피 확인<a class="hash-link" aria-label="아이피 확인에 대한 직접 링크" title="아이피 확인에 대한 직접 링크" href="/page/20/#아이피-확인">​</a></h2>
<p>ipconfig로 현재 Wifi가 설정된 내부 아이피 주소를 확인한다.</p>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">무선 LAN 어댑터 Wi-Fi:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  연결별 DNS 접미사. . . . :</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  링크-로컬 IPv6 주소 . . . . :</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  IPv4 주소 . . . . . . . . . : 192.168.0.7</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  서브넷 마스크 . . . . . . . : 255.255.255.0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  기본 게이트웨이 . . . . . . : 192.168.0.1</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>192.168.0.7</strong> 을 기억해 놓자.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="설정-추가">설정 추가<a class="hash-link" aria-label="설정 추가에 대한 직접 링크" title="설정 추가에 대한 직접 링크" href="/page/20/#설정-추가">​</a></h2>
<p><code>REACT_NATIVE_PACKAGER_HOSTNAME</code> 환경 변수를 설정해줘야한다.</p>
<p>Git Bash 환경에서는 다음과 같다.</p>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">export REACT_NATIVE_PACKAGER_HOSTNAME=192.168.0.7</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>실행</h1>
<p><code>yarn start</code> 후에 Expo 앱으로 QRCode를 찍으면 정상적으로 실행이 가능하다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>태그:</b><ul class="tags_cJ0C padding--none margin-left--sm"><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/react/">react</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/javascript/">javascript</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_cZeS"><a href="/2017/12/27/utf8-charset에서-emoji-필터링/">utf8 charset에서 emoji 필터링하기</a></h2><div class="container_lqpW margin-vert--md"><time datetime="2017-12-27T13:05:20.000Z">2017년 12월 27일</time> · <!-- -->약 2분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_AS4B"><div class="avatar margin-bottom--sm"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer"><span>Eunkwang Shin</span></a></div><small class="avatar__subtitle">Owner</small></div></div></div></div></header><div class="markdown"><p>utf8 charset 에서는 이모지를 처리할 수 없다.
<a href="https://blog.lael.be/post/917" target="_blank" rel="noopener noreferrer">utf8mb4 언어셋 소개 및 표현범위</a> 포스팅에 따르면 이모지가 mysql 또는 maria 의 utf8 셋의 가변공간을 사용하려 들려 하는 문제인데, utf8mb4 셋으로 변경하면 해결 된다.</p>
<p>mysql 이거나 maria 의 charset 을 변경하기 힘들 때 text 를 모두 replace 치면 된다. 시작해보자</p>
<h1>php</h1>
<p><a href="https://stackoverflow.com/questions/12807176/php-writing-a-simple-removeemoji-function" target="_blank" rel="noopener noreferrer">writing a simple removeEmoji function</a> stackoverflow 글에 좋은 함수가 있다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="소스">소스<a class="hash-link" aria-label="소스에 대한 직접 링크" title="소스에 대한 직접 링크" href="/page/20/#소스">​</a></h2>
<div class="language-php codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-php codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// https://stackoverflow.com/questions/12807176/php-writing-a-simple-removeemoji-function</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">function removeEmoji($text) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = &quot;&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Match Emoticons</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $regexEmoticons = &#x27;/[\x{1F600}-\x{1F64F}]/u&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = preg_replace($regexEmoticons, &#x27;&#x27;, $text);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Match Miscellaneous Symbols and Pictographs</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $regexSymbols = &#x27;/[\x{1F300}-\x{1F5FF}]/u&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = preg_replace($regexSymbols, &#x27;&#x27;, $clean_text);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Match Transport And Map Symbols</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $regexTransport = &#x27;/[\x{1F680}-\x{1F6FF}]/u&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = preg_replace($regexTransport, &#x27;&#x27;, $clean_text);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Match Miscellaneous Symbols</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $regexMisc = &#x27;/[\x{2600}-\x{26FF}]/u&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = preg_replace($regexMisc, &#x27;&#x27;, $clean_text);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Match Dingbats</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $regexDingbats = &#x27;/[\x{2700}-\x{27BF}]/u&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = preg_replace($regexDingbats, &#x27;&#x27;, $clean_text);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Match Flags</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $regexDingbats = &#x27;/[\x{1F1E6}-\x{1F1FF}]/u&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = preg_replace($regexDingbats, &#x27;&#x27;, $clean_text);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Others</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $regexDingbats = &#x27;/[\x{1F910}-\x{1F95E}]/u&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = preg_replace($regexDingbats, &#x27;&#x27;, $clean_text);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $regexDingbats = &#x27;/[\x{1F980}-\x{1F991}]/u&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = preg_replace($regexDingbats, &#x27;&#x27;, $clean_text);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $regexDingbats = &#x27;/[\x{1F9C0}]/u&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = preg_replace($regexDingbats, &#x27;&#x27;, $clean_text);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $regexDingbats = &#x27;/[\x{1F9F9}]/u&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $clean_text = preg_replace($regexDingbats, &#x27;&#x27;, $clean_text);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return $clean_text;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-php codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-php codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$textWithEmoji = &#x27;thumbs up👍👍&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$text = removeEmoji($textWithEmoji);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// text =&gt; thumbs up</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>node</h1>
<p><a href="https://github.com/mathiasbynens/emoji-regex" target="_blank" rel="noopener noreferrer">emoji-regex</a> 라이브러리를 쓰면 된다.</p>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ yarn add emoji-regex</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="소스-1">소스<a class="hash-link" aria-label="소스에 대한 직접 링크" title="소스에 대한 직접 링크" href="/page/20/#소스-1">​</a></h2>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> emojiRegex </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;emoji-regex&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// const regex = emojiRegex()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> textWithEmoji </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;thumbs up👍👍&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> text </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> textWithEmoji</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">replace</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">emojiRegex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// text =&gt; thumbs up</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>여담</h1>
<p>이모지처리 (붙히고 제거하고), linkify 를 합친 통합 모듈이 있다면 다운로드 수가 좀 될 것 같은데.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>태그:</b><ul class="tags_cJ0C padding--none margin-left--sm"><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/php/">php</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/nodejs/">nodejs</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/mariadb/">mariadb</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/mysql/">mysql</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_cZeS"><a href="/2017/12/26/Docker로-Swagger-설치-후-테마-설정하기/">Docker로 스웨거 설치 후 테마 설정하기 (swagger)</a></h2><div class="container_lqpW margin-vert--md"><time datetime="2017-12-26T22:03:44.000Z">2017년 12월 26일</time> · <!-- -->약 2분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_AS4B"><div class="avatar margin-bottom--sm"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer"><span>Eunkwang Shin</span></a></div><small class="avatar__subtitle">Owner</small></div></div></div></div></header><div class="markdown"><p><a href="https://hub.docker.com/r/swaggerapi/swagger-ui/" target="_blank" rel="noopener noreferrer">Swagger UI</a>와 <a href="https://hub.docker.com/r/swaggerapi/swagger-editor/" target="_blank" rel="noopener noreferrer">Swagger Editor</a>를 Docker 로 띄워서 빠르게 사용해보자.
<a href="https://swaggerhub.com/" target="_blank" rel="noopener noreferrer">Swagger Hub</a>에서 작업하는건 한글 입력이 잘 되지 않는 경우가 있었고 <a href="https://github.com/OAI/OpenAPI-Specification" target="_blank" rel="noopener noreferrer">OAS3</a>를 사용할 겸 설치하는 게 편하다.</p>
<p>설치는 서버 하나만 있으면 충분하다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="editor">Editor<a class="hash-link" aria-label="Editor에 대한 직접 링크" title="Editor에 대한 직접 링크" href="/page/20/#editor">​</a></h2>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ docker run -d \</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    -p 7000:8080 \</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    --restart always \</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    --name swagger-editor \</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    swaggerapi/swagger-editor</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="ui">UI<a class="hash-link" aria-label="UI에 대한 직접 링크" title="UI에 대한 직접 링크" href="/page/20/#ui">​</a></h2>
<p>UI 에서는 API 문서를 상대경로로 사용하기 위해 볼륨 마운트를 했다.
<em>Docker for Windows</em>에서 c 드라이브를 마운트하기 위해서는 아래처럼 <code>//c/path</code> 로 접근하면 된다.</p>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ docker run -d \</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    -p 9010:8080 \</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    -v //c/swagger-spec:/usr/share/nginx/html/spec \</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    --restart always \</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    --name swagger-ui \</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    swaggerapi/swagger-ui</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>테마 추가</h1>
<p>테마는 <a href="https://github.com/ostranme/swagger-ui-themes" target="_blank" rel="noopener noreferrer">나이스한 라이브러리</a>를 사용하자.
두 컨테이너 모두 <code>/usr/share/nginx/html/</code> 경로의 <code>index.html</code>을 열어 head 안에 넣어주면 된다.</p>
<p><code>docker exec</code>로 쉘에 접근하는 건 다 하시리라 믿고 다만, 컨테이너에 bash 쉘이 없기에 기본 sh 쉘로 접근하면 된다.</p>
<div class="language-html codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">index.html</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-html codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">link</span><span class="token tag" style="color:rgb(78, 201, 176)"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token tag" style="color:rgb(78, 201, 176)">  </span><span class="token tag attr-name" style="color:rgb(156, 220, 254)">rel</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(212, 212, 212)">=</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag attr-value" style="color:rgb(206, 145, 120)">stylesheet</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag" style="color:rgb(78, 201, 176)"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token tag" style="color:rgb(78, 201, 176)">  </span><span class="token tag attr-name" style="color:rgb(156, 220, 254)">href</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(212, 212, 212)">=</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag attr-value" style="color:rgb(206, 145, 120)">https://unpkg.com/swagger-ui-themes@3.0.0/themes/3.x/theme-material.css</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag" style="color:rgb(78, 201, 176)"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token tag" style="color:rgb(78, 201, 176)"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">/&gt;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>여담</h1>
<p>스웨거에 side menu 가 있는 버전이나 라이브러리가 있으면 좋을텐데, 누가 만들었을 것 같은데 아직 못 찾았다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>태그:</b><ul class="tags_cJ0C padding--none margin-left--sm"><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/swagger/">swagger</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/docker/">docker</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_cZeS"><a href="/2017/12/22/PWA-ServiceWorker-Web-Caching/">PWA - 서비스 워커 웹 캐싱 (Web Caching)</a></h2><div class="container_lqpW margin-vert--md"><time datetime="2017-12-22T20:53:41.000Z">2017년 12월 22일</time> · <!-- -->약 16분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_AS4B"><div class="avatar margin-bottom--sm"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer"><span>Eunkwang Shin</span></a></div><small class="avatar__subtitle">Owner</small></div></div></div></div></header><div class="markdown"><p>Progressive Web App의 시대가 왔다.
Client단에서 모든 static 파일을 브라우저에 캐시를 할 수 있고 <strong>웹을 앱처럼 오프라인</strong>에서 작업하게 할 수 있다.
그 첫번째로 캐싱에 대해 알아보자.</p>
<h1>준비</h1>
<p>Promise, Fetch, Worker 및 Javascript 의 실행 구조, DOM 에 대한 사전지식이 필히 있어야 한다.
HTTP Cache 를 걸어봤다면 이해가 쉬울 듯 싶다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="serviceworker">ServiceWorker<a class="hash-link" aria-label="ServiceWorker에 대한 직접 링크" title="ServiceWorker에 대한 직접 링크" href="/page/20/#serviceworker">​</a></h2>
<p>서비스 워커는 <strong>브라우저가 백그라운드에서 실행하는 스크립트</strong>이며, <strong>클라이언트에 설치되는 프록시</strong>다.
이 개념은 중요해서 외워야한다. <strong>브라우저 백그라운드에서 네트워크를 가로채는 Thread</strong> 라고 보면 된다.</p>
<p>웹 캐싱 뿐만 아니라 백그라운드 동기화, 웹 푸쉬 등의 기능을 처리할 수 있다. 궁금하다면 <a href="https://serviceworke.rs/" target="_blank" rel="noopener noreferrer">여기</a>를 들어가보자. (포스팅을 다 읽고 들어가보는 걸 추천한다.)</p>
<p>웹 캐싱은 <a href="https://developer.mozilla.org/ko/docs/Web/API/CacheStorage" target="_blank" rel="noopener noreferrer">CacheStorage</a>를 사용한다. Sqlite 같은 클라이언트 데이터베이스인데, Key<!-- -->:value<!-- --> 로 구성된 데이터베이스라고 보면 된다.</p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="주의">주의<a class="hash-link" aria-label="주의에 대한 직접 링크" title="주의에 대한 직접 링크" href="/page/20/#주의">​</a></h3>
<blockquote>
<p>https 환경 또는 localhost 도메인에서만 이 기능을 사용할 수 있다.</p>
</blockquote>
<p>브라우저별 지원상황은 <a href="https://jakearchibald.github.io/isserviceworkerready/#service-worker-enthusiasm" target="_blank" rel="noopener noreferrer">다음</a>과 같다 1803기준 Safari에도 Shipped가 되었다!
<del>1712 기준 Safari가 아직도 Developement 상태인게 조금 아쉽다</del></p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="세팅">세팅<a class="hash-link" aria-label="세팅에 대한 직접 링크" title="세팅에 대한 직접 링크" href="/page/20/#세팅">​</a></h3>
<p><code>sw.js</code>란 파일을 <code>public</code>폴더(index.html이 있는)에 생성하자.
그리고 메인 script파일에 다음과 같이 service-worker를 불러오는 구문을 추가한다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// navigator (브라우저)에 serviceWorker 기능이 있는지 확인</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;serviceWorker&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(156, 220, 254)">navigator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// 서비스워커 설치시 DOM 블로킹을 막아준다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token dom variable" style="color:rgb(156, 220, 254)">window</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">addEventListener</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;load&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// 서비스워커를 register 하면 promise를 반환한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token dom variable" style="color:rgb(156, 220, 254)">navigator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">serviceWorker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">register</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/sw.js&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token console class-name" style="color:rgb(78, 201, 176)">console</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">log</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;서비스 워커가 등록되었다.&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">catch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token console class-name" style="color:rgb(78, 201, 176)">console</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">log</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>개발자도구를 열고 <strong>Application &gt; ServiceWorkers</strong> 탭으로 가면 설치가 된 것을 확인할 수 있다.</p>
<p><img decoding="async" loading="lazy" src="https://i.imgur.com/zE1BefE.png" alt="image from hexo" class="img_Y9wi"></p>
<p>이렇게 뜨면 설치된 것이다.</p>
<h1>Basic</h1>
<p>서비스워커에서는 <code>self</code> 키워드로 자기 자신을 접근할 수 있다. 몇 가지 static 파일들을 캐싱처리 해보자.
모던 브라우저에서만 지원이 되므로 <code>arrow function</code>을 사용해도 된다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">sw.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">PRE_CACHE_NAME</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;캐시-스토리지1&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐시하고 싶은 리소스</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> urlsToCache </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/public/image/image1.png&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/public/css/font-awesome.min.css&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// 서비스워커가 설치될 때</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">addEventListener</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;install&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐시 등록 이벤트가 끝날 때까지 기다려</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">waitUntil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// &#x27;캐시-스토리지1&#x27;을 연다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// @return {Promise} 연결된 Cache Database를 반환한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    caches</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">open</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">PRE_CACHE_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token console class-name" style="color:rgb(78, 201, 176)">console</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">log</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;캐시 디비와 연결됨&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// addAll 메소드로 내가 캐싱할 리소스를 다 넣어주자.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">addAll</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">urlsToCache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// 설치 후에 바로 활성화 단계로 들어갈 수 있게 해준다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">skipWaiting</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>이렇게 추가해주고 개발자도구의 Application 탭으로 가서 좌측 메뉴의 <strong>Cache Storage</strong> 를 새로고침 하면 방금 추가한 <strong>캐시-스토리지1</strong>에 내 이미지와 css가 등록된 걸 확인할 수 있다.</p>
<p>그리고 개발자도구의 Network 탭에서 호출하는 이미지의 size에 **(from ServiceWorker)**가 보인다.</p>
<h1>Intermediate</h1>
<p>내용이 업데이트 되야하는 페이지나 리소스에 대해서는 동적으로 캐싱 처리를 해야한다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="dynamic-caching">Dynamic caching<a class="hash-link" aria-label="Dynamic caching에 대한 직접 링크" title="Dynamic caching에 대한 직접 링크" href="/page/20/#dynamic-caching">​</a></h2>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">sw.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">DYNAMIC_CACHE_NAME</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;다이나믹-캐시-스토리지1&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// fetch event는 어딘가에서 리소스를 가져올 때 모두 실행된다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// js를 가져오거나 이미지를 가져오거나 페이지를 가져오거나 등등</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">addEventListener</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;fetch&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">respondWith</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    caches</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">match</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐시에 있으면 repsonse를 그대로 돌려준다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// 여기서 request를 복사해준다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// request는 스트림으로 fetch 당 한 번만 사용해야하기 때문이다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// 근데 event.request로 받아도 실행은 된다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> fetchRequest </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">clone</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// if (response) return response 구문을 하나로 합칠 수도 있다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// return response || fetch(fetchRequest)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">fetch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">fetchRequest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// 응답이 제대로 왔는지 체크한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// 구글 문서 에는 다음과 같이 처리하라고 되어있는데</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// 이 경우 Cross Site Request에 대해 캐싱 처리를 할 수가 없다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// if(!response || response.status !== 200 || response.type !== &#x27;basic&#x27;) {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// 응답은 꼭 복사 해줘야한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> responseToCache </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">clone</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐시 스토리지를 열고 정말 캐싱을 해준다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        caches</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">open</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">DYNAMIC_CACHE_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">put</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> responseToCache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// 여기서 response를 내보내줘야 캐싱 처리 후에 리소스를 반환한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="오래된-캐시-삭제">오래된 캐시 삭제<a class="hash-link" aria-label="오래된 캐시 삭제에 대한 직접 링크" title="오래된 캐시 삭제에 대한 직접 링크" href="/page/20/#오래된-캐시-삭제">​</a></h2>
<p>캐시 스토리지명을 바꿔 캐시의 버전을 올리면 기존 캐시 스토리지는 삭제해줘야한다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">sw.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// 서비스 워커가 활성화 될 때</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">addEventListener</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;activate&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// 영구적으로 가져갈 캐시 스트리지 화이트리스트</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> cacheWhiteList </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token constant" style="color:rgb(100, 102, 149)">PRE_CACHE_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">DYNAMIC_CACHE_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">waitUntil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐시 스토리지의 모든 스토리지명을 가져온다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    caches</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">keys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">cacheNames</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐시를 삭제하는 건 Promise를 반환하므로 Promise.all을 사용해 끝날 시점을 잡아야한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(78, 201, 176)">Promise</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">all</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// 이 결과는 [Promise, Promise...] 형태가 되시겠다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        cacheNames</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">map</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">cacheName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// 각각의 캐시 스토리지명이 화이트 리스트와 같지 않을 경우</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">cacheWhitelist</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">indexOf</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">cacheName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">===</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐시를 삭제하는 Promise를 배열에 추가한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> caches</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">delete</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">cacheName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// activate 시에는 clients claim 메소드를 호출해서</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// 브라우저에 대한 제어권을 가져와야한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">clients</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">claim</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>결과적으로 <code>DYNAMIC_CACHE_NAME</code>이 아닌 캐시 스토리지는 삭제된다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="offline-fallback">offline fallback<a class="hash-link" aria-label="offline fallback에 대한 직접 링크" title="offline fallback에 대한 직접 링크" href="/page/20/#offline-fallback">​</a></h2>
<p>캐시된 페이지와 리소스는 오프라인에서도 접근이 가능하다.
여기서 오류가 발생하면 offline.html 같은 페이지로 떨어지게 할 수 있다. (마치 404 오류 페이지처럼)</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">sw.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">addEventListener</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;fetch&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">respondWith</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    caches</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">match</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">catch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// 에 러 발생시 캐시되어있는 offline.html로 이동시킨다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> caches</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">open</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">CACHE_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// 들어온 요청의 Accept 헤더가 text/html 을 포함하고 있다면 (페이지 요청이라면)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">headers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;accept&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">includes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;text/html&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐시된 offline fallback 페이지를 보여준다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">match</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/offline.html&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Advanced</h1>
<p>서비스워커에 static, dynamic cache를 첨가했는데 소스가 너무 지저분하다.
직관적으로 만들어보자.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="리팩토링">리팩토링<a class="hash-link" aria-label="리팩토링에 대한 직접 링크" title="리팩토링에 대한 직접 링크" href="/page/20/#리팩토링">​</a></h2>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">sw.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">STATIC_CACHE_NAME</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;STATIC_CACHE_VERSION_1&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">DYNAMIC_CACHE_NAME</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;DYNAMIC_CACHE_VERSION_1&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">WEB_CACHE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">addEventListener</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;install&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">staticCacheStrategy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">bind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">addEventListener</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;activate&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">deleteOldCache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">bind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">addEventListener</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;fetch&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">dynamicCacheStrategy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">bind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">staticCacheStrategy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// 스태틱 캐싱</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">deleteOldCache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐시 삭제</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">dynamicCacheStrategy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// 다이나믹 캐싱</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token constant" style="color:rgb(100, 102, 149)">WEB_CACHE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>IIFE를 사용해 좀 더 예쁘게 변했다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="cross-domain-request">cross domain request<a class="hash-link" aria-label="cross domain request에 대한 직접 링크" title="cross domain request에 대한 직접 링크" href="/page/20/#cross-domain-request">​</a></h2>
<p>서비스워커에서 fetch로 외부 리소스를 가지고오면 <code>opaque</code> response가 반환된다.
cors 정책이 설정되어 있지 않아 아무 정보도 가지고 올 수 없는 건데, 이런 리소스만 골라서 캐싱처리를 하고 싶다면 request url이나 response content-type을 가지고 처리할 수 있다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">sw.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(220, 220, 170)">dynamicCacheStrategy</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐싱 처리하고 싶은 content-type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> cacheContentsTypes </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;image/png&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;image/gif&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;image/jpeg&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;application/font-woff&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">respondWith</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    caches</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">match</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> fetchRequest </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">clone</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        response </span><span class="token operator" style="color:rgb(212, 212, 212)">||</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">fetch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">fetchRequest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)">// response header에서 content-type을 가져와 비교한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)">// 아니면 request.url이 캐싱처리를 할 외부 url인지 확인한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              cacheContentsTypes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">indexOf</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">headers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;content-type&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">||</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">url</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">indexOf</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;external.url&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              caches</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">open</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">DYNAMIC_CACHE_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">put</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">clone</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">catch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token console class-name" style="color:rgb(78, 201, 176)">console</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">log</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>WorkBox</h1>
<p>이제 클라이언트 캐시가 어떻게 돌아가는지 확인했으니 구글에서 만든 <a href="https://developers.google.com/web/tools/workbox/" target="_blank" rel="noopener noreferrer">멋진 라이브러리</a>를 사용해보자.</p>
<p>간결하고 직관적인 문법으로 위의 구문들을 예쁘게 만들 수 있다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="stratergy">Stratergy<a class="hash-link" aria-label="Stratergy에 대한 직접 링크" title="Stratergy에 대한 직접 링크" href="/page/20/#stratergy">​</a></h2>
<p>그 전에 캐싱 전략을 알아야한다.</p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="cachefirst">cacheFirst<a class="hash-link" aria-label="cacheFirst에 대한 직접 링크" title="cacheFirst에 대한 직접 링크" href="/page/20/#cachefirst">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/images/ss-falling-back-to-network.png" alt="image from hexo" class="img_Y9wi"></p>
<p>캐시부터 요청하고 네트워크를 접근해 리소스를 보여준다.</p>
<blockquote>
<p>오프라인을 우선적으로 보여주는 페이지에 적합하다.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="cacheonly">cacheOnly<a class="hash-link" aria-label="cacheOnly에 대한 직접 링크" title="cacheOnly에 대한 직접 링크" href="/page/20/#cacheonly">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/images/ss-cache-only.png" alt="image from hexo" class="img_Y9wi"></p>
<p>캐시에서만 가져온다.</p>
<blockquote>
<p>static file들이 여기에 해당된다.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="networkfirst">networkFirst<a class="hash-link" aria-label="networkFirst에 대한 직접 링크" title="networkFirst에 대한 직접 링크" href="/page/20/#networkfirst">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/images/ss-network-falling-back-to-cache.png" alt="image from hexo" class="img_Y9wi"></p>
<p>네트워크를 먼저 접근하고 오프라인일 경우 캐시를 가져온다.
이 방법은 연결이 원활하지 않거나 느린 경우 네트워크가 실패할 때까지 기다린 뒤 리소스가 보여지므로 UX에 좋지 않을 수 있다.</p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="networkonly">networkOnly<a class="hash-link" aria-label="networkOnly에 대한 직접 링크" title="networkOnly에 대한 직접 링크" href="/page/20/#networkonly">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/images/ss-network-only.png" alt="image from hexo" class="img_Y9wi"></p>
<p>캐시가 필요없는 GET 메소드가 아닌 다른 메소드가 주로 여기에 해당된다.</p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="stalewhilerevalidate">staleWhileRevalidate<a class="hash-link" aria-label="staleWhileRevalidate에 대한 직접 링크" title="staleWhileRevalidate에 대한 직접 링크" href="/page/20/#stalewhilerevalidate">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/images/cm-stale-while-revalidate.png" alt="image from hexo" class="img_Y9wi"></p>
<p>이 방식은 그림을 보고 이해하는게 빠르다.
캐시를 먼저 가져오고 다음 요청은 네트워크에서 요청된 리소스의 캐시를 반환한다.</p>
<blockquote>
<p>주로 이 방식이 사용된다.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="cache-then-network">Cache then network<a class="hash-link" aria-label="Cache then network에 대한 직접 링크" title="Cache then network에 대한 직접 링크" href="/page/20/#cache-then-network">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/images/ss-cache-then-network.png" alt="image from hexo" class="img_Y9wi"></p>
<p>페이지가 두 개의 요청(캐시에 요청, 네트워크에 요청)을 동시에 하고 캐시된 데이터를 먼저 표시한 다음 네트워크 데이터가 도착하면 페이지를 업데이트를 한다.
WorkBox에는 없는 strategy인데 networkFirst보다 UX상 좋다고 한다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="설치">설치<a class="hash-link" aria-label="설치에 대한 직접 링크" title="설치에 대한 직접 링크" href="/page/20/#설치">​</a></h2>
<p>ServiceWorker에서는 라우팅 기능을 사용하기 위해 구글 CDN에서 제공하는 스크립트를 사용하고
Pre-Cache를 정의하기 위해 로컬에서 <code>workbox-cli</code>를 추가해야한다.</p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="importscript">importScript<a class="hash-link" aria-label="importScript에 대한 직접 링크" title="importScript에 대한 직접 링크" href="/page/20/#importscript">​</a></h3>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WorkerGlobalScope/importScripts" target="_blank" rel="noopener noreferrer">importScript</a>는 ServiceWorker 파일에서만 사용가능한 구문으로 <code>import</code>나 <code>require</code>와 같다고 보면 된다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">importScripts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;https://storage.googleapis.com/workbox-cdn/releases/3.2.0/workbox-sw.js&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="workbox-cli">workbox-cli<a class="hash-link" aria-label="workbox-cli에 대한 직접 링크" title="workbox-cli에 대한 직접 링크" href="/page/20/#workbox-cli">​</a></h3>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ yarn global add workbox-cli</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="메소드">메소드<a class="hash-link" aria-label="메소드에 대한 직접 링크" title="메소드에 대한 직접 링크" href="/page/20/#메소드">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="precache">precache<a class="hash-link" aria-label="precache에 대한 직접 링크" title="precache에 대한 직접 링크" href="/page/20/#precache">​</a></h3>
<p>프리캐시는 정적 자원들을 미리 캐싱처리해서 <strong>Cache Only Stratergy</strong>를 사용하는 것이다.
주로 이미지나 css, vendor-js 등을 여기에 담아준다.</p>
<p>workbox-cli를 설치하고 wizard 명령어를 실행하면 <a href="https://developers.google.com/web/tools/workbox/modules/workbox-cli#configuration" target="_blank" rel="noopener noreferrer">config 파일</a>이 생성된다.</p>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ workbox wizard</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>설정을 입맛에 맞게 변경해주고 pre-cache할 파일 목록을 생성해주는 명령어를 실행하자</p>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ workbox injectManifest config.js</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ServiceWorker에 <code>workbox.precaching.precacheAndRoute([])</code> 구문이 있다면 목록이 들어가 있는 걸 확인할 수 있다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">precaching</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">precacheAndRoute</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token literal-property property">url</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;css/fonts/fontawesome/fontawesome-webfont.eot&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token literal-property property">revision</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;674f50d287a8c48dc19ba404d20fe713&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="routing">Routing<a class="hash-link" aria-label="Routing에 대한 직접 링크" title="Routing에 대한 직접 링크" href="/page/20/#routing">​</a></h3>
<p>WorkBox를 사용하는 이유는 바로 이 라우팅에 있다.
위에서 많은 양의 라우팅 분기 코드로 캐싱을 처리했는데 WorkBox는 다음과 같이 간결해진다.
아래는 이 블로그에 사용하고 있는 코드이다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">importScripts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;https://storage.googleapis.com/workbox-cdn/releases/3.4.1/workbox-sw.js&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// importScripts 후 타이밍 차이로 인해 모듈을 못 불러오는 경우를 방지하기 위해</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// 캐싱 정책 모듈 로드를 기다린다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">loadModule</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;workbox-strategies&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">skipWaiting</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">clientsClaim</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// accept 헤더에 text/html 값이 있으면 (html 페이지 요청일 경우)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// networkFirst 캐싱</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">routing</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">registerRoute</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">routeData</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> routeData</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">event</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">headers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;accept&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">includes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;text/html&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">strategies</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">networkFirst</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// imgur 요청일 경우 cacheFirst 캐싱</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">routing</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">registerRoute</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex char-set class-name" style="color:rgb(78, 201, 176)">.</span><span class="token regex regex-source language-regex quantifier number" style="color:rgb(181, 206, 168)">*</span><span class="token regex regex-source language-regex group punctuation" style="color:rgb(212, 212, 212)">(?:</span><span class="token regex regex-source language-regex">imgur</span><span class="token regex regex-source language-regex group punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token regex regex-source language-regex special-escape escape">\.</span><span class="token regex regex-source language-regex">com</span><span class="token regex regex-source language-regex char-set class-name" style="color:rgb(78, 201, 176)">.</span><span class="token regex regex-source language-regex quantifier number" style="color:rgb(181, 206, 168)">*</span><span class="token regex regex-source language-regex anchor function" style="color:rgb(220, 220, 170)">$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">strategies</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">cacheFirst</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// jsdelivr 요청일 경우 stateWhileRevalidate 캐싱</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">routing</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">registerRoute</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex char-set class-name" style="color:rgb(78, 201, 176)">.</span><span class="token regex regex-source language-regex quantifier number" style="color:rgb(181, 206, 168)">*</span><span class="token regex regex-source language-regex group punctuation" style="color:rgb(212, 212, 212)">(?:</span><span class="token regex regex-source language-regex">jsdelivr</span><span class="token regex regex-source language-regex group punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token regex regex-source language-regex special-escape escape">\.</span><span class="token regex regex-source language-regex">net</span><span class="token regex regex-source language-regex char-set class-name" style="color:rgb(78, 201, 176)">.</span><span class="token regex regex-source language-regex quantifier number" style="color:rgb(181, 206, 168)">*</span><span class="token regex regex-source language-regex anchor function" style="color:rgb(220, 220, 170)">$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">strategies</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">staleWhileRevalidate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// bootcss 요청일 경우 stateWhileRevalidate 캐싱</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">routing</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">registerRoute</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex char-set class-name" style="color:rgb(78, 201, 176)">.</span><span class="token regex regex-source language-regex quantifier number" style="color:rgb(181, 206, 168)">*</span><span class="token regex regex-source language-regex group punctuation" style="color:rgb(212, 212, 212)">(?:</span><span class="token regex regex-source language-regex">bootcss</span><span class="token regex regex-source language-regex group punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token regex regex-source language-regex special-escape escape">\.</span><span class="token regex regex-source language-regex">com</span><span class="token regex regex-source language-regex char-set class-name" style="color:rgb(78, 201, 176)">.</span><span class="token regex regex-source language-regex quantifier number" style="color:rgb(181, 206, 168)">*</span><span class="token regex regex-source language-regex anchor function" style="color:rgb(220, 220, 170)">$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">strategies</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">staleWhileRevalidate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>코드가 너무 예뻐졌다. callback으로 Request의 모든 걸 캐치해 낼 수 있다.
더 구체적으로 쓰고 싶으면 <a href="https://developers.google.com/web/tools/workbox/guides/route-requests" target="_blank" rel="noopener noreferrer">문서</a>를 참조하자</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="부가-기능">부가 기능<a class="hash-link" aria-label="부가 기능에 대한 직접 링크" title="부가 기능에 대한 직접 링크" href="/page/20/#부가-기능">​</a></h2>
<p>이 기능 말고도 다음과 같은 멋진 기능을 사용할 수 있다, 하지만 언제 쯤 써볼 수 있을지..</p>
<ul>
<li><a href="https://developers.google.com/web/tools/workbox/modules/workbox-background-sync" target="_blank" rel="noopener noreferrer">backgroundSync</a> (오프라인이 되면 큐에 데이터를 넣고 연결될 시 서버에 전송)</li>
<li><a href="https://developers.google.com/web/tools/workbox/modules/workbox-broadcast-cache-update" target="_blank" rel="noopener noreferrer">broadcastUpdate</a> (postMessage를 사용하는 그 것 맞다)</li>
<li><a href="https://developers.google.com/web/tools/workbox/modules/workbox-cacheable-response" target="_blank" rel="noopener noreferrer">cacheableResponse</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="offline-ga">offline GA<a class="hash-link" aria-label="offline GA에 대한 직접 링크" title="offline GA에 대한 직접 링크" href="/page/20/#offline-ga">​</a></h3>
<p>오프라인에서도 <a href="https://developers.google.com/web/tools/workbox/modules/workbox-google-analytics" target="_blank" rel="noopener noreferrer">Google Analytics</a> 를 사용할 수 있다.</p>
<p>한 줄의 코드만 삽입해주면 된다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">workbox</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">googleAnalytics</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">initialize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="webpack">Webpack<a class="hash-link" aria-label="Webpack에 대한 직접 링크" title="Webpack에 대한 직접 링크" href="/page/20/#webpack">​</a></h2>
<p>웹팩에 <a href="https://developers.google.com/web/tools/workbox/modules/workbox-webpack-plugin" target="_blank" rel="noopener noreferrer">WorkBox-Webpack-Plugin</a>을 붙힐 수 있는데 아직 도전을 안 해봤다. 후술할 sw-precache를 굳이 뺄 이유가 없고, 레퍼런스  도 워낙 많기에..</p>
<h1>sw-precache</h1>
<p><code>create-react-app</code>이나 <code>Vue-Cli</code>나 <code>@angular/cli</code> 모두 클라이언트 캐싱에 WorkBox 대신 이 라이브러리를 사용하고 있다. (WorkBox에서 캐싱기능만 떼어낸 라이브러리라고 보면 된다)</p>
<p>기본 설정을 굳이 안 건들여도 되고, <code>exact</code>해서 사용 중이라면 옵션을 <a href="https://github.com/GoogleChromeLabs/sw-precache" target="_blank" rel="noopener noreferrer">라이브러리</a>를 한 번 쯤 봐주는 것도 나쁘지 않다.</p>
<h1>참고</h1>
<ul>
<li><a href="https://developers.google.com/web/fundamentals/primers/service-workers/" target="_blank" rel="noopener noreferrer">Google Web Fundementals Guides Base Technology</a></li>
<li><a href="https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/" target="_blank" rel="noopener noreferrer">Google Web Fundamentals Offline cookbook</a></li>
<li><a href="https://developers.google.com/web/tools/workbox/reference-docs/latest/" target="_blank" rel="noopener noreferrer">WorkBox Docs</a></li>
<li><a href="https://github.com/GoogleChrome/workbox" target="_blank" rel="noopener noreferrer">WorkBox</a></li>
<li><a href="https://github.com/GoogleChromeLabs/sw-precache" target="_blank" rel="noopener noreferrer">sw-precache</a></li>
</ul>
<h1>여담</h1>
<ul>
<li>기술 정리하는 건 시간이 너무 오래 걸린다.</li>
<li>Redis, eTag, Vanish, SW 까지 사용하면 성능상에 이점은 있겠지만 키를 어떻게 관리해야될지가 중요할 듯</li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>태그:</b><ul class="tags_cJ0C padding--none margin-left--sm"><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/javascript/">javascript</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/pwa/">pwa</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/serviceworker/">serviceworker</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_cZeS"><a href="/2017/12/21/adonisjs-custom-log-format/">adonisjs 로그 포맷 변경하기 (custom log format)</a></h2><div class="container_lqpW margin-vert--md"><time datetime="2017-12-21T15:25:45.000Z">2017년 12월 21일</time> · <!-- -->약 2분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_AS4B"><div class="avatar margin-bottom--sm"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer"><span>Eunkwang Shin</span></a></div><small class="avatar__subtitle">Owner</small></div></div></div></div></header><div class="markdown"><p>아도니스는 로깅 모듈로 winston 을 사용하는데 winston 은 로그를 json 포맷으로 출력하고 심지어 timezone 변수가 따로 나온다.</p>
<blockquote>
<p>로그는 기본적으로 프로젝트 폴더 하위의 <strong>tmp</strong> 폴더에 생성된다
이 폴더가 없으면 로깅이 되지 않으므로 먼저 만들어주자</p>
</blockquote>
<p>예를 들면 다음과 같다.</p>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">{&quot;level&quot;:&quot;info&quot;,&quot;message&quot;:&quot;serving app on http://127.0.0.1:3333&quot;,&quot;timestamp&quot;:&quot;2017-12-21T05:34:50.235Z&quot;}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{&quot;level&quot;:&quot;info&quot;,&quot;message&quot;:&quot;serving app on http://127.0.0.1:3333&quot;,&quot;timestamp&quot;:&quot;2017-12-21T05:45:32.220Z&quot;}</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>이걸 다음과 같이 바꿔보자</p>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">[2017-12-21 15:01:03.506] INFO serving app on http://127.0.0.1:3333</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>오늘 날짜를 구하기 위해 <code>moment</code>를 먼저 설치하자.
<code>winston</code> 패키지는 <code>@adonisjs/framework</code> 패키지에 종속된다.</p>
</blockquote>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">config/app.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> moment </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">use</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;moment&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> config </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">use</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;winston&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token literal-property property">logger</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token literal-property property">transport</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;file&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token literal-property property">file</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token literal-property property">driver</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;file&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token literal-property property">name</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;adonis-app&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// 파일명을 바꿔준다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token literal-property property">filename</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(206, 145, 120)">`</span><span class="token template-string string" style="color:rgb(206, 145, 120)">adonis_</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(212, 212, 212)">${</span><span class="token template-string interpolation function" style="color:rgb(220, 220, 170)">moment</span><span class="token template-string interpolation punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token template-string interpolation punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token template-string interpolation punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token template-string interpolation method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token template-string interpolation punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token template-string interpolation string" style="color:rgb(206, 145, 120)">&quot;YYYYMMDD&quot;</span><span class="token template-string interpolation punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token template-string string" style="color:rgb(206, 145, 120)">.log</span><span class="token template-string template-punctuation string" style="color:rgb(206, 145, 120)">`</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token literal-property property">level</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;debug&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// json 로그 포맷을 해제하고</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token literal-property property">json</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// 원하는 형태로 바꿔준다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(220, 220, 170)">formatter</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token parameter"> level</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> message</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> meta </span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> now </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">moment</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;YYYY-MM-DD HH:mm:ss.SSS&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// 로그 레벨에 색상을 추가하는 작업인데, 굳이 필요하진 않다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> logLevel </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> config</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">colorize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">level</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> level</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">toUpperCase</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> formattedMeta </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          meta </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(78, 201, 176)">Object</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">keys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">meta</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;\n\t&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(78, 201, 176)">JSON</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">stringify</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">meta</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(206, 145, 120)">`</span><span class="token template-string string" style="color:rgb(206, 145, 120)">[</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(212, 212, 212)">${</span><span class="token template-string interpolation">now</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token template-string string" style="color:rgb(206, 145, 120)">] </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(212, 212, 212)">${</span><span class="token template-string interpolation">logLevel</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token template-string string" style="color:rgb(206, 145, 120)"> </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(212, 212, 212)">${</span><span class="token template-string interpolation">message </span><span class="token template-string interpolation operator" style="color:rgb(212, 212, 212)">||</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token template-string string" style="color:rgb(206, 145, 120)"> </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(212, 212, 212)">${</span><span class="token template-string interpolation">formattedMeta</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token template-string template-punctuation string" style="color:rgb(206, 145, 120)">`</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>버전</h1>
<ul>
<li>@adonis/framework: 4.0.28</li>
<li>winston: 2.4.0</li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>태그:</b><ul class="tags_cJ0C padding--none margin-left--sm"><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/nodejs/">nodejs</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/javascript/">javascript</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_cZeS"><a href="/2017/12/06/Why-redux-saga/">왜 리덕스 사가(Redux-saga) 인가?</a></h2><div class="container_lqpW margin-vert--md"><time datetime="2017-12-06T09:50:37.000Z">2017년 12월 6일</time> · <!-- -->약 13분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_AS4B"><div class="avatar margin-bottom--sm"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer"><span>Eunkwang Shin</span></a></div><small class="avatar__subtitle">Owner</small></div></div></div></div></header><div class="markdown"><p><code>redux</code>, <code>redux-thunk</code>, <code>redux-promise-middleware</code>, <code>redux-actions</code>, <code>redux-saga</code> 머리가 뽀개질 지경이다. 결국엔 <code>redux-saga</code>를 써야만 했고 왜 <strong>saga</strong>로 수렴하게 되는지에 대한 삽질기다.</p>
<blockquote>
<p>도대체 몇 개의 미들웨어 라이브러리를 파야하는지 화남을 포스팅했기에 <em>오 프론트엔드를 꾸미는데는 리액트가 최고야</em> 라고 생각하는 분들에겐 마음이 안들 수도 있다.
정신건강을 위해 <a href="https://github.com/mobxjs/mobx" target="_blank" rel="noopener noreferrer">mobx</a> 사용을 추천드립니다.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="redux">redux<a class="hash-link" aria-label="redux에 대한 직접 링크" title="redux에 대한 직접 링크" href="/page/20/#redux">​</a></h2>
<p>하위, 상위 컴포넌트에 데이터를 props로 넘겨주는게 너무 관리하기 힘들어서 선택한다. 하나의 <strong>Store</strong>(Object)에 SPA의 모든 데이터를 보관한다. 대안으로는 Event Bus Component를 만들면 되는데, 하나의 스토어를 갖는게 그게 그거라 거의 강제된다.
redux를 적용하기에 앞서 기존 MVC 패턴에 쩌든 사상을 Flex(단방향) 패턴으로 바꾼다는게 거의 남북간 화합 수준이였다. 이 부분에 있어선 연습만이 답이다. 눈감고 코딩할 수 있을 만큼 예제 프로젝트를 반복해보자.
일단 몸에 익으면 action creator가 뭔지 왜 dispatch를 해야하고 reducer로 값을 처리해야 하는지가 뇌에서도 이해가 되는 느낌이였다. (counter 예제는 좋지 않다고 본다. shopping cart예제나 todo 예제가 더 이해하기 쉽다.)</p>
<ul>
<li><a href="https://github.com/reactjs/redux" target="_blank" rel="noopener noreferrer">Redux</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="redux-promise-middleware">redux-promise-middleware<a class="hash-link" aria-label="redux-promise-middleware에 대한 직접 링크" title="redux-promise-middleware에 대한 직접 링크" href="/page/20/#redux-promise-middleware">​</a></h2>
<p>redux에서 action의 payload를 비동기 데이터로 넘길 때를 알아서 처리해준다.
많은 포스팅이 있는데, 별 쓸모 없다. 실무에서 예제 포스팅을 따라할만한 간단한 비동기 처리 로직은 없다.</p>
<ul>
<li><a href="https://github.com/pburtchaell/redux-promise-middleware" target="_blank" rel="noopener noreferrer">Redux-promise-middleware</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="redux-thunk">redux-thunk<a class="hash-link" aria-label="redux-thunk에 대한 직접 링크" title="redux-thunk에 대한 직접 링크" href="/page/20/#redux-thunk">​</a></h2>
<p>하나의 action에서 여러 개의 다른 action을 호출하던지, action이 dispatch되는 걸 조작할 수 있어, 비동기 처리에도 사용한다.
멋진 라이브러리이지만 클로저 패턴을 사용해야하므로 소스가 지저분하다.
(이게 깔끔하다고 생각하면 쓰면 된다. promise then promise then chaning도 깔끔하다고 생각하다면)</p>
<ul>
<li><a href="https://github.com/gaearon/redux-thunk" target="_blank" rel="noopener noreferrer">Redux-thunk</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="redux-actions">redux-actions<a class="hash-link" aria-label="redux-actions에 대한 직접 링크" title="redux-actions에 대한 직접 링크" href="/page/20/#redux-actions">​</a></h2>
<p>action, type, reducer의 반복되는 코드를 더 깔끔하게 구현하길 원한다면 이게 답일 수 있다.
하지만 이 미들웨어는 구문적인 편의성을 제공하는 것일 뿐 비동기를 처리할 수 없어서 promise, thunk 또는 여기서 소개할 saga가 강제된다. <a href="https://github.com/reduxactions/redux-actions/issues/184" target="_blank" rel="noopener noreferrer">여기</a>를 참조하자.</p>
<ul>
<li><a href="https://github.com/reduxactions/redux-actions" target="_blank" rel="noopener noreferrer">Redux-actions</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="rematch">rematch<a class="hash-link" aria-label="rematch에 대한 직접 링크" title="rematch에 대한 직접 링크" href="/page/20/#rematch">​</a></h2>
<p>1803 최근엔 이 모든 고민을 해결해주는 <a href="https://github.com/rematch/rematch" target="_blank" rel="noopener noreferrer">rematch</a> 라는 라이브러리가 있다
<code>async/await</code>를 사용해 간결한 문법을 제공하는데 아직 삽질해보지 않아 소개정도만 하고 지나가겠다</p>
<h1>redux-saga</h1>
<p>어떤 action은 promise payload를 뱉고, 어떤 action은 dispatch로 다른 action을 호 출하고 어떤 action은 plain object를 뱉고 이런 일관성없는 짓을 계속하다보면 정말 비효율적이라는 느낌을 받는다. 안 받으셨다면 해보시면 느껴질 것이다.</p>
<p>더 극단적으로 든 생각은 <code>Vuex</code>를 사용하면 그냥 <code>mapGetters</code>, <code>mapActions</code> 두 함수만으로 직관적이고 디자이너도 알아볼 법한 코드로 구현이 가능한데 왜 <code>react</code>를 해야되지? 란 의문이 계속 들었다.</p>
<p><a href="https://github.com/redux-saga/redux-saga" target="_blank" rel="noopener noreferrer">Redux-saga</a>를 접하고는 드디어 state 관리의 친구를 만난 느낌이였다.
그렇다면 saga는 뭘까? 한 줄 표현만 기억해보자.</p>
<blockquote>
<p>saga란 <strong>action에 대한 listener</strong>이다.
음.. <strong>액션 리스너</strong>구나. 이벤트 리스너같은 것이군.</p>
</blockquote>
<p>설치를 하기 전에 <code>redux</code>와 <code>generator</code>의 개념을 완벽히 이해했다고 가정한다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="설치">설치<a class="hash-link" aria-label="설치에 대한 직접 링크" title="설치에 대한 직접 링크" href="/page/20/#설치">​</a></h2>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain"># yarn add redux react-redux</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ yarn add redux-saga</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>create-react-app</code>으로 생성된 프로젝트로 폴더 구조를 다음과 같이 가져갔다.</p>
<div class="language-bash codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-bash codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── public</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└── src</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ├── components</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ├── containers</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    └── store</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      ├── actions</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      ├── reducers</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      ├── sagas</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      └── types</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── package.json</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── App.js</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└── index.js</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="연동">연동<a class="hash-link" aria-label="연동에 대한 직접 링크" title="연동에 대한 직접 링크" href="/page/20/#연동">​</a></h2>
<p>게시글을 가져오는 액션으로 시작해보자.
예시라 모든 코드를 해당 폴더의 index.js에 넣었다. 분리는 편하신대로 하면 되겠다.</p>
<blockquote>
<p><strong>빠르게 훑는 generator</strong></p>
<ul>
<li>iterable (돌리고 돌릴 수 있다)</li>
<li>비동기든 동기든 간에 <code>yield</code> 구문으로 순차적 처리가 가능하다.</li>
</ul>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="type">type<a class="hash-link" aria-label="type에 대한 직접 링크" title="type에 대한 직접 링크" href="/page/20/#type">​</a></h3>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">types/index.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">FETCH_BOARDS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;FETCH_BOARDS&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">FETCH_BOARDS_FULFILLED</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;FETCH_BOARDS_FULFILLED&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">FETCH_BOARDS_REJECTED</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;FETCH_BOARDS_REJECTED&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="action">action<a class="hash-link" aria-label="action에 대한 직접 링크" title="action에 대한 직접 링크" href="/page/20/#action">​</a></h3>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">actions/index.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(220, 220, 170)">fetchBoards</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">FETCH_BOARDS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// saga에서 호출하는 액션</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(220, 220, 170)">fetchBoardsFulfilled</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">boards</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">FETCH_BOARDS_FULFILLED</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token literal-property property">payload</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> boards</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// saga에서 호출하는 액션</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(220, 220, 170)">fetchBoardsRejected</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">FETCH_BOARDS_REJECTED</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>action이 pure object만을 반환하는 것을 보고 있으면 아름답다는 생각이 저절로 든다.</p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="reducer">reducer<a class="hash-link" aria-label="reducer에 대한 직접 링크" title="reducer에 대한 직접 링크" href="/page/20/#reducer">​</a></h3>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">reducers/index.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">INITIAL_STATE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token literal-property property">boards</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">default</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">state </span><span class="token parameter operator" style="color:rgb(212, 212, 212)">=</span><span class="token parameter"> </span><span class="token parameter constant" style="color:rgb(100, 102, 149)">INITIAL_STATE</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token parameter"> type</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> payload</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> error </span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">case</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">FETCH_BOARDS_FULFILLED</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token literal-property property">boards</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> payload</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">case</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">FETCH_BOARDS_REJECTED</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token literal-property property">showError</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword module" style="color:rgb(86, 156, 214)">default</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="saga">saga<a class="hash-link" aria-label="saga에 대한 직접 링크" title="saga에 대한 직접 링크" href="/page/20/#saga">​</a></h3>
<p><code>saga</code>는 action을 listen(watch)한다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">saga/index.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token imports"> call</span><span class="token imports punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token imports"> spawn</span><span class="token imports punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token imports"> put</span><span class="token imports punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token imports"> takeEvery </span><span class="token imports punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;redux-saga/effects&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token imports operator" style="color:rgb(212, 212, 212)">*</span><span class="token imports"> </span><span class="token imports keyword module" style="color:rgb(86, 156, 214)">as</span><span class="token imports"> actions</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;../actions&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token imports">axios</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;axios&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">fetchBoardsSaga</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// try catch finally 구문으로 오류 제어가 가능하다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// 이부분을 call 메소드를 이용해 테스트가 쉽게 바꿀 수 있다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// (yeild를 사용하기 때문에 next 명령어로 반복 가능하므로)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// const { data } = yield call([axios, &#x27;get&#x27;], &#x27;/boards&#x27;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> data </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> axios</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/boards&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">put</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">actions</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">fetchBoardsFulfilled</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">put</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">actions</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">fetchBoardsRejected</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">watchBoard</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// type의 action이 실행되면 fetchBoardsSaga도 항상(Every) 실행한다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">takeEvery</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">FETCH_BOARDS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> fetchBoardsSaga</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// 모든 listener(watcher)를 하나로 묶어준다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// rootReducer에 묶어주는 그것과 같다고 보면 된다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">default</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">root</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">spawn</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">watchBoard</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>왜 watcher들을 <code>spawn</code>으로 묶어야하는지는 <a href="https://github.com/redux-saga/redux-saga/issues/760" target="_blank" rel="noopener noreferrer">이슈</a>에 나와있다.
(여기엔 자동으로 saga가 재시작되는 패턴도 있는데, 아직 활용해본 적은 없다)</p>
<p><strong>action =&gt; saga =&gt; action =&gt; reducer</strong> 로 연결되는 <code>saga</code>가 완성되었다.</p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="store">store<a class="hash-link" aria-label="store에 대한 직접 링크" title="store에 대한 직접 링크" href="/page/20/#store">​</a></h3>
<p>스토어 담는건 각자의 취향이니 어떻게 연결하는지만 보면 된다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">store/index.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> createSagaMiddleware</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">END</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;redux-saga&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> saga </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">createSagaMiddleware</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">default</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">configureStore</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">initialState</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> store </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">createStore</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    rootReducer</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    initialState</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">compose</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token function" style="color:rgb(220, 220, 170)">applyMiddleware</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain">middlewares</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      inDevelopment </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(156, 220, 254)">window</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">devToolsExtension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(156, 220, 254)">window</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">devToolsExtension</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">f</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  store</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">runSaga</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> saga</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">run</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  store</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(220, 220, 170)">close</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">dispatch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">END</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> store</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">index.js</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> store </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">configureStore</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">store</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">runSaga</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">rootSaga</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="메소드">메소드<a class="hash-link" aria-label="메소드에 대한 직접 링크" title="메소드에 대한 직접 링크" href="/page/20/#메소드">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="all">all<a class="hash-link" aria-label="all에 대한 직접 링크" title="all에 대한 직접 링크" href="/page/20/#all">​</a></h3>
<p><code>yield</code> 구문으로 기다리는 건 순차적으로 실행되기 때문에, 동시에 실행되고 전부 <code>resolve</code>되는 패턴이 필요하다면 <code>all</code> 메소드를 사용하면 된다. (Promise.all을 생각하면 쉽다)</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">testSaga</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">//  기존 포스팅들에는 이렇게 사용하라는 구문이 많은데</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// deprecated 경고를 뱉는다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">response1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> response2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token function" style="color:rgb(220, 220, 170)">asyncTask1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">asyncTask2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// 아래와 같이 사용하자</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">response3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> response4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">all</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token function" style="color:rgb(220, 220, 170)">asyncTask1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">asyncTask2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="call">call<a class="hash-link" aria-label="call에 대한 직접 링크" title="call에 대한 직접 링크" href="/page/20/#call">​</a></h3>
<p><code>Function.prototype.call()</code> 함수와 같다.</p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="takeevery">takeEvery<a class="hash-link" aria-label="takeEvery에 대한 직접 링크" title="takeEvery에 대한 직접 링크" href="/page/20/#takeevery">​</a></h3>
<p>모든 액션시마다 실행 된다.
<code>GET</code> 메소드에 사용하자.</p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="takelatest">takeLatest<a class="hash-link" aria-label="takeLatest에 대한 직접 링크" title="takeLatest에 대한 직접 링크" href="/page/20/#takelatest">​</a></h3>
<p>액션 호출시에 같은 액션이 실행 중이면 그 액션은 파기되고 마지막 호출만 실행된다.
<code>POST, PUT, DELETE</code> 같은 리소스 변경 메소드에 사용하자.</p>
<h3 class="anchor anchorWithStickyNavbar_r10D" id="put">put<a class="hash-link" aria-label="put에 대한 직접 링크" title="put에 대한 직접 링  크" href="/page/20/#put">​</a></h3>
<p>액션을 호출한다. <code>dispatch</code>라고 보면 된다.</p>
<h1>다시보기</h1>
<p>비유를 통한 설명이 좋으면 이렇게 이해해도 된다.
회사에서 주로 푸드플라이로 서브웨이를 주문하는데 거기에 빗대어 보았다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="1-board를-가져오는-타입-만들기">1. Board를 가져오는 타입 만들기<a class="hash-link" aria-label="1. Board를 가져오는 타입 만들기에 대한 직접 링크" title="1. Board를 가져오는 타입 만들기에 대한 직접 링크" href="/page/20/#1-board를-가져오는-타입-만들기">​</a></h2>
<ul>
<li>서브웨이를 푸드플라이로 시킨다고 한다면</li>
<li><code>const 푸드플라이_서브웨이 = &#x27;푸드플라이_서브웨이&#x27;</code> 처럼 컴퓨터가 알 수 있게 <code>변수</code>로 행동(액션)의 종류를 설정해주는 것</li>
<li><code>const 푸드플라이_서브웨이_주문성공 = &#x27;푸드플라이_서브웨이_주문성공&#x27;</code> 처럼 주문이 완료됬을 때의 행동명도 만들 수 있다.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="2-fetchboards-액션-만들기">2. fetchBoards 액션 만들기<a class="hash-link" aria-label="2. fetchBoards 액션 만들기에 대한 직접 링크" title="2. fetchBoards 액션 만들기에 대한 직접 링크" href="/page/20/#2-fetchboards-액션-만들기">​</a></h2>
<ul>
<li>푸드플라이에서 주문서를 넣는 행동과 같다.</li>
<li>액션은 타입과 결과(payload)를 return하는 함수이다.</li>
<li>굳이 payload를 안 써도 되는데, 그게 예쁘다.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="3-fetchboards-사가-만들기">3. fetchBoards 사가 만들기<a class="hash-link" aria-label="3. fetchBoards 사가 만들기에 대한 직접 링크" title="3. fetchBoards 사가 만들기에 대한 직접 링크" href="/page/20/#3-fetchboards-사가-만들기">​</a></h2>
<ul>
<li>푸드플라이 서버에서 주문서를 처리하는 것</li>
<li>서버에서 디비 값을 바꾸고 서브웨이로 주문을 밀어넣어주는 것</li>
<li>마지막에 주문이 들어갔다는 다른 액션을 <code>put</code>으로 호출한다.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="4-fetchboards의-액션과-사가를-연결하기">4. fetchBoards의 액션과 사가를 연결하기<a class="hash-link" aria-label="4. fetchBoards의 액션과 사가를 연결하기에 대한 직접 링크" title="4. fetchBoards의 액션과 사가를 연결하기에 대한 직접 링크" href="/page/20/#4-fetchboards의-액션과-사가를-연결하기">​</a></h2>
<ul>
<li>주문서를 넣으면 푸드플라이의 주문서 로직을 실행해야된다는 걸 컴퓨터에게 알려주는 부분</li>
<li><code>takeEvery</code>로 감싸면 매번 주문서가 들어올 때마다 로직이 실행된다는 것</li>
<li><code>takeLatest</code>로 감싸면 매번 주문서가 들어올 때마다 마지막에 들어온 것만 실행하는 것</li>
<li><code>take</code>는 무한루프가 안 예쁘다.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="5-fetchboards-액션이-완료될-경우-발생하는-fetchboardsfulfilled-액션의-리듀서를-만들기">5. fetchBoards 액션이 완료될 경우 발생하는 fetchBoardsFulfilled 액션의 리듀서를 만들기<a class="hash-link" aria-label="5. fetchBoards 액션이 완료될 경우 발생하는 fetchBoardsFulfilled 액션의 리듀서를 만들기에 대한 직접 링크" title="5. fetchBoards 액션이 완료될 경우 발생하는 fetchBoardsFulfilled 액션의 리듀서를 만들기에 대한 직접 링크" href="/page/20/#5-fetchboards-액션이-완료될-경우-발생하는-fetchboardsfulfilled-액션의-리듀서를-만들기">​</a></h2>
<ul>
<li>서브웨이에서 주문서를 받아서 <code>서브웨이 멜트</code> 만드는 준비를 하는 부분</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="6-리듀서에서-초기-상태-값을-업데이트-해주기">6. 리듀서에서 초기 상태 값을 업데이트 해주기<a class="hash-link" aria-label="6. 리듀서에서 초기 상태 값을 업데이트 해주기에 대한 직접 링크" title="6. 리듀서에서 초기 상태 값을 업데이트 해주기에 대한 직접 링크" href="/page/20/#6-리듀서에서-초기-상태-값을-업데이트-해주기">​</a></h2>
<ul>
<li>초기상태값은 <code>서브웨이 멜트</code>에 터키가 최소 2장, 햄 최소 2장 들어간다 같은 것</li>
<li>업데이트는 <code>서브웨이 멜트</code>를 진짜 만드는 행동</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="7-컴포넌트클래스를-리덕스-스토어와-연결">7. 컴포넌트(클래스)를 리덕스 스토어와 연결<a class="hash-link" aria-label="7. 컴포넌트(클래스)를 리덕스 스토어와 연결에 대한 직접 링크" title="7. 컴포넌트(클래스)를 리덕스 스토어와 연결에 대한 직접 링크" href="/page/20/#7-컴포넌트클래스를-리덕스-스토어와-연결">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="8-boards-prop과-fetchboards-action을-가져오기-maptoprops-아실-거에요">8. Boards Prop과 fetchBoards Action을 가져오기 (map...toProps 아실 거에요)<a class="hash-link" aria-label="8. Boards Prop과 fetchBoards Action을 가져오기 (map...toProps 아실 거에요)에 대한 직접 링크" title="8. Boards Prop과 fetchBoards Action을 가져오기 (map...toProps 아실 거에요)에 대한 직접 링크" href="/page/20/#8-boards-prop과-fetchboards-action을-가져오기-maptoprops-아실-거에요">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="9-componentdidmount-onclick에서-fetchboards-실행">9. componentDidMount, onClick에서 fetchBoards 실행<a class="hash-link" aria-label="9. componentDidMount, onClick에서 fetchBoards 실행에 대한 직접 링크" title="9. componentDidMount, onClick에서 fetchBoards 실행에 대한 직접 링크" href="/page/20/#9-componentdidmount-onclick에서-fetchboards-실행">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="10-boardsmap-등-dom에-바인딩">10. Boards.map 등 DOM에 바인딩<a class="hash-link" aria-label="10. Boards.map 등 DOM에 바인딩에 대한 직접 링크" title="10. Boards.map 등 DOM에 바인딩에 대한 직접 링크" href="/page/20/#10-boardsmap-등-dom에-바인딩">​</a></h2>
<h1>여담</h1>
<ul>
<li><a href="https://redux-saga.js.org/" target="_blank" rel="noopener noreferrer">Saga API Docs</a>엔 action을 기다리는 <code>take</code> 기능 등 많은 고급 기능이 있다.</li>
<li><code>supervisor</code> 패턴으로 구성한 사람도 보이는데 아직 필요성을 잘 못 느끼겠다.</li>
<li>처음부터 <code>mobx</code>로 시작했어도 쉬웠을텐데</li>
<li>saga에서 쓰는 개념들은 rx의 스트림과 비슷하게 느껴졌다.</li>
<li>2020년에는 <a href="https://react-redux.js.org/next/api/hooks" target="_blank" rel="noopener noreferrer">Redux hooks</a>를 사용하면 된다.</li>
</ul>
<blockquote>
<p>잘 이해가 안 된다면 <code>mobx</code>를 이해하는 게 정신건강에 좋습니다.</p>
</blockquote></div><footer class="row docusaurus-mt-lg"><div class="col"><b>태그:</b><ul class="tags_cJ0C padding--none margin-left--sm"><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/javascript/">javascript</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/react/">react</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_cZeS"><a href="/2017/11/28/Vue-Laravel-Pagination-연동/">Vue - Laravel Pagination 연동</a></h2><div class="container_lqpW margin-vert--md"><time datetime="2017-11-28T15:36:34.000Z">2017년 11월 28일</time> · <!-- -->약 2분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_AS4B"><div class="avatar margin-bottom--sm"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer"><span>Eunkwang Shin</span></a></div><small class="avatar__subtitle">Owner</small></div></div></div></div></header><div class="markdown"><p>Laravel에서 <code>paginate</code> 메소드를 <code>json</code>으로 받았을 시에 데이터는 다음과 같다.</p>
<div class="language-json codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockTitle_Qia6">response</div><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-json codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  &quot;current_page&quot;: 1,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  &quot;data&quot;: [{}, {}, {}],</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  &quot;from&quot;: 1,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  &quot;last_page&quot;: 1,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  &quot;next_page_url&quot;: null,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  &quot;path&quot;: &quot;https://example.com/ajax/list&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  &quot;per_page&quot;: 15,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  &quot;prev_page_url&quot;: null,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  &quot;to&quot;: 8,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  &quot;total&quot;: 8</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>이 데이터를 <code>blade</code>에서 <code>links</code> 메소드로 쉽게 사용할 수 있는 것 처럼 <code>Vue</code>에서도 그럴 수는 없을까?</p>
<p><a href="https://github.com/gilbitron/laravel-vue-pagination" target="_blank" rel="noopener noreferrer">Laravel Vue Pagination</a> 패키지를 활용하면 된다.
<strong>SPA</strong>일 경우에는 다운 받고 <strong>Usage</strong> 탭에 적힌대로 바로 사용하면 되지만, Multi Page일경우는 직접 컴포넌트를 가져와야한다.</p>
<div class="language-html codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-html codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">ul</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">li</span><span class="token tag" style="color:rgb(78, 201, 176)"> </span><span class="token tag attr-name" style="color:rgb(156, 220, 254)">v-for</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(212, 212, 212)">=</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag attr-value" style="color:rgb(206, 145, 120)">post in response.data</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag" style="color:rgb(78, 201, 176)"> </span><span class="token tag attr-name" style="color:rgb(156, 220, 254)">v-text</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(212, 212, 212)">=</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag attr-value" style="color:rgb(206, 145, 120)">post.title</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">li</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">ul</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">nav</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">pagination</span><span class="token tag" style="color:rgb(78, 201, 176)"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token tag" style="color:rgb(78, 201, 176)">    </span><span class="token tag attr-name" style="color:rgb(156, 220, 254)">:data</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(212, 212, 212)">=</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag attr-value" style="color:rgb(206, 145, 120)">response</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag" style="color:rgb(78, 201, 176)"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token tag" style="color:rgb(78, 201, 176)">    </span><span class="token tag attr-name" style="color:rgb(156, 220, 254)">:limit</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(212, 212, 212)">=</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag attr-value" style="color:rgb(206, 145, 120)">3</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag" style="color:rgb(78, 201, 176)"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token tag" style="color:rgb(78, 201, 176)">    </span><span class="token tag attr-name" style="color:rgb(156, 220, 254)">@pagination-change-page</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(212, 212, 212)">=</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag attr-value" style="color:rgb(206, 145, 120)">fetchPosts</span><span class="token tag attr-value punctuation" style="color:rgb(212, 212, 212)">&quot;</span><span class="token tag" style="color:rgb(78, 201, 176)"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token tag" style="color:rgb(78, 201, 176)">  </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">nav</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">script</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">  </span><span class="token script language-javascript keyword" style="color:rgb(86, 156, 214)">new</span><span class="token script language-javascript"> </span><span class="token script language-javascript class-name" style="color:rgb(78, 201, 176)">Vue</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">    </span><span class="token script language-javascript literal-property property">data</span><span class="token script language-javascript operator" style="color:rgb(212, 212, 212)">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">      </span><span class="token script language-javascript literal-property property">response</span><span class="token script language-javascript operator" style="color:rgb(212, 212, 212)">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">        </span><span class="token script language-javascript literal-property property">data</span><span class="token script language-javascript operator" style="color:rgb(212, 212, 212)">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">      </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">    </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">    </span><span class="token script language-javascript literal-property property">methods</span><span class="token script language-javascript operator" style="color:rgb(212, 212, 212)">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">      </span><span class="token script language-javascript function-variable function" style="color:rgb(220, 220, 170)">fetchPosts</span><span class="token script language-javascript operator" style="color:rgb(212, 212, 212)">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:rgb(86, 156, 214)">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token script language-javascript parameter">page</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">        </span><span class="token script language-javascript keyword" style="color:rgb(86, 156, 214)">var</span><span class="token script language-javascript"> vm </span><span class="token script language-javascript operator" style="color:rgb(212, 212, 212)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:rgb(86, 156, 214)">this</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">        axios</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">          </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(220, 220, 170)">get</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token script language-javascript string" style="color:rgb(206, 145, 120)">&quot;url&quot;</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">            </span><span class="token script language-javascript literal-property property">params</span><span class="token script language-javascript operator" style="color:rgb(212, 212, 212)">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">              </span><span class="token script language-javascript literal-property property">page</span><span class="token script language-javascript operator" style="color:rgb(212, 212, 212)">:</span><span class="token script language-javascript"> page </span><span class="token script language-javascript operator" style="color:rgb(212, 212, 212)">||</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:rgb(181, 206, 168)">1</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">            </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">          </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">          </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(220, 220, 170)">then</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token script language-javascript keyword" style="color:rgb(86, 156, 214)">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token script language-javascript parameter">response</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">            vm</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token script language-javascript property-access">response</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(212, 212, 212)">=</span><span class="token script language-javascript"> response</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">          </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">      </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">    </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript">  </span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token script language-javascript punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">script</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>예외처리</h1>
<p><a href="https://github.com/gilbitron/laravel-vue-pagination/blob/master/src/laravel-vue-pagination.js#L25" target="_blank" rel="noopener noreferrer">Component 소스</a>의 <em>template</em> 부분을 보면 nav로 감싸져있지 않기에 Laravel 기본 템플릿과 일치시키려면 <code>nav</code> 태그로 감싸주면 된다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>태그:</b><ul class="tags_cJ0C padding--none margin-left--sm"><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/javascript/">javascript</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/php/">php</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/vue/">vue</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/laravel/">laravel</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_cZeS"><a href="/2017/11/23/React-Router-Code-Splitting-가장-쉬운-방법/">React-Router Code Splitting - 가장 쉬운 방법</a></h2><div class="container_lqpW margin-vert--md"><time datetime="2017-11-23T10:58:22.000Z">2017년 11월 23일</time> · <!-- -->약 2분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_AS4B"><div class="avatar margin-bottom--sm"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer"><span>Eunkwang Shin</span></a></div><small class="avatar__subtitle">Owner</small></div></div></div></div></header><div class="markdown"><p><code>create-react-app</code>으로 생성한 리액트 앱에 시작시 가져오는 컴포넌트 빼고는 비동기로 불러와야 메인이 가벼워진다.</p>
<p>검색해보면 <code>AsyncComponent</code>를 만들라는 게 보이는데, 더 쉬운 방법이 있다.</p>
<p><a href="https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/guides/code-splitting.md#code-splitting" target="_blank" rel="noopener noreferrer">React-router 의 Code Splitting</a>탭 에서 찾아볼 수 있는데, 아주 간결하게 컴포넌트를 불러 온다.</p>
<div class="language-js codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-js codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token imports punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Component</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;react&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Loadable</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;react-loadable&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Loading</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;./Loading&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token maybe-class-name">LoadableComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Loadable</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(220, 220, 170)">loader</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;./Dashboard&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">/* 컴포넌트 로딩시 보여지는 로딩 컴포넌트 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token literal-property property">loading</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Loading</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">default</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">LoadableDashboard</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token function" style="color:rgb(220, 220, 170)">render</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token maybe-class-name">LoadableComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>너무 너무 쉽다. 진작에 이 정도 레벨의 추상화가 있었어야했다.</p>
<h2 class="anchor anchorWithStickyNavbar_r10D" id="옵션">옵션<a class="hash-link" aria-label="옵션에 대한 직접 링크" title="옵션에 대한 직접 링크" href="/page/20/#옵션">​</a></h2>
<p>자세한 옵션 <code>delay</code>, <code>timeout</code> 등은 <a href="https://github.com/thejameskyle/react-loadable#------------api-docs" target="_blank" rel="noopener noreferrer">여기</a>서 확인할 수 있다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>태그:</b><ul class="tags_cJ0C padding--none margin-left--sm"><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/javascript/">javascript</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/react/">react</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_cZeS"><a href="/2017/11/22/Laravel-5-5-Model-Collection-데이터-처리하기/">Laravel 5.5 - Model Collection 데이터 처리하기</a></h2><div class="container_lqpW margin-vert--md"><time datetime="2017-11-22T16:39:54.000Z">2017 년 11월 22일</time> · <!-- -->약 1분</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_AS4B"><div class="avatar margin-bottom--sm"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/11773683?v=4" alt="Eunkwang Shin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/gracefullight" target="_blank" rel="noopener noreferrer"><span>Eunkwang Shin</span></a></div><small class="avatar__subtitle">Owner</small></div></div></div></div></header><div class="markdown"><p>Model Collection의 데이터를 처리하는 메소드를 사용하고 싶을 때 아래처럼 접근하면 된다.</p>
<blockquote>
<p>회원 모델과 사용가능한 포인트를 산출하는 <code>availablePoint</code> 메소드가 있다고 가정한다.</p>
</blockquote>
<div class="language-php codeBlockContainer_Pkna theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_SU8s"><pre tabindex="0" class="prism-code language-php codeBlock_PoR0 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_D9WO"><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$members = Member::where(&#x27;status&#x27;, 1)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                   -&gt;get()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                   -&gt;map(function($member) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                     // Model에서 정의된 filter 메소드를 적용할 수 있다.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                     return $member-&gt;availablePoint();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                   });</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// pagination 에서 사용하는 방법</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$members = Member::where(&#x27;status&#x27;, 1)-&gt;paginate();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// 쉬운 방법</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$members-&gt;map(function($member) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  return $member-&gt;availablePoint();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">});</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// 긴 방법</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">//$members-&gt;getCollection()-&gt;transform(function($member) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">//  return $member-&gt;availablePoint();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">//});</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// pagination에서 data 필드만 필요하다면</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$members = Member::where(&#x27;status&#x27;, 1)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            -&gt;paginate()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            -&gt;map(function($member) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              return $member-&gt;availablePoint();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            });</span><br></span></code></pre><div class="buttonGroup_HqoB"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_RgaD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_DJKe"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_jhpS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>태그:</b><ul class="tags_cJ0C padding--none margin-left--sm"><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/php/">php</a></li><li class="tag_NfWW"><a class="tag_YPIX tagRegular_Aak4" href="/tags/laravel/">laravel</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="블로그 게시물 목록 탐색"><a class="pagination-nav__link pagination-nav__link--prev" href="/page/19/"><div class="pagination-nav__label">이전 페이지</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/page/21/"><div class="pagination-nav__label">다음 페이지</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support Me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.buymeacoffee.com/LOUB2kN" target="_blank" rel="noopener noreferrer" style="cursor: pointer;">
                <img src="https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png" style="height: auto !important;width: auto !important;">
              </a></li></ul></div><div class="col footer__col"><div class="footer__title">Feeds</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://gracefullight.dev/rss.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">RSS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_DA5m"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gracefullight.dev/atom.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">Atom<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_DA5m"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Eunkwang Shin.</div></div></div></footer></div>
</body>
</html>