"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([["91658"],{35436(e,t,r){r.r(t),r.d(t,{default:()=>j});var n=r(74848),l=r(52566),i=r(3075);function a(e){let t=new Uint8Array(e,0,8),r=[137,80,78,71,13,10,26,10];if(!t.every((e,t)=>e===r[t]))throw Error("Invalid PNG signature");let n=new DataView(e),l=8,i=[];for(;l<n.byteLength;){if(l+8>n.byteLength)throw Error("Incomplete PNG chunk header");let t=n.getUint32(l);l+=4;let r=String.fromCodePoint(n.getUint8(l),n.getUint8(l+1),n.getUint8(l+2),n.getUint8(l+3));if((l+=4)+t+4>n.byteLength)throw Error(`Incomplete PNG chunk: ${r}`);let a=new Uint8Array(e,l,t);l+=t;let o=n.getUint32(l);if(l+=4,i.push({crc:o,data:a,type:r}),"IEND"===r)break}return i}function o(e){let t=8;for(let r of e)t+=12+r.data.length;return t}function s(e,t){let r="zTXt",n=new TextEncoder().encode(e);if(0===n.length||n.length>79)throw Error("PNG keyword must be 1-79 bytes");let a=new Uint8Array([0]),o=new TextEncoder().encode(t),s=(0,i.Kc)(o),c=new Uint8Array(n.length+1+1+s.length);c.set(n,0),c.set([0],n.length),c.set(a,n.length+1),c.set(s,n.length+2);let u=new Uint8Array(4+c.length);return u.set(new TextEncoder().encode(r),0),u.set(c,4),{crc:(0,l.buf)(u)>>>0,data:c,type:r}}function c(e,t,r){let n=new ArrayBuffer(e),l=new Uint8Array(n);l.set(new Uint8Array(t,0,8),0);let i=8;for(let{type:e,data:t,crc:a}of r){let r=new DataView(n,i,12+t.length);r.setUint32(0,t.length),l.set(new TextEncoder().encode(e),i+4),l.set(t,i+8),r.setUint32(8+t.length,a),i+=12+t.length}return n}var u=r(82112),d=r(68645),h=r(47128),m=r(92387),g=r(28097),p=r(55533),x=r(96540),f=r(99412);let y="#F58D16",b=f.YjP().regex(/^#([0-9a-fA-F]{6})$/,"6\uC790\uB9AC HEX \uC0C9\uC0C1\uC774\uC5B4\uC57C \uD569\uB2C8\uB2E4."),w=f.Ikc({authId:f.YjP().regex(/^-?\d+$/,"\uC22B\uC790 \uBB38\uC790\uC5F4\uC774\uC5B4\uC57C \uD569\uB2C8\uB2E4."),author:f.YjP().min(1,"\uC81C\uC791\uC790\uB97C \uC785\uB825\uD558\uC138\uC694.").max(50),colorWeight:f.aig().min(.2).max(2),customName:f.YjP().max(100).optional().or(f.euz("")),isUseColorWeight:f.zMY(),selectedColor:b}),v=f.Nlp(File).refine(e=>"image/png"===e.type,"PNG \uD30C\uC77C\uB9CC \uC5C5\uB85C\uB4DC \uAC00\uB2A5\uD569\uB2C8\uB2E4.");function j(){let e=(0,x.useRef)(null),t=(0,x.useRef)(null),r=(0,x.useRef)(null),[l,i]=(0,x.useState)(null),[b,j]=(0,x.useState)(!1),[R,A]=(0,x.useState)(null),[$,k]=(0,x.useState)(!1),[U,D]=(0,x.useState)({x:0,y:0}),I=(0,x.useRef)(!1),C=(0,x.useRef)({x:0,y:0}),M=(0,x.useRef)({x:0,y:0}),E=(0,x.useRef)(null),[N,F]=(0,x.useState)(""),[L,S]=(0,x.useState)("-1379962171"),[P,B]=(0,x.useState)("Eargasm"),[Y,G]=(0,x.useState)(!1),[T,X]=(0,x.useState)(.2),[z,W]=(0,x.useState)(y),_=(0,x.useId)(),O=(0,d.A)((e,t,r)=>{if(r.size>4)return!1;let{data:n}=t,l=Array.from(r.keys()).map(e=>{let[t,r,n]=e.split(",").map(Number);return{b:n,g:r,r:t}})[0];for(let e=0;e<n.length;e+=4)n[e]=l.r,n[e+1]=l.g,n[e+2]=l.b;return e.putImageData(t,0,0),!0}),H=(0,d.A)(e=>{let t=e.getImageData(0,0,e.canvas.width,e.canvas.height),r=t.data;for(let e=0;e<r.length;e+=4)255===r[e]&&255===r[e+1]&&255===r[e+2]&&(r[e+2]=254);e.putImageData(t,0,0)}),V=(0,d.A)((e,t)=>{let r={b:Number.parseInt(t.slice(5,7),16),g:Number.parseInt(t.slice(3,5),16),r:Number.parseInt(t.slice(1,3),16)},n=e.getImageData(0,0,e.canvas.width,e.canvas.height),l=n.data,i=function(e){let{data:t}=e,r=new Map;for(let e=0;e<t.length;e+=4){let n=`${t[e]},${t[e+1]},${t[e+2]}`;r.set(n,(r.get(n)||0)+1)}return r}(n);if(O(e,n,i))return;let a=Array.from(i.keys()).map(e=>{let[t,r,n]=e.split(",").map(Number);return[t,r,n]}),o=a.slice();if(Y){let e=Math.max(1,Math.round(a.length*T**2+10*T));for(let t=0;t<e;t++)o.push([r.r,r.g,r.b])}let s=(0,p.Y)(o,4,{initialization:"kmeans++",seed:42}),c=s.centroids.map(e=>({b:e[2],g:e[1],r:e[0]})),u=function(e,t,r){let n=new Map;for(let l=0;l<e.length;l++){let i=`${e[l][0]},${e[l][1]},${e[l][2]}`;n.set(i,r[t[l]])}return n}(a,s.clusters,c);for(let e=0;e<l.length;e+=4){let t=`${l[e]},${l[e+1]},${l[e+2]}`,r=u.get(t);r&&(l[e]=r.r,l[e+1]=r.g,l[e+2]=r.b)}e.putImageData(n,0,0)}),q=(0,h.A)(t),K=q?{h:q.height,w:q.width}:null,J=K?.w,Q=K?.h,Z=!!R&&(256!==R.w||96!==R.h),ee=R?.w,et=R?.h;(0,x.useEffect)(()=>{if(!Z||!J||!Q||!ee||!et)return;let e=J/ee,t={x:Math.max(0,(J-256*e)/2),y:Math.max(0,(Q-96*e)/2)};M.current=t,D(t)},[Z,J,Q,ee,et]),(0,x.useEffect)(()=>{M.current=U},[U]);let er=(0,d.A)(()=>{let t=E.current;if(!t)return;let r=e.current;if(!r)return void alert("\uCE94\uBC84\uC2A4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");if(!Z){r.width=256,r.height=96;let e=r.getContext("2d");if(!e)return;e.drawImage(t,0,0,256,96,0,0,256,96),H(e),V(e,z),j(!0);return}if(!K||!R)return;let n=K.w/R.w,l=Math.round(U.x/n),i=Math.round(U.y/n);r.width=256,r.height=96;let a=r.getContext("2d");a&&(a.clearRect(0,0,256,96),a.drawImage(t,l,i,256,96,0,0,256,96),H(a),V(a,z),j(!0))}),en=(0,d.A)(async e=>{let t=e.target.files?.[0];if(!t)return void i(null);try{await v.parseAsync(t);let e=await t.arrayBuffer(),r=new Blob([e],{type:"image/png"}),n=URL.createObjectURL(r),l=new Image;l.src=n,l.onload=()=>{if(l.width<256||l.height<96){alert("\uC774\uBBF8\uC9C0\uC758 \uCD5C\uC18C \uD06C\uAE30\uB294 256x96 \uC785\uB2C8\uB2E4. \uB354 \uD070 \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD558\uC138\uC694."),URL.revokeObjectURL(n),i(null),A(null),E.current=null;return}E.current=l,A({h:l.height,w:l.width}),i(n),j(!1),256===l.width&&96===l.height&&requestAnimationFrame(()=>{er()})},l.onerror=()=>{alert("\uC774\uBBF8\uC9C0 \uB85C\uB4DC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),URL.revokeObjectURL(n),i(null)}}catch(e){alert(e instanceof f.GaX?e.issues[0]?.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958"),i(null)}});(0,x.useEffect)(()=>()=>{l&&URL.revokeObjectURL(l)},[l]);let el=(0,d.A)(()=>{let t=e.current;if(!t)return void alert("\uCE94\uBC84\uC2A4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");try{w.parse({authId:L,author:P,colorWeight:T,customName:N,isUseColorWeight:Y,selectedColor:z})}catch(e){alert(e instanceof f.GaX?e.issues[0]?.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958");return}let r=g.c9.now().toFormat("yyyyMMdd_HHmmss"),n=`chat_${r}_${N||"\uADF8\uB9BC\uB300\uD654"}.png`;t.toBlob(e=>{if(!e)return void alert("\uC774\uBBF8\uC9C0 \uC0DD\uC131\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.");let t=new FileReader;t.onload=()=>{try{var e,r;let l,i,u,d,h,m=(e=t.result,l=a(e),r=c(o(l=l.filter(({type:e})=>"tEXt"!==e)),e,l),i=a(r),u=s("authid",L),d=s("author",P),h=i.findIndex(({type:e})=>"IHDR"===e)+1,i[h]?.type==="PLTE"?i.splice(h+1,0,u,d):i.splice(h,0,u,d),c(o(i),r,i)),g=new Blob([m],{type:"image/png"}),p=URL.createObjectURL(g);!function({href:e,name:t}){let r=document.createElement("a");r.download=t,r.href=e,r.click()}({href:p,name:n}),URL.revokeObjectURL(p)}catch(e){console.error("PNG \uBA54\uD0C0\uB370\uC774\uD130 \uCD94\uAC00 \uC2E4\uD328:",e),alert(`\u{C774}\u{BBF8}\u{C9C0} \u{CC98}\u{B9AC} \u{C911} \u{C624}\u{B958}\u{AC00} \u{BC1C}\u{C0DD}\u{D588}\u{C2B5}\u{B2C8}\u{B2E4}: ${e instanceof Error?e.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958"}`)}},t.onerror=()=>{alert("\uD30C\uC77C \uC77D\uAE30\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")},t.readAsArrayBuffer(e)},"image/png")}),ei=(0,d.A)(e=>{if(e.preventDefault(),!K||!R||!r.current)return;let t=r.current.getBoundingClientRect(),n=e.clientX-t.left,l=e.clientY-t.top;C.current={x:n-M.current.x,y:l-M.current.y},I.current=!0,k(!0)}),ea=(0,d.A)(e=>{if(e.preventDefault(),!K||!R||!r.current)return;let t=r.current.getBoundingClientRect(),n=e.clientX-t.left,l=e.clientY-t.top;C.current={x:n-M.current.x,y:l-M.current.y},I.current=!0,k(!0)});return(0,m.A)("mousemove",e=>{if(!I.current||!K||!R||!r.current)return;let t=r.current.getBoundingClientRect(),n=K.w/R.w,l=e.clientX-t.left-C.current.x,i=e.clientY-t.top-C.current.y,a=Math.min(Math.max(0,l),Math.max(0,K.w-256*n)),o=Math.min(Math.max(0,i),Math.max(0,K.h-96*n));if(a!==M.current.x||o!==M.current.y){let e={x:a,y:o};M.current=e,D(e)}}),(0,m.A)("mouseup",()=>{I.current&&(I.current=!1,k(!1),Z&&E.current&&er())}),(0,m.A)("pointermove",e=>{if(!I.current||!K||!R||!r.current)return;let t=r.current.getBoundingClientRect(),n=K.w/R.w,l=e.clientX-t.left-C.current.x,i=e.clientY-t.top-C.current.y,a=Math.min(Math.max(0,l),Math.max(0,K.w-256*n)),o=Math.min(Math.max(0,i),Math.max(0,K.h-96*n));if(a!==M.current.x||o!==M.current.y){let e={x:a,y:o};M.current=e,D(e)}}),(0,m.A)("pointerup",()=>{I.current&&(I.current=!1,k(!1),Z&&E.current&&er())}),(0,x.useEffect)(()=>{b&&er()},[z]),(0,n.jsx)(u.A,{children:(0,n.jsxs)("div",{style:{alignItems:"center",color:"var(--ifm-color-primary)",display:"flex",flexDirection:"column"},children:[(0,n.jsx)("h1",{style:{color:"var(--ifm-color-primary)",margin:"2rem 0"},children:"\uADF8\uB9BC\uB300\uD654 \uC0DD\uC131\uAE30"}),(0,n.jsxs)("div",{style:{alignItems:"flex-start",display:"flex",flexDirection:"row",gap:"2rem",justifyContent:"center",maxWidth:"1200px",width:"100%"},children:[(0,n.jsx)("div",{style:{background:"var(--ifm-background-color)",borderRadius:"0.5rem",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",minWidth:"320px",padding:"1rem",width:"400px"},children:(0,n.jsxs)("form",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"space-between"},children:[(0,n.jsxs)("div",{style:{display:"flex",flex:1,flexDirection:"column",gap:"0.2rem"},children:[(0,n.jsx)("label",{htmlFor:`${_}-auth-id`,children:"\uACE0\uC720\uC544\uC774\uB514"}),(0,n.jsx)("input",{id:`${_}-auth-id`,onChange:e=>S(e.target.value),placeholder:"AuthID",style:{border:"1px solid var(--ifm-color-primary)",borderRadius:"0.25rem",padding:"0.5rem"},type:"text",value:L})]}),(0,n.jsxs)("div",{style:{display:"flex",flex:1,flexDirection:"column",gap:"0.2rem"},children:[(0,n.jsx)("label",{htmlFor:`${_}-author`,children:"\uC81C\uC791\uC790"}),(0,n.jsx)("input",{id:`${_}-author`,onChange:e=>B(e.target.value),placeholder:"Author",style:{border:"1px solid var(--ifm-color-primary)",borderRadius:"0.25rem",padding:"0.5rem"},type:"text",value:P})]})]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:[(0,n.jsx)("label",{htmlFor:`${_}-custom-name`,children:"\uAD6C\uBD84\uD560 \uD30C\uC77C\uBA85"}),(0,n.jsx)("input",{id:`${_}-custom-name`,onChange:e=>F(e.target.value),placeholder:"Custom File Name",style:{border:"1px solid var(--ifm-color-primary)",borderRadius:"0.25rem",padding:"0.5rem"},type:"text",value:N})]}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{checked:Y,onChange:e=>G(e.target.checked),type:"checkbox"}),"\uC0C9\uC0C1 \uAC00\uC911\uCE58 \uC0AC\uC6A9\uD558\uAE30"]})}),Y&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:[(0,n.jsx)("label",{htmlFor:`${_}-color-weight`,children:"\uAC00\uC911\uCE58 \uC124\uC815 (0.2 ~ 2.0)"}),(0,n.jsx)("input",{id:`${_}-color-weight`,max:"2.0",min:"0.2",onChange:e=>X(Number.parseFloat(e.target.value)),step:"0.01",title:"\uAC00\uC911\uCE58 \uC124\uC815",type:"range",value:T}),(0,n.jsx)("small",{style:{color:"var(--ifm-color-emphasis-600)"},children:"\uAC12\uC774 \uB192\uC744\uC218\uB85D \uC120\uD0DD\uD55C \uC0C9\uC0C1\uC774 \uB354 \uAC15\uD558\uAC8C \uBC18\uC601\uB429\uB2C8\uB2E4."})]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:[(0,n.jsx)("label",{htmlFor:`${_}-selected-color`,children:"\uAC00\uC911\uCE58 \uC0C9\uC0C1 \uC120\uD0DD"}),(0,n.jsx)("input",{id:`${_}-selected-color`,onChange:e=>W(e.target.value),title:"\uAC00\uC911\uCE58 \uC0C9\uC0C1",type:"color",value:z})]})]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:[(0,n.jsx)("label",{htmlFor:`${_}-image-upload`,children:"\uC774\uBBF8\uC9C0 \uCD94\uAC00 *"}),(0,n.jsx)("input",{accept:"image/png",id:`${_}-image-upload`,onChange:en,style:{border:"1px solid var(--ifm-color-primary)",borderRadius:"0.25rem",cursor:"pointer",padding:"0.5rem"},title:"Upload Image",type:"file"}),(0,n.jsxs)("small",{style:{color:"var(--ifm-color-emphasis-600)"},children:["PNG\uB9CC \uAC00\uB2A5. \uCD5C\uC18C ",256,"\xd7",96,"px. \uB2E4\uB978 \uD06C\uAE30\uBA74 \uC601\uC5ED\uC744 \uC120\uD0DD\uD574 \uC798\uB77C\uB0B4\uC138\uC694."]})]}),l&&b&&(0,n.jsx)("button",{onClick:el,style:{backgroundColor:"var(--ifm-color-primary-dark)",borderRadius:"0.25rem",color:"white",cursor:"pointer",padding:"0.5rem"},type:"button",children:"\uC774\uBBF8\uC9C0 \uB2E4\uC6B4\uB85C\uB4DC"})]})}),(0,n.jsxs)("div",{style:{alignItems:"center",display:"flex",flex:1,flexDirection:"column",maxWidth:"700px",minWidth:"320px",textAlign:"center"},children:[(0,n.jsx)("h3",{children:"\uBBF8\uB9AC\uBCF4\uAE30"}),l?(0,n.jsxs)(n.Fragment,{children:[Z?(0,n.jsxs)("div",{ref:r,style:{border:"1px solid var(--ifm-color-emphasis-300)",maxWidth:"min(800px, 100%)",overflow:"hidden",position:"relative"},children:[(0,n.jsx)("img",{alt:"\uC5C5\uB85C\uB4DC \uBBF8\uB9AC\uBCF4\uAE30",ref:t,src:l??void 0,style:{display:"block",height:"auto",width:"100%"}}),K&&R&&(0,n.jsx)("div",{style:{boxSizing:"border-box",height:K.h,left:0,position:"absolute",top:0,width:K.w},children:(0,n.jsx)("button",{onMouseDown:ei,onPointerDown:ea,style:{all:"unset",background:"transparent",border:`2px solid ${y}`,boxShadow:"0 0 0 100vmax rgba(0,0,0,0.35)",cursor:$?"grabbing":"grab",height:`${K.w/R.w*96}px`,left:`${U.x}px`,position:"absolute",top:`${U.y}px`,userSelect:"none",width:`${K.w/R.w*256}px`,zIndex:1},type:"button"})})]}):(0,n.jsx)("div",{style:{marginBottom:"1rem"},children:(0,n.jsxs)("em",{style:{color:"var(--ifm-color-emphasis-700)"},children:["\uC774\uBBF8\uC9C0 \uD06C\uAE30\uAC00 ",256,"\xd7",96,"\uC774\uBBC0\uB85C \uBC14\uB85C \uCC98\uB9AC\uB429\uB2C8\uB2E4."]})}),!Z&&l&&(0,n.jsx)("div",{style:{display:"flex",gap:"0.5rem",marginTop:"1rem"},children:(0,n.jsx)("button",{onClick:er,style:{backgroundColor:"var(--ifm-color-primary)",borderRadius:"0.25rem",color:"white",cursor:"pointer",padding:"0.5rem 0.75rem"},type:"button",children:"\uC774\uBBF8\uC9C0 \uCC98\uB9AC"})}),(0,n.jsx)("div",{style:{marginTop:"1rem"},children:(0,n.jsx)("canvas",{ref:e})})]}):(0,n.jsx)("div",{style:{border:"2px dashed var(--ifm-color-emphasis-300)",borderRadius:"0.5rem",color:"var(--ifm-color-emphasis-600)",marginTop:"1rem",padding:"3rem 2rem"},children:(0,n.jsx)("p",{children:"\uC774\uBBF8\uC9C0\uB97C \uC5C5\uB85C\uB4DC\uD558\uBA74 \uC5EC\uAE30\uC5D0 \uBBF8\uB9AC\uBCF4\uAE30\uAC00 \uD45C\uC2DC\uB429\uB2C8\uB2E4."})})]})]})]})})}}}]);