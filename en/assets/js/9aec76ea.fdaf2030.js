"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([[71050],{40764:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>u});var r=t(11527),s=t(53363);const i={title:"Laravel 5.5\uc5d0 JWT (Json Web Token) Auth \ucd94\uac00\ud558\uae30",authors:"me",tags:["php","laravel","jwt","oauth2"],date:new Date("2017-11-03T07:59:40.000Z")},l="\uc124\uce58",a={permalink:"/en/2017/11/03/Laravel-5-5-JWT-Auth-Guide",source:"@site/blog/2017/11/03/Laravel-5-5-JWT-Auth-Guide.md",title:"Laravel 5.5\uc5d0 JWT (Json Web Token) Auth \ucd94\uac00\ud558\uae30",description:"\uac80\uc0c9\ud574 \ub098\uc628 \ud3ec\uc2a4\ud2b8\ub4e4\uc740 5.4\ubc84\uc804\uc5d0 \ub300\ud574\uc11c\ub9cc \ub098\uc640\uc788\uc5b4\uc11c, 5.5\uc5d0\uc11c\ub294 \uc544\ubb34\uc9dd\uc5d0 \uc4f8\ubaa8\uac00 \uc5c6\uc5c8\ub2e4.",date:"2017-11-03T07:59:40.000Z",tags:[{label:"php",permalink:"/en/tags/php"},{label:"laravel",permalink:"/en/tags/laravel"},{label:"jwt",permalink:"/en/tags/jwt"},{label:"oauth2",permalink:"/en/tags/oauth-2"}],readingTime:2.495,hasTruncateMarker:!1,authors:[{name:"Gracefullight",title:"Owner",url:"https://github.com/gracefullight",imageURL:"https://avatars.githubusercontent.com/u/11773683?v=4",key:"me"}],frontMatter:{title:"Laravel 5.5\uc5d0 JWT (Json Web Token) Auth \ucd94\uac00\ud558\uae30",authors:"me",tags:["php","laravel","jwt","oauth2"],date:"2017-11-03T07:59:40.000Z"},unlisted:!1,prevItem:{title:"Vue multi page app\uc5d0\uc11c \ucf54\ub4dc\uac00 \ubbf8\ub9ac\ubcf4\uc774\ub294 \ud604\uc0c1 \uc81c\uac70",permalink:"/en/2017/11/08/Vue-multi-page-app\uc5d0\uc11c-\ucf54\ub4dc\uac00-\ubbf8\ub9ac\ubcf4\uc774\ub294-\ud604\uc0c1-\uc81c\uac70"},nextItem:{title:"Docker jenkins \uc124\uce58\uc2dc permission \uc624\ub958",permalink:"/en/2017/10/28/Docker-jenkins-\uc124\uce58\uc2dc-permission-\uc624\ub958"}},o={authorsImageUrls:[void 0]},u=[{value:"jwt-auth",id:"jwt-auth",level:2},{value:"service provider \ub4f1\ub85d",id:"service-provider-\ub4f1\ub85d",level:2},{value:"\uc124\uc815\ud30c\uc77c publish",id:"\uc124\uc815\ud30c\uc77c-publish",level:2},{value:"secret key \uc0dd\uc131",id:"secret-key-\uc0dd\uc131",level:2},{value:"API Route \uc124\uc815",id:"api-route-\uc124\uc815",level:2},{value:"Member Model \uc124\uc815",id:"member-model-\uc124\uc815",level:2},{value:"login",id:"login",level:2},{value:"Authorized Routes",id:"authorized-routes",level:2},{value:"Accept Header",id:"accept-header",level:3},{value:"token \ud0dc\uc6b0\uae30",id:"token-\ud0dc\uc6b0\uae30",level:3},{value:"routes",id:"routes",level:3},{value:"logout",id:"logout",level:2},{value:"refresh",id:"refresh",level:2}];function h(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"\uac80\uc0c9\ud574 \ub098\uc628 \ud3ec\uc2a4\ud2b8\ub4e4\uc740 5.4\ubc84\uc804\uc5d0 \ub300\ud574\uc11c\ub9cc \ub098\uc640\uc788\uc5b4\uc11c, 5.5\uc5d0\uc11c\ub294 \uc544\ubb34\uc9dd\uc5d0 \uc4f8\ubaa8\uac00 \uc5c6\uc5c8\ub2e4.\n\ub77c\ub77c\ubca8\uc5d0\uc11c \uc883\uc778\uc99d\uc744 \uc2dc\uc791\ud574\ubcf4\uc790."}),"\n",(0,r.jsx)(n.h2,{id:"jwt-auth",children:"jwt-auth"}),"\n",(0,r.jsx)(n.p,{children:"171103 \uae30\uc900\uc73c\ub85c dev-develop \ubc84\uc804\uc758 \ud328\ud0a4\uc9c0\ub97c \uc124\uce58\ud574\uc57c\ud55c\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ composer require tymon/jwt-auth:1.0.0-rc.1\n"})}),"\n",(0,r.jsx)(n.h2,{id:"service-provider-\ub4f1\ub85d",children:"service provider \ub4f1\ub85d"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="config/app.php"',children:"<?php\n\n'providers' => [\n  ...\n  Tymon\\JWTAuth\\Providers\\LaravelServiceProvider::class,\n],\n\n'alias' => [\n  ...\n  'JWTAuth' => Tymon\\JWTAuth\\Facades\\JWTAuth::class\n],\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\uc124\uc815\ud30c\uc77c-publish",children:"\uc124\uc815\ud30c\uc77c publish"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'$ php artisan vendor:publish --provider="Tymon\\JWTAuth\\Providers\\LaravelServiceProvider" --force\n'})}),"\n",(0,r.jsx)(n.h2,{id:"secret-key-\uc0dd\uc131",children:"secret key \uc0dd\uc131"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ php artisan jwt:secret\n"})}),"\n",(0,r.jsx)(n.h1,{id:"\uc5f0\ub3d9",children:"\uc5f0\ub3d9"}),"\n",(0,r.jsx)(n.h2,{id:"api-route-\uc124\uc815",children:"API Route \uc124\uc815"}),"\n",(0,r.jsx)(n.p,{children:"API \uac00\ub4dc\uc640 \uc720\uc800 \ubaa8\ub378\uc744 \uc124\uc815\ud558\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="config/auth.php"',children:"<?php\nreturn [\n  'defaults' => [\n    'guard' => 'api', // \uae30\ubcf8 \uac00\ub4dc\ub97c api\ub85c \ubcc0\uacbd\n    'passwords' => 'users',\n  ],\n\n  'guards' => [\n    ...\n    'api' => [\n      'driver' => 'jwt', // api \uac00\ub4dc\ub97c jwt \uc778\uc99d\uc744 \uc0ac\uc6a9\n      'provider' => 'users',\n    ],\n  ],\n\n  'providers' => [\n    'users' => [\n      'driver' => 'eloquent',\n      'model' => App\\Models\\Member::class, // \uc720\uc800 \ubaa8\ub378\uc744 \ud574\ub2f9 \ubaa8\ub378\ub85c \ubcc0\uacbd\n    ],\n  ],\n  ...\n];\n"})}),"\n",(0,r.jsx)(n.h2,{id:"member-model-\uc124\uc815",children:"Member Model \uc124\uc815"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="app/Models/Member.php"',children:"<?php\n...\n// jwt\ub97c \ubaa8\ub378\uc5d0\uc11c \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 \ucd94\uac00\ud55c\ub2e4.\nuse Illuminate\\Foundation\\Auth\\User as Authenticatable;\nuse Tymon\\JWTAuth\\Contracts\\JWTSubject;\n...\n\nclass Member extends Authenticatable implements JWTSubject\n{\n  // \uc544\ub798 \ub450 \uba54\uc18c\ub4dc\uac00 \uad6c\ud604\ub418\uc5b4\uc57c \uc2e4\ud589\ub41c\ub2e4.\n  public function getJWTIdentifier() {\n    return $this->getKey();\n  }\n\n  public function getJWTCustomClaims() {\n    return [];\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h1,{id:"\uc0ac\uc6a9\ud558\uae30",children:"\uc0ac\uc6a9\ud558\uae30"}),"\n",(0,r.jsx)(n.h2,{id:"login",children:"login"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="app/Http/MemberController.php"',children:"<?php\npublic function login(Request $request) {\n  $credentials = $this->validate($request, [\n    'id' => 'required|string',\n    'password' => 'required|string'\n  ]);\n\n  if ($token = $this->guard()->attempt($credentials)) {\n    return $this->respondWithToken($token);\n  }\n\n  return response()->json(['message' => 'Unauthorized'], 401);\n}\n\nprotected function respondWithToken($token) {\n  return response()->json([\n    'access_token' => $token,\n    'token_type' => 'bearer',\n    'expires_in' => $this->guard()->factory()->getTTL() * 60\n  ]);\n}\n\npublic function guard() {\n  return Auth::guard();\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"authorized-routes",children:"Authorized Routes"}),"\n",(0,r.jsx)(n.h3,{id:"accept-header",children:"Accept Header"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"application/json"})," \ub85c \uc124\uc815\ud574\uc57c \uc624\ub958\uac00 \uc608\uc058\uac8c \ubc18\ud658\ub41c\ub2e4."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"token-\ud0dc\uc6b0\uae30",children:"token \ud0dc\uc6b0\uae30"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# header \uc774\uc6a9\ud55c \ubc29\ubc95\nAuthorization: Bearer yourtokens...\n\n# Querystring\uc73c\ub85c\ub3c4 \uc778\uc99d \uac00\ub2a5\nhttps://gracefullight.github.io/me?token=yourtokens...\n"})}),"\n",(0,r.jsx)(n.h3,{id:"routes",children:"routes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="routes/api.php"',children:"Route::group(['middleware' => 'auth:api'], function() {\n  Route::get('member/logout', 'MemberController@logout');\n  Route::get('member/me', 'MemberController@me');\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"logout",children:"logout"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="app/Http/MemberController.php"',children:"<?php\npublic function logout(Request $request) {\n  $this->guard()->logout();\n  return response(null, 204);\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"refresh",children:"refresh"}),"\n",(0,r.jsxs)(n.p,{children:["refresh\ub294 auth",":api"," \ubbf8\ub4e4\uc6e8\uc5b4 \uc5c6\uc774 \ucc98\ub9ac\ub418\uc5b4\uc57c\ud55c\ub2e4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="app/Http/MemberController.php"',children:"<?php\npublic function refresh() {\n  return $this->respondWithToken($this->guard()->refresh());\n}\n"})}),"\n",(0,r.jsx)(n.h1,{id:"\uc5ec\ub2f4",children:"\uc5ec\ub2f4"}),"\n",(0,r.jsx)(n.p,{children:"Expired\uac70\ub098 Unauthoriezed\uacbd\uc6b0 status code\ub85c \uccb4\ud06c\ud558\uba74 \ub41c\ub2e4.\n5.5\ubc84\uc804 \uba54\ub274\uc5bc\uc774 \ubd80\uc871\ud558\ub2e4."})]})}function p(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},53363:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>l});var r=t(50959);const s={},i=r.createContext(s);function l(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);