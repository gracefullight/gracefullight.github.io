"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([[44747],{49613:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var a=n(59496);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=a.createContext({}),u=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(o.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},b=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),b=r,f=p["".concat(o,".").concat(b)]||p[b]||m[b]||l;return n?a.createElement(f,i(i({ref:t},c),{},{components:n})):a.createElement(f,i({ref:t},c))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=b;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var u=2;u<l;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},8241:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>u});var a=n(31966),r=(n(59496),n(49613));const l={title:"SSHD \ubcf4\uc548 - fail2ban, port \ubcc0\uacbd",authors:"me",tags:["fail2ban","linux"],date:new Date("2017-09-22T07:50:15.000Z")},i="\uc2e4\ud328\ud55c \ub85c\uadf8\uc778 IP \ud655\uc778",s={permalink:"/en/2017/09/22/SSHD-\ubcf4\uc548-fail2ban-port-\ubcc0\uacbd",source:"@site/blog/2017/09/22/SSHD-\ubcf4\uc548-fail2ban-port-\ubcc0\uacbd.md",title:"SSHD \ubcf4\uc548 - fail2ban, port \ubcc0\uacbd",description:"\uae30\ubcf8 \ud3ec\ud2b8\ub97c \uc0ac\uc6a9 \uc911\uc774\ub77c\uba74 \uc5b4\ub9c8\uc5b4\ub9c8\ud55c IP \ubaa9\ub85d\uc774 \ub098\uc62c \uac83\uc774\ub2e4.",date:"2017-09-22T07:50:15.000Z",formattedDate:"September 22, 2017",tags:[{label:"fail2ban",permalink:"/en/tags/fail-2-ban"},{label:"linux",permalink:"/en/tags/linux"}],readingTime:1.425,hasTruncateMarker:!1,authors:[{name:"Gracefullight",title:"Owner",url:"https://github.com/gracefullight",imageURL:"https://avatars.githubusercontent.com/u/11773683?v=4",key:"me"}],frontMatter:{title:"SSHD \ubcf4\uc548 - fail2ban, port \ubcc0\uacbd",authors:"me",tags:["fail2ban","linux"],date:"2017-09-22T07:50:15.000Z"},prevItem:{title:"Alpine Linux AWS Cli \uc124\uce58",permalink:"/en/2017/09/22/Alpine-Linux-AWS-Cli-\uc124\uce58"},nextItem:{title:"\ucef4\ud4e8\ud130\uc2dc\uc2a4\ud15c\uad6c\uc870",permalink:"/en/2017/09/19/\ucef4\ud4e8\ud130\uc2dc\uc2a4\ud15c\uad6c\uc870"}},o={authorsImageUrls:[void 0]},u=[{value:"SSH \uc124\uc815 \ubcc0\uacbd",id:"ssh-\uc124\uc815-\ubcc0\uacbd",level:2},{value:"SElinux \ud3ec\ud2b8 \ucd94\uac00",id:"selinux-\ud3ec\ud2b8-\ucd94\uac00",level:2},{value:"\ubc29\ud654\ubcbd \ud3ec\ud2b8 \ucd94\uac00",id:"\ubc29\ud654\ubcbd-\ud3ec\ud2b8-\ucd94\uac00",level:2},{value:"SSH \uc7ac\uc2dc\uc791",id:"ssh-\uc7ac\uc2dc\uc791",level:2},{value:"\uc124\uce58",id:"\uc124\uce58",level:2},{value:"SSH \uc124\uc815 \ucd94\uac00",id:"ssh-\uc124\uc815-\ucd94\uac00",level:2},{value:"\uc11c\ube44\uc2a4 \uc2dc\uc791",id:"\uc11c\ube44\uc2a4-\uc2dc\uc791",level:2}],c={toc:u},p="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ cat /var/log/secure | grep 'sshd.*Failed' | grep -Po \"[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+\" | sort | uniq -c\n\n# \uc2e4\ud328 \uce74\uc6b4\ud2b8\uc640 IP\n6 100.34.214.24\n6 101.109.152.219\n6 101.164.141.36\n")),(0,r.kt)("p",null,"\uae30\ubcf8 \ud3ec\ud2b8\ub97c \uc0ac\uc6a9 \uc911\uc774\ub77c\uba74 \uc5b4\ub9c8\uc5b4\ub9c8\ud55c IP \ubaa9\ub85d\uc774 \ub098\uc62c \uac83\uc774\ub2e4."),(0,r.kt)("h1",{id:"ssh-\ud3ec\ud2b8-\ubcc0\uacbd"},"SSH \ud3ec\ud2b8 \ubcc0\uacbd"),(0,r.kt)("h2",{id:"ssh-\uc124\uc815-\ubcc0\uacbd"},"SSH \uc124\uc815 \ubcc0\uacbd"),(0,r.kt)("p",null,"/etc/ssh/sshd_config \uc5d0 \ud3ec\ud2b8 \uc124\uc815\uc744 \ubcc0\uacbd\ud55c\ub2e4."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="/etc/ssh/sshd_config"',title:'"/etc/ssh/sshd_config"'},"Port 2020\n")),(0,r.kt)("h2",{id:"selinux-\ud3ec\ud2b8-\ucd94\uac00"},"SElinux \ud3ec\ud2b8 \ucd94\uac00"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ semanage port -a -t ssh_port_t -p tcp 2020\n")),(0,r.kt)("h2",{id:"\ubc29\ud654\ubcbd-\ud3ec\ud2b8-\ucd94\uac00"},"\ubc29\ud654\ubcbd \ud3ec\ud2b8 \ucd94\uac00"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ firewall-cmd --permanent --zone=public --add-port=2020/tcp\n$ firewall-cmd --reload\n")),(0,r.kt)("h2",{id:"ssh-\uc7ac\uc2dc\uc791"},"SSH \uc7ac\uc2dc\uc791"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ systemctl restart sshd\n")),(0,r.kt)("h1",{id:"fail2ban"},"Fail2ban"),(0,r.kt)("p",null,"\uc77c\uc815 \uc2dc\ub3c4 \uc774\uc0c1\uc744 \uc2e4\ud328\ud558\uba74 \ud574\ub2f9 IP \ub97c \ucc28\ub2e8\uc2dc\ud0a4\ub294 Fail2ban \uc744 \uc124\uce58\ud558\uc790"),(0,r.kt)("h2",{id:"\uc124\uce58"},"\uc124\uce58"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# repo\uac00 \uc5c6\ub2e4\uba74\n# $ yum install -y epel-release\n\n$ yum install -y fail2ban\n")),(0,r.kt)("h2",{id:"ssh-\uc124\uc815-\ucd94\uac00"},"SSH \uc124\uc815 \ucd94\uac00"),(0,r.kt)("p",null,"/etc/fail2ban/jail.local \ub610\ub294 jail.conf \ub97c \uc5f4\uc5b4 ","[sshd]"," \uc758 enabled \uc18d\uc131\uc744 true \ub85c \ubcc0\uacbd\ud55c\ub2e4."),(0,r.kt)("h2",{id:"\uc11c\ube44\uc2a4-\uc2dc\uc791"},"\uc11c\ube44\uc2a4 \uc2dc\uc791"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ systemctl enable fail2ban\n$ systemctl start fail2ban\n")),(0,r.kt)("h1",{id:"\ub354-\uc26c\uc6b4-\ubc29\ubc95"},"\ub354 \uc26c\uc6b4 \ubc29\ubc95"),(0,r.kt)("p",null,"\uc258\uc2a4\ud06c\ub9bd\ud2b8\ub85c \ud3ec\ud2b8\ubcc0\uacbd, \ubc29\ud654\ubcbd \ub8f0 \ucd94\uac00, Fail2ban \uae4c\uc9c0 \ud55c \ubc29\uc5d0 \ub05d\ub0b4\ubc84\ub9ac\uc790."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ wget https://raw.githubusercontent.com/FunctionClub/Fail2ban/master/fail2ban.sh && bash fail2ban.sh 2>&1 | tee fail2ban.log\n")),(0,r.kt)("p",null,"\uba85\ub839\ubb38\uc5d0 \ub530\ub77c \uc785\ub825\ub9cc \ud574\uc8fc\uba74 \ub41c\ub2e4. \uc790\uc138\ud55c \uc124\uba85\uc740 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/FunctionClub/Fail2ban"},"FunctionClub/Fail2ban")," \ucc38\uace0\ud558\uc790."))}m.isMDXComponent=!0}}]);