"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([[11718],{49613:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>h});var r=a(59496);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),m=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},u=function(e){var t=m(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=m(a),d=n,h=c["".concat(s,".").concat(d)]||c[d]||p[d]||i;return a?r.createElement(h,o(o({ref:t},u),{},{components:a})):r.createElement(h,o({ref:t},u))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:n,o[1]=l;for(var m=2;m<i;m++)o[m]=a[m];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}d.displayName="MDXCreateElement"},10067:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>m});var r=a(31966),n=(a(59496),a(49613));const i={title:"Atom-based state management and Valtio",date:new Date("2023-06-25T07:45:45.480Z"),description:"Shifting from Redux and Recoil to embracing Valtio for efficient state management.",authors:"me",tags:["react","javascript"]},o=void 0,l={permalink:"/en/2023/06/25/atomic-state-management-with-valtio",source:"@site/i18n/en/docusaurus-plugin-content-blog/2023/06/25/atomic-state-management-with-valtio.mdx",title:"Atom-based state management and Valtio",description:"Shifting from Redux and Recoil to embracing Valtio for efficient state management.",date:"2023-06-25T07:45:45.480Z",formattedDate:"June 25, 2023",tags:[{label:"react",permalink:"/en/tags/react"},{label:"javascript",permalink:"/en/tags/javascript"}],readingTime:2.045,hasTruncateMarker:!1,authors:[{name:"Gracefullight",title:"Owner",url:"https://github.com/gracefullight",imageURL:"https://avatars.githubusercontent.com/u/11773683?v=4",key:"me"}],frontMatter:{title:"Atom-based state management and Valtio",date:"2023-06-25T07:45:45.480Z",description:"Shifting from Redux and Recoil to embracing Valtio for efficient state management.",authors:"me",tags:["react","javascript"]},prevItem:{title:"Prisma troubleshooting",permalink:"/en/2023/07/09/prisma-troubleshooting"},nextItem:{title:"A 10-year programmer's tech retrospective",permalink:"/en/2023/06/17/tech-retrospective"}},s={authorsImageUrls:[void 0]},m=[{value:"Overview",id:"overview",level:2},{value:"atom",id:"atom",level:2},{value:"valtio",id:"valtio",level:2}],u={toc:m},c="wrapper";function p(e){let{components:t,...a}=e;return(0,n.kt)(c,(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"overview"},"Overview"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"At one point, redux-saga seemed like a cool way to solve redux's tired state management, and then a combination of atomic states seemed like the way to go."),(0,n.kt)("li",{parentName:"ul"},"That's why I've mostly used recoil, but if you're using query or swr, you don't need such a complicated feature to manage local UI state."),(0,n.kt)("li",{parentName:"ul"},"recoil seems to be an almost abandoned project with only bug fixes in the meta. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/facebookexperimental/Recoil/discussions/2171"},"discussion#2171")),(0,n.kt)("li",{parentName:"ul"},"Anyway, local UI state just needs to have a pub/sub pattern."),(0,n.kt)("li",{parentName:"ul"},"The winner of the 2023 state management library seems to be ",(0,n.kt)("strong",{parentName:"li"},"zustand"),".",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"If you're building an event/messaging based system, it makes sense to use that library with the Flux pattern."),(0,n.kt)("li",{parentName:"ul"},"If you're building an editor with action-based behavior for all front-end features, or if you're integrating with a chat system that receives function call requests, that's one thing."))),(0,n.kt)("li",{parentName:"ul"},"But for a typical use case, Flux is overkill, except for cascading forms, badges, modals, etc."),(0,n.kt)("li",{parentName:"ul"},"If I were developing alone, I would want to separate the backend from the frontend, separate the Local, Dev, Stage, and Prod stages, and have a DB, scheduler, queue, API, and SSR stack.")),(0,n.kt)("h2",{id:"atom"},"atom"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Read first; ",(0,n.kt)("a",{parentName:"li",href:"https://medium.com/@yujso66/%EB%B2%88%EC%97%AD-%EB%A6%AC%EC%95%A1%ED%8A%B8-%EC%83%81%ED%83%9C-%EA%B4%80%EB%A6%AC%EC%9D%98-%EC%83%88%EB%A1%9C%EC%9A%B4-%ED%9D%90%EB%A6%84-6e5ed0022e39"},"The new wave of React state management"),"\uc744 \ubcf4\uc790."),(0,n.kt)("li",{parentName:"ul"},"Atomic, pub/sub, and derived are possible."),(0,n.kt)("li",{parentName:"ul"},"Using derived state is also rarely necessary unless you need a new state per ID. For data, query already does the job."),(0,n.kt)("li",{parentName:"ul"},"Atomic design and atomic state management became a necessity."),(0,n.kt)("li",{parentName:"ul"},"With many developers working asynchronously, it was important to keep track of which files were atoms and what they were for."),(0,n.kt)("li",{parentName:"ul"},"We have a ",(0,n.kt)("inlineCode",{parentName:"li"},"*.atom.ts")," file superfix and a ",(0,n.kt)("inlineCode",{parentName:"li"},"*State")," variable name superfix.")),(0,n.kt)("h2",{id:"valtio"},"valtio"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Both ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/pmndrs/jotai/blob/main/src/vanilla/atom.ts#L83"},"jotai/atom")," and ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/facebookexperimental/Recoil/blob/main/packages/recoil/recoil_values/Recoil_atom.js#L185"},"Recoil/atom")," manage atom-based state and propagate state."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/pmndrs/valtio/blob/main/src/vanilla.ts#L156"},"valtio/proxy")," implements the same functionality using Proxy and Reflect."),(0,n.kt)("li",{parentName:"ul"},"Memory management is not the worst, as you can see from the ",(0,n.kt)("a",{parentName:"li",href:"https://krausest.github.io/js-framework-benchmark/2023/table_chrome_114.0.5735.90.html"},"Results for js web frameworks benchmark"),"."),(0,n.kt)("li",{parentName:"ul"},"zustand, jotai, and valtio are all open source, covered by the ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/orgs/pmndrs/repositories?q=&type=all&language=&sort=stargazers"},"pmndrs")," community, with ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/dai-shi"},"the same person")," as a contributor and maintainer."),(0,n.kt)("li",{parentName:"ul"},"It just works, as his comments in ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/pmndrs/valtio/discussions/128"},"valito/discussion#128")," show."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/pmndrs/valtio/issues/141#issuecomment-891214314"},"valito/issues#141")," Having spent a year on Redux and Redux-saga, and two years on Mobx POC and Recoil, this comment really resonated with me."),(0,n.kt)("li",{parentName:"ul"},"For the time being, I'm going to create several projects and try to use this state management library in all of them.")))}p.isMDXComponent=!0}}]);