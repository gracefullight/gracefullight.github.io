"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([[34013],{62935:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var t=i(52676),r=i(8286);const s={title:"Migrate from yarn to pnpm",date:new Date("2023-06-16T23:42:13.449Z"),description:"Exploring the limitations and issues of Yarn Berry while comparing and analyzing the superiority of Pnpm in package management.",authors:"me",tags:["nodejs","javascript"]},a=void 0,o={permalink:"/en/2023/06/17/migrate-yarn-to-pnpm",source:"@site/i18n/en/docusaurus-plugin-content-blog/2023/06/17/migrate-yarn-to-pnpm.mdx",title:"Migrate from yarn to pnpm",description:"Exploring the limitations and issues of Yarn Berry while comparing and analyzing the superiority of Pnpm in package management.",date:"2023-06-16T23:42:13.449Z",tags:[{inline:!0,label:"nodejs",permalink:"/en/tags/nodejs"},{inline:!0,label:"javascript",permalink:"/en/tags/javascript"}],readingTime:1.54,hasTruncateMarker:!1,authors:[{name:"Gracefullight",title:"Owner",url:"https://github.com/gracefullight",imageURL:"https://avatars.githubusercontent.com/u/11773683?v=4",key:"me",page:null}],frontMatter:{title:"Migrate from yarn to pnpm",date:"2023-06-16T23:42:13.449Z",description:"Exploring the limitations and issues of Yarn Berry while comparing and analyzing the superiority of Pnpm in package management.",authors:"me",tags:["nodejs","javascript"]},unlisted:!1,prevItem:{title:"A 10-year programmer's tech retrospective",permalink:"/en/2023/06/17/tech-retrospective"},nextItem:{title:"My Awesome ChatGPT",permalink:"/en/2023/02/26/my-awesome-chatgpt"}},l={authorsImageUrls:[void 0]},c=[{value:"Overview",id:"overview",level:2},{value:"Problems",id:"problems",level:2},{value:"zipfs",id:"zipfs",level:3},{value:"opensource",id:"opensource",level:3},{value:"workspaces",id:"workspaces",level:3},{value:"Benchmarks",id:"benchmarks",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Yarn berry was all the rage."}),"\n",(0,t.jsx)(n.li,{children:"I tried it and found quite a few problems, which is why I ended up choosing pnpm."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"problems",children:"Problems"}),"\n",(0,t.jsx)(n.h3,{id:"zipfs",children:"zipfs"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"It stores all the packages and logs all the diffs. This is a major culprit for repository size. Difficult to manage images under 1GB."}),"\n",(0,t.jsx)(n.li,{children:"If typescript goes up, yarn berry version should go up. I want to use the latest syntax in typescript right away, but I can't keep up."}),"\n",(0,t.jsxs)(n.li,{children:["I need to update the executable with ",(0,t.jsx)(n.code,{children:"yarn dlx @yarnpkg/sdks vscode"})," whenever typescript, eslint, and prettier are released."]}),"\n",(0,t.jsx)(n.li,{children:"In a project with 20+ front-end developers, this is hard to enforce."}),"\n",(0,t.jsx)(n.li,{children:"It is not possible to test this by making small changes to the source inside the package."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"opensource",children:"opensource"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Monolithic tools like turbo, environments with postinstall hooks like prism, or preset configurators like ",(0,t.jsx)(n.code,{children:"create-*"})," reference ",(0,t.jsx)(n.code,{children:"node_modules"})," directly."]}),"\n",(0,t.jsx)(n.li,{children:"Often it won't even run, and you'll have to wait for an open issue in each repo. I'm not writing this to analyze yarn berry's pnp script."}),"\n",(0,t.jsxs)(n.li,{children:["In this case, I'd have to give it a ",(0,t.jsx)(n.code,{children:"nodeLinker"})," and use it the same way I would with yarn 1, with no advantage."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"workspaces",children:"workspaces"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The yarn workspaces feature is cool, and ",(0,t.jsx)(n.a,{href:"https://github.com/yarnpkg/berry",children:"yarnpkg/berry"})," is a perfect example of it."]}),"\n",(0,t.jsx)(n.li,{children:"But it's only cool if you're only developing node.js libraries. Libraries for the frontend need a bundler, and there's no reference for that."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"benchmarks",children:"Benchmarks"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Benchmark scores are managed by Pnpm on a daily basis."}),"\n",(0,t.jsx)(n.li,{children:"Slowness is acceptable with pipeline cache and lock files enabled. It's a one-time slowdown, not a request/response slowdown, so it can be handled by probes anyway."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://d33wubrfki0l68.cloudfront.net/0cb4f1b1466c5e04cdfd5047d6d509a6a3726996/ea3c9/img/benchmarks/alotta-files.svg",alt:"https://pnpm.io/benchmarks"})}),"\n",(0,t.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The plugin features in yarn berry are cool, but they add more stress to dependency management."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8286:(e,n,i)=>{i.d(n,{Z:()=>o,a:()=>a});var t=i(75271);const r={},s=t.createContext(r);function a(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);