"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([["10134"],{3447(e,n,t){t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>h});var s=t(95658),r=t(74848),l=t(28453);let i={title:"\uCFE0\uBC84\uB124\uD2F0\uC2A4 \uB9AC\uB205\uC2A4 \uCEE4\uB110 \uD29C\uB2DD\uD558\uAE30",authors:"me",tags:["k8s","docker","linux"],date:new Date("2020-01-24T23:43:55.000Z")},c,a={authorsImageUrls:[void 0]},h=[{value:"\uBCC0\uACBD\uAC00\uB2A5\uD55C \uCEE4\uB110 \uC124\uC815",id:"\uBCC0\uACBD\uAC00\uB2A5\uD55C-\uCEE4\uB110-\uC124\uC815",level:2},{value:"ARP \uCE90\uC2DC",id:"arp-\uCE90\uC2DC",level:3},{value:"\uC608\uC2DC",id:"\uC608\uC2DC",level:2},{value:"\uC5EC\uB2F4",id:"\uC5EC\uB2F4",level:2},{value:"\uCC38\uC870",id:"\uCC38\uC870",level:2}];function o(e){let n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\uBCC0\uACBD\uAC00\uB2A5\uD55C-\uCEE4\uB110-\uC124\uC815",children:"\uBCC0\uACBD\uAC00\uB2A5\uD55C \uCEE4\uB110 \uC124\uC815"}),"\n",(0,r.jsx)(n.p,{children:"\uB178\uB4DC \uB808\uBCA8\uC758 sysctl\uACFC \uB124\uC784\uC2A4\uD398\uC774\uC2A4 sysctl\uACFC \uAC19\uC740 \uCEE4\uB110 \uD30C\uB77C\uBBF8\uD130\uB97C sysctl \uC778\uD130\uD398\uC774\uC2A4\uB85C \uBCC0\uACBD\uD560 \uC218 \uC788\uB2E4.\n\uBCC0\uACBD \uAC00\uB2A5\uD55C \uD30C\uB77C\uBBF8\uD130\uB294 \uB2E4\uC74C\uACFC \uAC19\uB2E4."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"abi"}),": \uC2E4\uD589 \uB3C4\uBA54\uC778 \uD2B9\uC131"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"fs"}),": \uD2B9\uC815 \uD30C\uC77C \uC2DC\uC2A4\uD15C, \uD30C\uC77C \uD578\uB4E4\uB9C1, inode, dentry, \uCFFC\uD130 \uC870\uC815"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"kernel"}),": \uC804\uC5ED \uCEE4\uB110 \uC124\uC815 \uBCC0\uACBD"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"net"}),": \uB124\uD2B8\uC6CC\uD0B9"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"sunrpc"}),": SUN rpc \uD638\uCD9C"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"vm"}),": \uBA54\uBAA8\uB9AC \uC870\uC815, \uBC84\uD37C \uBC0F \uCE90\uC2DC \uAD00\uB9AC"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"user"}),": \uC0AC\uC6A9\uC790\uBCC4 \uB124\uC784\uC2A4\uD398\uC774\uC2A4 \uC81C\uD55C"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"taint, toleration"})," \uC744 \uAC19\uC774 \uC0AC\uC6A9\uD574 \uC0AC\uC774\uB4DC\uC774\uD399\uC744 \uBC29\uC9C0\uD558\uB77C\uACE0 \uAD8C\uD558\uACE0 \uC788\uB2E4."]}),"\n",(0,r.jsx)(n.h3,{id:"arp-\uCE90\uC2DC",children:"ARP \uCE90\uC2DC"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"neighbor: arp_cache: neighbor table overflow!"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\uCFE0\uBC84\uB124\uD2F0\uC2A4\uAC00 \uB300\uB7C9\uC758 IP\uB97C \uC18C\uBE44\uD558\uBA74\uC11C ARP \uCE90\uC2DC \uACF5\uAC04\uC744 \uBAA8\uB450 \uC0AC\uC6A9\uD560 \uACBD\uC6B0 ARP \uCE90\uC2DC \uAD00\uB828 \uBCC0\uC218 \uC870\uC808\uC774 \uAC00\uB2A5\uD558\uB2E4.\n\uB300\uADDC\uBAA8 HPC \uD074\uB7EC\uC2A4\uD130\uC5D0\uC11C\uB294 \uD754\uD55C \uC77C\uC774\uBA70 \uCFE0\uBC84\uB124\uD2F0\uC2A4\uC758 \uC8FC\uC18C \uC18C\uC9C4\uC744 \uBC29\uC9C0\uD560 \uC218 \uC788\uB2E4.\n\uC774 \uC624\uB958\uB294 ",(0,r.jsx)(n.code,{children:"nodes with 40+ cores"})," && ",(0,r.jsx)(n.code,{children:"more than 16 segments in each node"})," \uC815\uB3C4\uC5D0\uC11C \uBC1C\uC0DD\uD558\uB294 \uB4EF \uD558\uB2E4."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"net.ipv4.neigh.default.gc_thresh1"}),": gc_thresh1 represents the minimum number of entries that may be in the ARP cache. Garbage collection will not be triggered if the number of entries is below this setting."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"net.ipv4.neigh.default.gc_thresh2"}),": gc_thresh2 represents the soft maximum number of entries that may be in the ARP cache. This setting is arguably the most important, as ARP garbage collection will be triggered ~5s after reaching this soft maximum."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"net.ipv4.neigh.default.gc_thresh3"}),": gc_thresh3 represents the hard maximum number of entries in the ARP cache."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"net.ipv4.neigh.default.gc_thresh1 = 80000\nnet.ipv4.neigh.default.gc_thresh2 = 90000\nnet.ipv4.neigh.default.gc_thresh3 = 100000\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\uC608\uC2DC",children:"\uC608\uC2DC"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Pod\nmetadata:\n  name: sysctl-example\nspec:\n  securityContext:\n    sysctls:\n      - name: kernel.shm_rmid_forced\n        value: "0"\n      - name: net.core.somaxconn\n        value: "10000"\n      - name: kernel.msgmax\n        value: "65536"\n      - name: fs.file-max\n        value: "2097152"\n      - name: net.ipv4.ip_local_port_range\n        value: "1024 65536"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\uC5EC\uB2F4",children:"\uC5EC\uB2F4"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uD30C\uBA74 \uD314\uC218\uB85D \uB9AC\uB205\uC2A4\uBD80\uD130 \uB2E4\uC2DC \uC815\uB9AC\uD574\uC57C\uB418\uACA0\uB2E4\uB294 \uB290\uB08C\uC774 \uB4E0\uB2E4."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\uCC38\uC870",children:"\uCC38\uC870"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/administer-cluster/sysctl-cluster/",children:"Using sysctls in a Kubernetes Cluster"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://meetup.toast.com/posts/54",children:"\uB9AC\uB205\uC2A4 \uC11C\uBC84\uC758 TCP \uB124\uD2B8\uC6CC\uD06C \uC131\uB2A5\uC744 \uACB0\uC815\uC9D3\uB294 \uCEE4\uB110 \uD30C\uB77C\uBBF8\uD130 \uC774\uC57C\uAE30 - 2\uD3B8"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://success.docker.com/article/how-to-increase-the-arp-cache-collection-threshold",children:"How to increase the ARP cache garbage collection threshold"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://openai.com/blog/scaling-kubernetes-to-2500-nodes/",children:"Scaling Kubernetes to 2,500 nodes"})}),"\n"]})]})}function d(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},28453(e,n,t){t.d(n,{R:()=>i,x:()=>c});var s=t(96540);let r={},l=s.createContext(r);function i(e){let n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(l.Provider,{value:n},e.children)}},95658(e){e.exports=JSON.parse('{"permalink":"/en/2020/01/24/k8s-linux-kernel-tuning","source":"@site/blog/2020/01/24/k8s-linux-kernel-tuning.md","title":"\uCFE0\uBC84\uB124\uD2F0\uC2A4 \uB9AC\uB205\uC2A4 \uCEE4\uB110 \uD29C\uB2DD\uD558\uAE30","description":"\uBCC0\uACBD\uAC00\uB2A5\uD55C \uCEE4\uB110 \uC124\uC815","date":"2020-01-24T23:43:55.000Z","tags":[{"inline":true,"label":"k8s","permalink":"/en/tags/k-8-s"},{"inline":true,"label":"docker","permalink":"/en/tags/docker"},{"inline":true,"label":"linux","permalink":"/en/tags/linux"}],"readingTime":1.6,"hasTruncateMarker":false,"authors":[{"name":"Gracefullight","title":"Owner","url":"https://github.com/gracefullight","imageURL":"https://avatars.githubusercontent.com/u/11773683?v=4","key":"me","page":null}],"frontMatter":{"title":"\uCFE0\uBC84\uB124\uD2F0\uC2A4 \uB9AC\uB205\uC2A4 \uCEE4\uB110 \uD29C\uB2DD\uD558\uAE30","authors":"me","tags":["k8s","docker","linux"],"date":"2020-01-24T23:43:55.000Z"},"unlisted":false,"prevItem":{"title":"Pythonic - \uD578\uB4E4\uB9C1","permalink":"/en/2020/01/27/Pythonic-handling"},"nextItem":{"title":"\uC11C\uBE44\uC2A4\uC6CC\uCEE4\uB85C POST Request \uCE90\uC2F1\uD558\uAE30","permalink":"/en/2020/01/16/Serviceworker-cache-POST-requests"}}')}}]);