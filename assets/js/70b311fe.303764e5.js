"use strict";(self.webpackChunkdocu_blog=self.webpackChunkdocu_blog||[]).push([[97115],{17070:(e,t,s)=>{s.d(t,{Zo:()=>u,kt:()=>d});var r=s(76687);function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function l(e,t){if(null==e)return{};var s,r,n=function(e,t){if(null==e)return{};var s,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)s=o[r],t.indexOf(s)>=0||(n[s]=e[s]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)s=o[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}var i=r.createContext({}),p=function(e){var t=r.useContext(i),s=t;return e&&(s="function"==typeof e?e(t):a(a({},t),e)),s},u=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var s=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=p(s),d=n,h=m["".concat(i,".").concat(d)]||m[d]||c[d]||o;return s?r.createElement(h,a(a({ref:t},u),{},{components:s})):r.createElement(h,a({ref:t},u))}));function d(e,t){var s=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=s.length,a=new Array(o);a[0]=m;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:n,a[1]=l;for(var p=2;p<o;p++)a[p]=s[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,s)}m.displayName="MDXCreateElement"},35606:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var r=s(96428),n=(s(76687),s(17070));const o={title:"rollup-plugin-postcss \uc758 path alias \ubb38\uc81c",authors:"me",tags:["javascript","rollup"],date:new Date("2021-09-11T22:31:22.000Z")},a="rollup-plugin-postcss",l={permalink:"/2021/09/11/rollup-plugin-postcss-\uc758-path-alias-\ubb38\uc81c",source:"@site/blog/2021/09/11/rollup-plugin-postcss-\uc758-path-alias-\ubb38\uc81c.md",title:"rollup-plugin-postcss \uc758 path alias \ubb38\uc81c",description:"- \ud604\uc7ac(210911) \uba54\uc778\ud14c\uc774\ub108\ub97c \uad6c\ud558\ub294 \ud504\ub85c\uc81d\ud2b8\uc774\ubbc0\ub85c \uc774\uc288\uac00 \uc218\uc815\ub418\uc9c0 \uc54a\ub294\ub2e4.",date:"2021-09-11T22:31:22.000Z",formattedDate:"September 11, 2021",tags:[{label:"javascript",permalink:"/tags/javascript"},{label:"rollup",permalink:"/tags/rollup"}],readingTime:4.32,hasTruncateMarker:!1,authors:[{name:"Gracefullight",title:"Owner",url:"https://github.com/gracefullight",imageURL:"https://avatars.githubusercontent.com/u/11773683?v=4",key:"me"}],frontMatter:{title:"rollup-plugin-postcss \uc758 path alias \ubb38\uc81c",authors:"me",tags:["javascript","rollup"],date:"2021-09-11T22:31:22.000Z"},prevItem:{title:"yarn berry \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uccb4\ud06c\ub9ac\uc2a4\ud2b8",permalink:"/2021/09/11/yarn-berry-\ub9c8\uc774\uadf8\ub808\uc774\uc158-\uccb4\ud06c\ub9ac\uc2a4\ud2b8"},nextItem:{title:"ecma \uc2a4\ud399\uc73c\ub85c \uc54c\uc544\ubcf4\ub294 prototype",permalink:"/2021/05/01/js-prototype-spec"}},i={authorsImageUrls:[void 0]},p=[{value:"scss alias",id:"scss-alias",level:2},{value:"sass-loader",id:"sass-loader",level:2},{value:"custom-sass-loader",id:"custom-sass-loader",level:2},{value:"rollup.config.js",id:"rollupconfigjs",level:2}],u={toc:p};function c(e){let{components:t,...s}=e;return(0,n.kt)("wrapper",(0,r.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/egoist/rollup-plugin-postcss/issues/217"},"\ud604\uc7ac(210911) \uba54\uc778\ud14c\uc774\ub108\ub97c \uad6c\ud558\ub294 \ud504\ub85c\uc81d\ud2b8"),"\uc774\ubbc0\ub85c \uc774\uc288\uac00 \uc218\uc815\ub418\uc9c0 \uc54a\ub294\ub2e4.")),(0,n.kt)("h2",{id:"scss-alias"},"scss alias"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-scss"},"// ~\ub294 \ub178\ub4dc \ubaa8\ub4c8 \ucc98\ub9ac\ub41c\ub2e4.\n@import '~@material';\n\n// @styles \ub85c \uc0ac\uc6a9\ud558\uace0 \uc2f6\uc744 \uacbd\uc6b0\uac00 \uc788\ub2e4.\n@import '@styles/mystyle';\n")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"\ub450 \ubc88\uc9f8\uc758 \uacbd\uc6b0\ub294 scss \uc2dc\ud2b8\ub97c \ucc98\ub9ac\ud574\uc8fc\uba74\uc11c ",(0,n.kt)("inlineCode",{parentName:"li"},"(plugin postcss) Error: Can't find stylesheet to import.")," \uc640 \uac19\uc740 \uc5d0\ub7ec\ub97c \ubc49\ub294\ub2e4."),(0,n.kt)("li",{parentName:"ul"},"\uc6f9\ud329\uc758 \uacbd\uc6b0 ",(0,n.kt)("inlineCode",{parentName:"li"},"resolve.alias")," \uac00 \uc54c\uc544\uc11c \ucc98\ub9ac\ub97c \ud574\uc8fc\uc9c0\ub9cc, rollup-plugin-postcss \uc758 sass-loader \uc5d0\uc11c importer \ub97c \ucd94\uac00\ud574\uc918\uc57c\ud560 \uac83 \uac19\uc558\ub2e4.")),(0,n.kt)("h2",{id:"sass-loader"},"sass-loader"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"\uc774 \ud50c\ub7ec\uadf8\uc778\uc758 sass-loader \ub294 ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/egoist/rollup-plugin-postcss/blob/master/src/sass-loader.js#L79"},"dart-sass \uc758 importer \ub97c \ud655\uc7a5"),"\ud574\uc11c \uc27d\uac8c \ucd94\uac00\uac00 \uac00\ub2a5\ud574\ubcf4\uc600\ub2e4."),(0,n.kt)("li",{parentName:"ul"},"\uadf8\ub7ec\ub098 \uc544\ubb34\ub9ac \ud655\uc7a5\ucc98\ub9ac\ub97c \ud574\ub3c4 importer \uc5d0\uc11c \ud574\ub2f9 \uacbd\ub85c\uac00 \ub9ac\uc878\ube0c \ub418\uc9c0 \uc54a\uc558\uace0 ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/egoist/rollup-plugin-postcss/issues?q=importer"},"\uad00\ub828 \uc774\uc288"),"\uac00 3\uac1c, PR\uc774 2\uac1c \ub4f1\ub85d\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4."),(0,n.kt)("li",{parentName:"ul"},"\uc774 \uac78 \ud574\uacb0\ud558\ub824\uba74 postcss.use.sass \uc0ac\uc6a9\uc2dc\uc5d0 importer \ub97c override \ud574\uc8fc\ub294 custom sass-loader \ub97c \uc9c1\uc811 \ub9cc\ub4e4\uc5b4\uc57c\ud55c\ub2e4.")),(0,n.kt)("h2",{id:"custom-sass-loader"},"custom-sass-loader"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/egoist/rollup-plugin-postcss/blob/master/src/sass-loader.js"},"https://github.com/egoist/rollup-plugin-postcss/blob/master/src/sass-loader.js")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"pity")," \ub294 promisify \ub85c \ub300\uccb4 \uac00\ub2a5\ud558\uc5ec \uc9c0\uc6e0\uace0 ",(0,n.kt)("inlineCode",{parentName:"li"},"import-cwd")," \ub3c4 node \ucf54\uc5b4\ub97c \uc0ac\uc6a9\ud558\uac8c \ubcc0\uacbd\ud588\ub2e4."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"p-queue")," \ub3c4 child_process \ub85c \ub300\uccb4 \uac00\ub2a5\ud574\ubcf4\uc778\ub2e4.")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},"import { createRequire } from 'module';\nimport path from 'path';\nimport { promisify } from 'util';\n\nimport resolve from 'resolve';\nimport PQueue from 'p-queue';\n\nfunction loadModule(moduleId) {\n  try {\n    return require(moduleId);\n  } catch {\n    // Ignore error\n  }\n\n  try {\n    return createRequire(path.resolve(process.cwd(), 'noop.js'))(moduleId);\n  } catch {\n    // Ignore error\n  }\n}\n\n// This queue makes sure node-sass leaves one thread available for executing fs tasks\n// See: https://github.com/sass/node-sass/issues/857\nconst threadPoolSize = process.env.UV_THREADPOOL_SIZE || 4;\nconst workQueue = new PQueue({ concurrency: threadPoolSize - 1 });\n\nconst moduleRe = /^~([a-z\\d]|@).+/i;\n\nconst getUrlOfPartial = (url) => {\n  const parsedUrl = path.parse(url);\n  return `${parsedUrl.dir}${path.sep}_${parsedUrl.base}`;\n};\n\nconst resolvePromise = promisify(resolve);\n\n// List of supported SASS modules in the order of preference\nconst sassModuleIds = ['node-sass', 'sass'];\n\nexport default {\n  name: 'sass',\n  test: /\\.(sass|scss)$/,\n  process({ code }) {\n    return new Promise((resolve, reject) => {\n      const sass = loadSassOrThrow();\n      const render = promisify(sass.render.bind(sass));\n      const data = this.options.data || '';\n      workQueue.add(() =>\n        render({\n          ...this.options,\n          file: this.id,\n          data: data + code,\n          indentedSyntax: /\\.sass$/.test(this.id),\n          sourceMap: this.sourceMap,\n          importer: [\n            (url, importer, done) => {\n              if (!moduleRe.test(url)) {\n                // \uc774\ubd80\ubd84\uc5d0 alias importer \uac00 \ucd94\uac00\ub418\uc5b4\uc57c\ud55c\ub2e4.\n                if (/^@styles/.test(url)) {\n                  return done({\n                    file: url.replace(\n                      /^@styles/,\n                      path.resolve(__dirname, './src/styles'),\n                    ),\n                  });\n                }\n                return done({ file: url });\n              }\n              const moduleUrl = url.slice(1);\n              const partialUrl = getUrlOfPartial(moduleUrl);\n\n              const options = {\n                basedir: path.dirname(importer),\n                extensions: ['.scss', '.sass', '.css'],\n              };\n              const finishImport = (id) => {\n                done({\n                  // Do not add `.css` extension in order to inline the file\n                  file: id.endsWith('.css') ? id.replace(/\\.css$/, '') : id,\n                });\n              };\n\n              const next = () => {\n                // Catch all resolving errors, return the original file and pass responsibility back to other custom importers\n                done({ file: url });\n              };\n\n              // Give precedence to importing a partial\n              resolvePromise(partialUrl, options)\n                .then(finishImport)\n                .catch((error) => {\n                  if (\n                    error.code === 'MODULE_NOT_FOUND' ||\n                    error.code === 'ENOENT'\n                  ) {\n                    resolvePromise(moduleUrl, options)\n                      .then(finishImport)\n                      .catch(next);\n                  } else {\n                    next();\n                  }\n                });\n            },\n          ].concat(this.options.importer || []),\n        })\n          .then((result) => {\n            for (const file of result.stats.includedFiles) {\n              this.dependencies.add(file);\n            }\n\n            resolve({\n              code: result.css.toString(),\n              map: result.map && result.map.toString(),\n            });\n          })\n          .catch(reject),\n      );\n    });\n  },\n};\n\n// \uc774\ud558 \uc0dd\ub7b5...\n")),(0,n.kt)("h2",{id:"rollupconfigjs"},"rollup.config.js"),(0,n.kt)("p",null,"\uc704\uc758 \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5\ub41c sass-loader \ub97c ",(0,n.kt)("inlineCode",{parentName:"p"},"use: ['sass']")," \ub300\uc2e0 \ub4f1\ub85d\ud574\uc900\ub2e4."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-js"},"postcss({\n  // \ucd94\uac00\n  loaders: [customSassLoader],\n  // \uc81c\uac70\n  // use: ['sass']\n})\n")),(0,n.kt)("h1",{id:"\uacb0\ub860"},"\uacb0\ub860"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"rollup-plugin-postcss")," \ub294 \uc774\uc288\uac00 \uc788\uc5b4 \ud655\uc7a5\uc744 \uc9c1\uc811\ud574\uc57c\ud558\uace0 \uc774\ub294 \uc720\uc9c0\ubcf4\uc218 \ud3ec\uc778\ud2b8\ub85c \ub2e4\uac00\uc62c \uc218 \uc788\ub2e4."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"postcss-import")," \ub294 alias \uae30\ub2a5\uc774 \uc5c6\uc5b4 \uc0ac\uc6a9\uc774 \ubd88\uac00\ub2a5\ud558\ub2e4."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"postcss-import-alias")," \ub4f1\ub4f1\uc758 alias \ub97c \ucd94\uac00\ud55c \ub77c\uc774\ube0c\ub7ec\ub9ac\ub3c4 \ubd88\uac00\ub2a5\ud55c\ub370, \uc774\ub294 ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/egoist/rollup-plugin-postcss/blob/master/src/loaders.js#L36"},"postcssLoader \uac00 \uba3c\uc800 \ub4f1\ub85d")," \ub418\ub294\ub370 \uc758\uc678\uc758 \uacb0\uacfc\uc774\ub2e4. ",(0,n.kt)("inlineCode",{parentName:"li"},"rollup-plugin-postcss")," \ub97c \uc9c1\uc811 \ub85c\uceec\uc5d0\uc11c \ube4c\ub4dc\ud574\uc11c \ud574\ub2f9 \uc9c0\uc810\uc744 \ud655\uc778\ud574\ubcfc \uc218 \uc788\uaca0\uc9c0\ub9cc PR \uc744 \ubc1b\uc9c0 \uc54a\uc73c\ubbc0\ub85c \uc758\ubbf8\ub3c4 \uc5c6\ub2e4."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/thgh/rollup-plugin-scss"},"rollup-plugin-scss"),"\ub97c \uc0ac\uc6a9\ud558\uace0 postcss \ub97c processor \ub85c \uc918\uc11c \ubc18\ub300\ub85c \ucc98\ub9ac\ud560 \uc218 \uc788\uc5b4\ubcf4\uc774\ub294\ub370, \ube4c\ub4dc \ud30c\uc774\ud504\ub77c\uc778\uc744 \ub2e4 \ub9ac\ud329\ud1a0\ub9c1\uc744 \ud574\uc57c\ud558\ubbc0\ub85c \ub098\uc911\uc5d0 \ub3c4\uc804\ud574\ubcf4\ub294\uac78\ub85c \ud558\uc790.")))}c.isMDXComponent=!0}}]);