"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([["73262"],{26138:function(e,n,l){l.r(n),l.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>g,frontMatter:()=>o,metadata:()=>r,toc:()=>c});var r=l(39337),a=l(69979),t=l(56774);let o={title:"Laravel 5.5 - Log Permission \uBB38\uC81C",authors:"me",tags:["php","laravel"],date:new Date("2017-08-18T22:11:35.000Z")},i=void 0,s={authorsImageUrls:[void 0]},c=[{value:"selinux",id:"selinux",level:2},{value:"WebServer user",id:"webserver-user",level:2},{value:"php-fpm user",id:"php-fpm-user",level:2},{value:"log rotate",id:"log-rotate",level:2},{value:"cron \uC0AC\uC6A9\uC2DC",id:"cron-\uC0AC\uC6A9\uC2DC",level:2},{value:"\uB85C\uADF8 \uBD84\uAE30",id:"\uB85C\uADF8-\uBD84\uAE30",level:3},{value:"setfacl",id:"setfacl",level:3},{value:"\uC5EC\uB2F4",id:"\uC5EC\uB2F4",level:2}];function p(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["\uC6F9 \uC11C\uBC84\uC758 \uC720\uC800\uB85C \uB85C\uADF8 \uD30C\uC77C\uC774 \uC0DD\uC131\uB418\uC5B4\uC57C \uD558\uB294\uB370, \uC5B4\uB290 \uC21C\uAC04\uBD80\uD130 root",":root"," \uAD8C\uD55C\uC744 \uB2EC\uACE0 daliy log \uAC00 \uC0DD\uC131\uB418\uB294 \uACBD\uC6B0\uAC00 \uC788\uB2E4."]}),"\n",(0,a.jsx)(n.p,{children:"\uC5EC\uB7EC\uAC00\uC9C0 \uACBD\uC6B0\uC758 \uC218\uAC00 \uC788\uB294\uB370, \uB9DE\uB294 \uC870\uAC74\uC744 \uCC3E\uC544\uC11C Permission \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC9C0 \uC54A\uAC8C \uCC98\uB9AC\uD574\uBCF4\uC790."}),"\n",(0,a.jsx)(n.h2,{id:"selinux",children:"selinux"}),"\n",(0,a.jsx)(n.p,{children:"storage \uC5D0\uB294 \uC4F0\uAE30\uAD8C\uD55C\uC774 \uC788\uC5B4\uC57C\uD55C\uB2E4."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"chcon -R -t httpd_sys_rw_content_t storage\n"})}),"\n",(0,a.jsx)(n.h2,{id:"webserver-user",children:"WebServer user"}),"\n",(0,a.jsx)(n.p,{children:"\uC6F9 \uC11C\uBC84\uC758 \uC720\uC800\uAC00 \uB2E4\uB974\uAC8C \uC124\uC815 \uB418\uC5B4\uC788\uC744 \uB54C \uAD8C\uD55C\uC774 \uBC14\uB014 \uC218 \uC788\uB2E4.\n\uC11C\uBC84 \uC124\uC815\uC744 \uC5F4\uC5B4\uC11C \uC720\uC800\uAC00 \uC81C\uB300\uB85C \uC124\uC815\uB418\uC5B4 \uC788\uB294\uC9C0 \uD655\uC778\uD574\uBCF4\uC790."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-conf",metastring:'title="nginx.conf"',children:"user nginx;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"php-fpm-user",children:"php-fpm user"}),"\n",(0,a.jsx)(n.p,{children:"php-fpm \uC5D0\uC11C \uC124\uC815\uD558\uB294 user \uC640 group \uC774 \uB2E4\uB974\uAC8C \uC124\uC815 \uB418\uC5B4 \uC788\uC744 \uB54C \uAD8C\uD55C\uC774 \uBC14\uB014 \uC218 \uC788\uB2E4.\nphp-fpm \uC124\uC815\uC744 \uC5F4\uC5B4 \uC720\uC800\uAC00 \uC81C\uB300\uB85C \uC124\uC815\uB418\uC5B4 \uC788\uB294\uC9C0 \uD655\uC778\uD574\uBCF4\uC790."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-conf",metastring:'title="php-fpm.d/www.conf"',children:"user = nginx\ngroup = nginx\n\nlisten.owner = nginx\nlisten.group = nginx\n"})}),"\n",(0,a.jsx)(n.h2,{id:"log-rotate",children:"log rotate"}),"\n",(0,a.jsx)(n.p,{children:"\uB85C\uADF8 \uD30C\uC77C\uC774 \uB108\uBB34 \uCEE4\uC9C0\uB294 \uAC78 \uB9C9\uAE30\uC704\uD574 log rotate \uC124\uC815\uC774 \uB418\uC5B4\uC788\uB2E4\uBA74 \uAD8C\uD55C\uC774 \uBC14\uB014 \uC218 \uC788\uB2E4.\nlogrotate \uAC00 cron \uC5D0 \uBB3C\uB824 \uC788\uB294\uC9C0 \uC124\uC815\uC744 \uD655\uC778\uD574\uBCF4\uC790."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",metastring:'title="/etc/logroate.d/*"',children:"$ pwd\n/etc/logroate.d\n\n$ vi nginx\n$ vi php-fpm\n"})}),"\n",(0,a.jsx)(n.h2,{id:"cron-\uC0AC\uC6A9\uC2DC",children:"cron \uC0AC\uC6A9\uC2DC"}),"\n",(0,a.jsx)(n.p,{children:"crontab \uC758 \uACBD\uC6B0 root \uC720\uC800\uB85C \uC2E4\uD589\uC774 \uB418\uBA74 cron \uC5D0\uC11C Laravel \uC744 \uD638\uCD9C\uD560 \uB54C log \uAC00 root \uAD8C\uD55C\uC73C\uB85C \uC0DD\uC131\uB420 \uC218 \uC788\uB2E4."}),"\n",(0,a.jsx)(n.h3,{id:"\uB85C\uADF8-\uBD84\uAE30",children:"\uB85C\uADF8 \uBD84\uAE30"}),"\n",(0,a.jsxs)(n.p,{children:["log \uD30C\uC77C\uC744 \uC0DD\uC131\uD558\uB294 \uD504\uB85C\uC138\uC2A4\uBCC4\uB85C \uBD84\uAE30\uD574\uC11C \uD574\uACB0\uD560 \uC218 \uC788\uB2E4. ",(0,a.jsx)(n.a,{href:"https://stackoverflow.com/questions/27674597/laravel-daily-log-created-with-wrong-permissions",children:"Stackoverflow"})," \uCC38\uC870"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",metastring:'title="bootstrap/app.php"',children:"$app->configureMonologUsing(function(Monolog\\Logger $monolog) {\n    $filename = storage_path('logs/laravel-'.php_sapi_name().'.log');\n    $handler = new Monolog\\Handler\\RotatingFileHandler($filename);\n    $monolog->pushHandler($handler);\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:"\uC124\uC815\uC744 \uCD94\uAC00\uD574 \uB193\uC73C\uBA74 logs \uD3F4\uB354 \uD558\uC704\uC5D0 \uB2E4\uC74C\uACFC \uAC19\uC774 \uB85C\uADF8\uAC00 \uBD84\uAE30\uB418\uC5B4 \uC0DD\uC131\uB41C\uB2E4."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",metastring:'title="storage/logs"',children:"$ ls -al .\n-rw-r--r-- 1 nginx nginx        718 Aug 18 10:56 laravel-fpm-fcgi-2017-08-18.log\n"})}),"\n",(0,a.jsxs)(n.p,{children:["cron \uC740 root \uC5D0\uC11C \uC2E4\uD589\uB418\uB098 user shell \uC5D0\uC11C Laravel \uD504\uB85C\uC138\uC2A4\uB97C \uC2E4\uD589\uD558\uB294 \uACBD\uC6B0 root \uC5D0 \uC758\uD574 log \uAC00 \uC0DD\uC131\uB418\uC5C8\uB2E4\uBA74 \uB2E4\uC74C\uACFC \uAC19\uC774 permission \uC744 \uBCC0\uACBD\uD574\uC11C \uC0DD\uC131\uD574\uC57C\uD55C\uB2E4. ",(0,a.jsx)(n.a,{href:"https://blog.asamaru.net/2017/03/08/laravel-log-files-permisson-change/",children:"Post"})," \uCC38\uC870"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",metastring:'title="bootstrap/app.php"',children:"$app->configureMonologUsing(function(Monolog\\Logger $monolog) {\n    $filename = storage_path('/logs/laravel-' . php_sapi_name() . '.log');\n    // 5\uBC88\uC9F8 \uD30C\uB77C\uBBF8\uD130\uB85C 666 \uAD8C\uD55C\uC744 \uB118\uAE34\uB2E4.\n    $handler = new Monolog\\Handler\\RotatingFileHandler($filename, 0, \\Monolog\\Logger::DEBUG, true, 0666);\n    $monolog->pushHandler($handler);\n});\n"})}),"\n",(0,a.jsxs)(n.p,{children:["RotatingFileHandler \uC758 Parameter \uB294 ",(0,a.jsx)(n.a,{href:"https://github.com/Seldaek/monolog/blob/master/src/Monolog/Handler/RotatingFileHandler.php#L47",children:"\uC5EC\uAE30"}),"\uB97C \uCC38\uC870\uD558\uC790.\n666 \uC73C\uB85C \uC0DD\uC131 \uC2DC\uC5D4 \uAD73\uC774 ",(0,a.jsx)(n.code,{children:"php_sapi_name()"}),"\uC744 \uC0AC\uC6A9\uD558\uC9C0 \uC54A\uC544\uB3C4 \uB41C\uB2E4. (rw \uAD8C\uD55C\uC774 \uBAA8\uB450\uC5D0\uAC8C \uC788\uC73C\uB2C8\uAE4C)"]}),"\n",(0,a.jsx)(n.h3,{id:"setfacl",children:"setfacl"}),"\n",(0,a.jsxs)(n.p,{children:["\uB2E4\uB978 \uD574\uACB0 \uBC29\uBC95\uC73C\uB85C\uB294 ACL \uC744 \uC218\uC815\uD574 logs \uD3F4\uB354 \uC790\uCCB4\uB97C \uD574\uB2F9 user",":group"," \uC774 \uD3B8\uC9D1\uD560 \uC218 \uC788\uAC8C \uCC98\uB9AC\uD558\uBA74 \uB41C\uB2E4."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"$ pwd\n/public_html/storage/logs\n\n$ setfacl -d -m u:nginx:rwx .\n\n$ getfacl .\ndefault:user:nginx:rwx\n\n## \uC0AD\uC81C\n$ setfacl -d -x u:nginx .\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\uC5EC\uB2F4",children:"\uC5EC\uB2F4"}),"\n",(0,a.jsxs)(n.p,{children:["Laravel \uD504\uB85C\uC81D\uD2B8 \uC2DC\uC791\uC2DC ",(0,a.jsx)(n.code,{children:"bootstrap/app.php"})," \uC548\uC5D0 \uB85C\uADF8\uB97C \uBD84\uAE30 \uB85C\uC9C1\uC744 \uB123\uACE0 \uAC1C\uBC1C\uD558\uB294 \uAC8C \uC88B\uC544\uBCF4\uC778\uB2E4."]})]})}function g(e={}){let{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},56774:function(e,n,l){l.d(n,{Z:()=>i,a:()=>o});var r=l(52136);let a={},t=r.createContext(a);function o(e){let n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),r.createElement(t.Provider,{value:n},e.children)}},39337:function(e){e.exports=JSON.parse('{"permalink":"/2017/08/18/Laravel-5-4-Log-Permission-Denied","source":"@site/blog/2017/08/18/Laravel-5-4-Log-Permission-Denied.md","title":"Laravel 5.5 - Log Permission \uBB38\uC81C","description":"\uC6F9 \uC11C\uBC84\uC758 \uC720\uC800\uB85C \uB85C\uADF8 \uD30C\uC77C\uC774 \uC0DD\uC131\uB418\uC5B4\uC57C \uD558\uB294\uB370, \uC5B4\uB290 \uC21C\uAC04\uBD80\uD130 root:root \uAD8C\uD55C\uC744 \uB2EC\uACE0 daliy log \uAC00 \uC0DD\uC131\uB418\uB294 \uACBD\uC6B0\uAC00 \uC788\uB2E4.","date":"2017-08-18T22:11:35.000Z","tags":[{"inline":true,"label":"php","permalink":"/tags/php"},{"inline":true,"label":"laravel","permalink":"/tags/laravel"}],"readingTime":2.02,"hasTruncateMarker":false,"authors":[{"name":"Eunkwang Shin","title":"Owner","url":"https://github.com/gracefullight","socials":{"linkedin":"https://www.linkedin.com/in/gracefullight/","github":"https://github.com/gracefullight"},"description":"Full Stack JavaScript Developer | Half-time Open Sourcerer.","page":{"permalink":"/authors/me"},"imageURL":"https://avatars.githubusercontent.com/u/11773683?v=4","key":"me"}],"frontMatter":{"title":"Laravel 5.5 - Log Permission \uBB38\uC81C","authors":"me","tags":["php","laravel"],"date":"2017-08-18T22:11:35.000Z"},"unlisted":false,"prevItem":{"title":"AWS CodeCommit \uC0AC\uC6A9\uD558\uAE30","permalink":"/2017/08/18/AWS-CodeCommit-\uC0AC\uC6A9\uD558\uAE30"},"nextItem":{"title":"Docker\uB85C LEMP Stack \uAD6C\uCD95\uD558\uAE30","permalink":"/2017/08/14/LEMP-with-Docker"}}')}}]);