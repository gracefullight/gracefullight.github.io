"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([["74280"],{10309(e,t,i){i.r(t),i.d(t,{default:()=>h});var n=i(96540),a=i(61121),r=i(86501);class o extends(0,r.u6)(a.lB){static shadowRootOptions={...a.lB.shadowRootOptions};static getTemplateHTML=e=>{let{src:t,...i}=e;return a.lB.getTemplateHTML(i)};#e;attributeChangedCallback(e,t,i){"src"!==e&&super.attributeChangedCallback(e,t,i),"src"===e&&t!=i&&this.load()}async _initThumbnails(e){let t=async(t,i)=>{let n=[],a=e.timescale||1,r=e.startNumber||1,o=e.presentationTimeOffset?e.presentationTimeOffset/a:0,l=e.segmentDuration;for(let e=0;e<t;e++){let a=function({thIndex:e,tduration:t,thduration:i,ttiles:n,startNumber:a,pto:r}){return(Math.floor(e/n)+a-1)*t-r+(e%n+1-1)*i}({thIndex:e,thduration:i,ttiles:t,tduration:l,startNumber:r,pto:o}),s=a+i,u=new Promise((e,t)=>{this.api.provideThumbnail(a,({url:i,width:n,height:r,x:o,y:l})=>{try{let t=new VTTCue(a,s,`${i}#xywh=${o},${l},${n},${r}`);e(t)}catch(e){t(e)}})});n.push(u)}return await Promise.all(n).catch(e=>console.error("Error processing thumbnails",e))},{totalThumbnails:i,thumbnailDuration:n}=function(e){var t,i;let[n,a]=e.essentialProperties[0].value.split("x").map(Number),r=(null==(i=null==(t=e.adaptation)?void 0:t.period)?void 0:i.duration)||null,o=e.segmentDuration,l=o/(e.timescale||1)/(n*a);return{totalThumbnails:null!=r?Math.ceil(r/l):Math.ceil(o/l),thumbnailDuration:l}}(e),a=await t(i,n),r=this.nativeEl.querySelector('track[label="thumbnails"]');if(!r){let e;(e=document.createElement("track")).kind="metadata",e.label="thumbnails",e.srclang="en",e.mode="hidden",e.default=!0,r=e,this.nativeEl.appendChild(r);let t=function(e){let t="WEBVTT\n\n";for(let i of e)t+=`${n(i.startTime)} --> ${n(i.endTime)}
${i.text}

`;let i=new Blob([t],{type:"text/vtt"});return URL.createObjectURL(i);function n(e){let t=String(Math.floor(e/3600)).padStart(2,"0"),i=String(Math.floor(e%3600/60)).padStart(2,"0"),n=(e%60).toFixed(3).padStart(6,"0");return`${t}:${i}:${n}`}}(a);r.src=t,r.dispatchEvent(new Event("change"))}}async load(){if(this.#e)return void this.api.attachSource(this.src);this.#e=!0;let e=await i.e("79588").then(i.bind(i,20303));this.api=e.MediaPlayer().create(),this.api.initialize(this.nativeEl,this.src,this.autoplay),this.api.on(e.MediaPlayer.events.STREAM_INITIALIZED,()=>{let e=this.api.getRepresentationsByType("video"),t=this.videoTracks.getTrackById("main");t||((t=this.addVideoTrack("main")).id="main",t.selected=!0),e.forEach(e=>{let i=e.bandwidth??e.bitrate??(Number.isFinite(e.bitrateInKbit)?1e3*e.bitrateInKbit:void 0);t.addRendition(e.id,e.width,e.height,e.mimeType??e.codec,i).id=e.id}),this.videoRenditions.addEventListener("change",()=>{let e=this.videoRenditions[this.videoRenditions.selectedIndex];(null==e?void 0:e.id)?(this.api.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!1}}}}),this.api.setRepresentationForTypeById("video",e.id,!0)):this.api.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!0}}}})}),this.api.isDynamic()||this.api.getRepresentationsByType("image").forEach(async(e,t)=>{t>0||this._initThumbnails(e)})})}}globalThis.customElements&&!globalThis.customElements.get("dash-video")&&globalThis.customElements.define("dash-video",o);var l=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),s={className:"class",htmlFor:"for"};function u(e){return e.toLowerCase()}function d(e){return"boolean"==typeof e?e?"":void 0:"function"==typeof e?void 0:"object"!=typeof e||null===e?e:void 0}function c(e,t,i){var n;e[t]=i,null==i&&t in((null==(n=globalThis.HTMLElement)?void 0:n.prototype)??{})&&e.removeAttribute(t)}var h=function({react:e,tagName:t,elementClass:i,events:n,displayName:a,defaultProps:r,toAttributeName:o=u,toAttributeValue:h=d}){let p=Number.parseInt(e.version)>=19,m=e.forwardRef((a,u)=>{var m,f;let v=e.useRef(null),b=e.useRef(new Map),g={},y={},T={},w={};for(let[e,t]of Object.entries(a)){if(l.has(e)){T[e]=t;continue}let n=o(s[e]??e);if(i.prototype&&e in i.prototype&&!(e in((null==(m=globalThis.HTMLElement)?void 0:m.prototype)??{}))&&!(null==(f=i.observedAttributes)?void 0:f.some(e=>e===n))){w[e]=t;continue}if(e.startsWith("on")){g[e]=t;continue}let a=h(t);n&&null!=a&&(y[n]=String(a),p||(T[n]=a)),n&&p&&(a!==d(t)?T[n]=a:T[n]=t)}if("u">typeof window){for(let t in g){let i=g[t],a=t.endsWith("Capture"),r=((null==n?void 0:n[t])??t.slice(2).toLowerCase()).slice(0,a?-7:void 0);e.useLayoutEffect(()=>{let e=null==v?void 0:v.current;if(e&&"function"==typeof i)return e.addEventListener(r,i,a),()=>{e.removeEventListener(r,i,a)}},[null==v?void 0:v.current,i])}e.useLayoutEffect(()=>{if(null===v.current)return;let e=new Map;for(let t in w)c(v.current,t,w[t]),b.current.delete(t),e.set(t,w[t]);for(let[e,t]of b.current)c(v.current,e,void 0);b.current=e})}if("u"<typeof window&&(null==i?void 0:i.getTemplateHTML)&&(null==i?void 0:i.shadowRootOptions)){let{mode:t,delegatesFocus:n}=i.shadowRootOptions;T.children=[e.createElement("template",{shadowrootmode:t,shadowrootdelegatesfocus:n,dangerouslySetInnerHTML:{__html:i.getTemplateHTML(y,a)},key:"ce-la-react-ssr-template-shadow-root"}),T.children]}return e.createElement(t,{...r,...T,ref:e.useCallback(e=>{v.current=e,"function"==typeof u?u(e):null!==u&&(u.current=e)},[u])},T.children)});return m.displayName=a??i.name,m}({react:n,tagName:"dash-video",elementClass:o,toAttributeName:e=>"muted"===e?"":"defaultMuted"===e?"muted":u(e)})}}]);