"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([["9438"],{11703:function(e,n,t){t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>c,default:()=>o,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var i=t(81656),r=t(69979),l=t(88529);let s={title:"PHP 7.1\uC5D0\uC11C mcrypt \uB300\uCCB4\uD558\uAE30",authors:"me",tags:["php","openssl"],date:new Date("2017-07-07T22:33:46.000Z")},c=void 0,p={authorsImageUrls:[void 0]},d=[{value:"MCRYPT",id:"mcrypt",level:2},{value:"\uAE30\uC874 \uC18C\uC2A4",id:"\uAE30\uC874-\uC18C\uC2A4",level:3},{value:"\uB300\uC548",id:"\uB300\uC548",level:3},{value:"OPENSSL",id:"openssl",level:2},{value:"Encrypt",id:"encrypt",level:3},{value:"Decrypt",id:"decrypt",level:3},{value:"PKCS5 vs PKCS7",id:"pkcs5-vs-pkcs7",level:3},{value:"triple des",id:"triple-des",level:3},{value:"\uD328\uD0A4\uC9C0",id:"\uD328\uD0A4\uC9C0",level:2},{value:"\uC5EC\uB2F4",id:"\uC5EC\uB2F4",level:2}];function a(e){let n={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"mcrypt",children:"MCRYPT"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uC554\uD638\uD654 \uD568\uC218\uC778 ",(0,r.jsx)(n.code,{children:"mcrypt"})," \uAC00 PHP 7.1 \uBC84\uC804\uBD80\uD130 Deprecated \uB418\uC5C8\uB2E4."]}),"\n",(0,r.jsxs)(n.li,{children:["\uC65C \uC0AC\uB77C\uC84C\uB294\uC9C0\uB294 ",(0,r.jsx)(n.a,{href:"https://paragonie.com/blog/2015/05/if-you-re-typing-word-mcrypt-into-your-code-you-re-doing-it-wrong",children:"\uB9C1\uD06C"}),"\uC5D0 \uC790\uC138\uD558\uAC8C \uB098\uC640\uC788\uB2E4."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\uAE30\uC874-\uC18C\uC2A4",children:"\uAE30\uC874 \uC18C\uC2A4"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["PHP \uAD6C\uBC84\uC804\uC5D0\uC11C\uB294 ",(0,r.jsx)(n.code,{children:"mcrypt"})," \uC640 ",(0,r.jsx)(n.code,{children:"MCRYPT_RIJNDAEL_128"})," \uC54C\uACE0\uB9AC\uC998\uC744 \uD1B5\uD574 AES128 \uC774 \uAD6C\uD604\uB418\uC5B4 \uC788\uC744 \uAC83\uC774\uB2E4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"MCRYPT_RIJNDAEL_128"}),"\uC740 ",(0,r.jsx)(n.strong,{children:"AES 128"}),"\uACFC ",(0,r.jsx)(n.strong,{children:"\uB3D9\uC77C"}),"\uD558\uB2E4."]}),"\n",(0,r.jsx)(n.li,{children:"\uD0C0 \uC5B8\uC5B4\uC640\uB294 \uC870\uAE08 \uB2E4\uB978\uB370, \uD638\uD658\uC744 \uC704\uD574\uC120 pkcs5 padding \uC73C\uB85C \uBCC0\uACBD\uD574\uC8FC\uB294 \uC791\uC5C5\uC774 \uD544\uC694\uD558\uB2E4."}),"\n",(0,r.jsx)(n.li,{children:"php mcrypt function \uC758 \uAE30\uBCF8 \uD328\uB529\uC740 zeros padding"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:'<?php\n// \uC774\uB7F0 \uC2DD\uC774\uAC70\uB098\n$cipherText = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, pkcs5_pad($plainText), MCRYPT_MODE_CBC, $iv);\n\n// \uC774\uB7F0 \uC2DD\uC77C \uAC83\n$td = mcrypt_module_open("rijndael-128", "", "cbc", "");\n@mcrypt_generic_init($td, $key, $iv);\n$cipherText = @mcrypt_generic($td, pkcs5_pad($plainText));\nmcrypt_generic_deinit($td);\nmcrypt_module_close($td);\n\nfunction pkcs5_pad($text, $blockSize = 16) {\n  $pad = $blockSize - (strlen($text) % $blockSize);\n  return $text . str_repeat(chr($pad), $pad);\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\uB300\uC548",children:"\uB300\uC548"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["PHP 5.3 \uBD80\uD130 \uC0AC\uC6A9 \uAC00\uB2A5\uD55C ",(0,r.jsx)(n.strong,{children:"openssl_encrypt"})," \uD568\uC218\uB97C \uC4F0\uBA74 \uB41C\uB2E4."]}),"\n",(0,r.jsx)(n.li,{children:"openssl \uD655\uC7A5 \uBAA8\uB4C8\uC774 \uC124\uCE58\uB418\uC5B4\uC57C\uD55C\uB2E4."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"openssl",children:"OPENSSL"}),"\n",(0,r.jsx)(n.h3,{id:"encrypt",children:"Encrypt"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"<?php\n$cipherText = openssl_encrypt($plainText, 'AES-128-CBC', $key, OPENSSL_RAW_DATA, $iv);\n// decrypt\uC5D0\uC11C \uC624\uB958\uAC00 \uBC1C\uC0DD\uD574 PKCS5\uB85C \uD328\uB529\uC744 \uB9DE\uCDB0\uC8FC\uACE0 \uBCF4\uB0B4\uC57C\uD55C\uB2E4\uBA74.\n$cipherText = openssl_encrypt(pkcs5_pad($plainText), 'AES-128-CBC', $key, OPENSSL_RAW_DATA, $iv);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"decrypt",children:"Decrypt"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"<?php\n$plainText = openssl_decrypt($cipherText, 'AES-128-CBC', $key, OPENSSL_RAW_DATA, $iv);\n// unpad\uAC00 \uD544\uC694\uD558\uB2E4\uBA74\n$plainText = pkcs5_unpad(openssl_decrypt($cipherText, 'AES-128-CBC', $key, OPENSSL_RAW_DATA, $iv));\n\nfunction pkcs5_unpad($text) {\n  $pad = ord($text{strlen($text)-1});\n  if ($pad > strlen($text)) {\n    return $text;\n  }\n  if (!strspn($text, chr($pad), strlen($text) - $pad)) {\n    return $text;\n  }\n  return substr($text, 0, -1 * $pad);\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pkcs5-vs-pkcs7",children:"PKCS5 vs PKCS7"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"openssl_encrypt"}),"\uC758 default padding \uC740 PKCS7 padding \uC778\uB370, \uC5B4\uB5BB\uAC8C \uD638\uD658\uC774 \uB418\uB294 \uAC83\uC77C\uAE4C?"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://social.msdn.microsoft.com/Forums/en-US/09fef7b7-b568-4895-8e52-f386be80aa2d/pkcs7-padding-in-net-vs-pkcs5-padding-in-java?forum=csharpgeneral",children:"\uC5EC\uAE30"}),"\uC11C \uD574\uB2F5\uC744 \uCC3E\uC558\uB2E4."]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"The difference between the PKCS#5 and PKCS#7 padding mechanisms is the block size;\nPKCS#5 padding is defined for 8-byte block sizes, PKCS#7 padding would work for any block size from 1 to 255 bytes.\nSo fundamentally PKCS#5 padding is a subset of PKCS#7 padding for 8 byte block sizes.\nso, data encrypted with PKCS#5 is able to decrypt with PKCS#7, but data encrypted with PKCS#7 may not be able to decrypt with PKCS#5."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"triple-des",children:"triple des"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"des-ede3-cbc"}),"\uAC00 triple des \uC54C\uACE0\uB9AC\uC998\uC774\uB2E4."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:'<?php\n// encrypt\nopenssl_encrypt($text, "des-ede3-cbc", $key, OPENSSL_RAW_DATA, $iv);\n\n// decrypt\nopenssl_decrypt($cipherText, "des-ede3-cbc", $key, OPENSSL_RAW_DATA, $iv);\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\uD328\uD0A4\uC9C0",children:"\uD328\uD0A4\uC9C0"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uC774 \uBAA8\uB4E0 \uAC78 \uCEE4\uBC84\uD558\uB294 \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB97C \uC0AC\uC6A9\uD558\uC790. ",(0,r.jsx)(n.a,{href:"https://github.com/phpseclib/mcrypt_compat",children:"phpseclib/mcrypt_compat"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"phpseclib"})," \uB294 laravel/passport \uC5D0\uC11C\uB3C4 \uC0AC\uC6A9\uB418\uC5C8\uB2E4."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\uC5EC\uB2F4",children:"\uC5EC\uB2F4"}),"\n",(0,r.jsx)(n.p,{children:"\uCE74\uCE74\uC624\uD398\uC774\uAC00 PHP 5 \uBC84\uC804\uB9CC \uC9C0\uC6D0\uD574 \uBB38\uC758\uD574\uBD24\uC9C0\uB9CC \uACC4\uD68D\uC774 \uC5C6\uC5B4 \uC774\uBC88 \uAE30\uD68C\uC5D0 \uBAA8\uB4C8\uC744 \uB2E4 \uB72F\uC5B4\uBD24\uB294\uB370 MCRYPT \uB9CC \uB9CC\uC838\uC8FC\uBA74 \uC815\uC0C1\uC801\uC73C\uB85C \uACB0\uC81C\uAC00 \uB418\uC5C8\uB2E4."}),"\n",(0,r.jsxs)(n.p,{children:["\uACE7 \uC774 \uC9D3\uC744 \uC548\uD574\uB3C4 \uB420 \uB4EF\uD558\uB2E4.\n",(0,r.jsx)(n.img,{src:"https://i.imgur.com/QBA9xnP.jpg",alt:"KakaoPay \uC885\uB8CC"})]})]})}function o(e={}){let{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},88529:function(e,n,t){t.d(n,{Z:()=>c,a:()=>s});var i=t(52136);let r={},l=i.createContext(r);function s(e){let n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(l.Provider,{value:n},e.children)}},81656:function(e){e.exports=JSON.parse('{"permalink":"/2017/07/07/PHP-7-1\uC5D0\uC11C-mcrypt-\uB300\uCCB4\uD558\uAE30","source":"@site/blog/2017/07/07/PHP-7-1\uC5D0\uC11C-mcrypt-\uB300\uCCB4\uD558\uAE30.md","title":"PHP 7.1\uC5D0\uC11C mcrypt \uB300\uCCB4\uD558\uAE30","description":"MCRYPT","date":"2017-07-07T22:33:46.000Z","tags":[{"inline":true,"label":"php","permalink":"/tags/php"},{"inline":true,"label":"openssl","permalink":"/tags/openssl"}],"readingTime":2.15,"hasTruncateMarker":false,"authors":[{"name":"Eunkwang Shin","title":"Owner","url":"https://github.com/gracefullight","socials":{"linkedin":"https://www.linkedin.com/in/gracefullight/","github":"https://github.com/gracefullight"},"description":"Full Stack JavaScript Developer | Half-time Open Sourcerer.","page":{"permalink":"/authors/me"},"imageURL":"https://avatars.githubusercontent.com/u/11773683?v=4","key":"me"}],"frontMatter":{"title":"PHP 7.1\uC5D0\uC11C mcrypt \uB300\uCCB4\uD558\uAE30","authors":"me","tags":["php","openssl"],"date":"2017-07-07T22:33:46.000Z"},"unlisted":false,"prevItem":{"title":"Laravel 5.5 - \uB85C\uADF8\uC778(Auth) \uBD99\uD788\uAE30","permalink":"/2017/07/09/Laravel-5-4-Login-with-Auth"},"nextItem":{"title":"Paypal \uAE30\uBD80 \uBC84\uD2BC \uB9CC\uB4E4\uAE30","permalink":"/2017/07/03/Paypal-\uAE30\uBD80-\uBC84\uD2BC-\uB9CC\uB4E4\uAE30"}}')}}]);