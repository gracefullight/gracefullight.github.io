"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([["99710"],{75713(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var l=i(28999),s=i(74848),a=i(28453);let r={title:"nodejs alpine3.13 \uD14C\uC2A4\uD2B8",authors:"me",tags:["javascript","nodejs","alpine","docker"],date:new Date("2021-11-17T23:24:45.000Z")},t,c={authorsImageUrls:[void 0]},d=[{value:"\uAC1C\uC694",id:"\uAC1C\uC694",level:2},{value:"\uD788\uC2A4\uD1A0\uB9AC",id:"\uD788\uC2A4\uD1A0\uB9AC",level:2},{value:"\uD14C\uC2A4\uD2B81",id:"\uD14C\uC2A4\uD2B81",level:2},{value:"node.12",id:"node12",level:3},{value:"node.13",id:"node13",level:3},{value:"\uACB0\uACFC1",id:"\uACB0\uACFC1",level:3},{value:"\uD14C\uC2A4\uD2B82",id:"\uD14C\uC2A4\uD2B82",level:2},{value:"alpine:3.13",id:"alpine313",level:3},{value:"\uACB0\uACFC2",id:"\uACB0\uACFC2",level:3},{value:"\uACB0\uB860",id:"\uACB0\uB860",level:2},{value:"\uCC38\uC870",id:"\uCC38\uC870",level:2}];function o(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"\uAC1C\uC694",children:"\uAC1C\uC694"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["docker nodejs base image \uC5D0 alpine3.13 \uC5D0 \uB300\uD55C \uC774\uBBF8\uC9C0\uAC00 \uC788\uC5B4\uC11C ",(0,s.jsx)(n.a,{href:"https://alpinelinux.org/posts/Alpine-3.13.0-released.html",children:"\uB9B4\uB9AC\uC988\uB178\uD2B8"}),"\uB97C \uD655\uC778\uD588\uB2E4."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Node.js (LTS) is compiled with -O2 instead of -Os which noticeably improves performance."})," \uB780 \uAD6C\uBB38\uC774 \uB208\uC5D0 \uB744\uC5C8\uB2E4."]}),"\n",(0,s.jsx)(n.li,{children:"noticeably improves \uB780 \uCD94\uC0C1\uC801\uC778 \uD45C\uD604\uC740 \uD638\uAE30\uC2EC\uC744 \uC790\uADF9\uD558\uAE30\uC5D0 \uCDA9\uBD84\uD588\uB2E4."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\uD788\uC2A4\uD1A0\uB9AC",children:"\uD788\uC2A4\uD1A0\uB9AC"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\uCC98\uC74C\uC5D0 \uBE4C\uB4DC \uD50C\uB798\uADF8 \uBCC0\uACBD\uC744 \uC81C\uC548\uD55C \uC0AC\uB78C\uC5D0 \uB530\uB974\uBA74, \uBE4C\uB4DC \uD50C\uB798\uADF8 \uC218\uC815\uC73C\uB85C ",(0,s.jsx)(n.a,{href:"https://lists.alpinelinux.org/~alpine/devel/%3C1593625212.dirkptm3b0.none%40localhost%3E",children:"15% speedup \uC774 \uC788\uC744 \uAC83"}),"\uC774\uB77C\uACE0 \uD558\uC600\uB2E4."]}),"\n",(0,s.jsxs)(n.li,{children:["\uC774\uC5D0 \uBA87\uBA87 \uC54C\uD30C\uC778 \uD328\uD0A4\uC9C0\uB4E4\uC774 O2 \uB85C \uC804\uD658\uB418\uC5C8\uACE0, Node.js\uB3C4 ",(0,s.jsx)(n.a,{href:"https://git.alpinelinux.org/aports/commit/?id=53dd8b58d838892bd9fe4849d7e239e0406e14eb",children:"2020-12-19 \uCEE4\uBC0B"}),"\uC5D0 \uD3EC\uD568\uB418\uC5C8\uB2E4."]}),"\n",(0,s.jsxs)(n.li,{children:["\uC5EC\uAE30\uC5D4 \uC544\uB798\uC640 \uAC19\uC740 \uCF54\uBA58\uD2B8\uAC00 \uB2EC\uB824\uC788\uACE0, ",(0,s.jsx)(n.a,{href:"https://github.com/v8/web-tooling-benchmark",children:"v8/web-tooling-benchmark"}),"\uB97C \uC0AC\uC6A9\uD55C \uAC83\uC73C\uB85C \uBCF4\uC600\uB2E4."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Compiling with O2 instead of Os increases binary size by ~10%\n# (53.1 MiB -> 58.6 MiB), but also increases performance by ~20%\n# according to v8/web-tooling-benchmark\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\uD14C\uC2A4\uD2B81",children:"\uD14C\uC2A4\uD2B81"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\uBE4C\uB4DC \uD50C\uB798\uADF8\uC758 \uBCC0\uACBD\uC73C\uB85C nodejs \uC720\uC800\uAC00 \uBCA0\uC774\uC2A4 \uC774\uBBF8\uC9C0\uC758 \uBC84\uC804\uC744 \uD558\uB098 \uC62C\uB824\uC8FC\uB294 \uAC83\uB9CC\uC73C\uB85C \uC5B4\uD50C\uB9AC\uCF00\uC774\uC158\uC758 \uC131\uB2A5\uC744 20% \uAE4C\uC9C0 \uC62C\uB9B4 \uC218 \uC788\uB2E4\uB294 \uC774\uC57C\uAE30\uB85C \uBCF4\uC600\uB2E4."}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/fastify/benchmarks",children:"fastify/benchmarks"})," \uB808\uD30C\uC9C0\uD1A0\uB9AC\uC758 ",(0,s.jsx)(n.a,{href:"https://github.com/fastify/benchmarks/blob/master/benchmarks/express.js",children:"Express.js"})," \uB97C \uC544\uB798\uCC98\uB7FC \uB3C4\uCEE4\uB77C\uC774\uC9D5\uD588\uB2E4."]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"node12",children:["node",":lts-alpine3",".12"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'# \uD14C\uC2A4\uD2B8 \uB2F9\uC2DC LTS === 14\nFROM node:lts-alpine3.12\n\nRUN mkdir -p /usr/src/app \\\n  && chown node:node -R /usr/src/app\n\nWORKDIR /usr/src/app\nCOPY --chown=node:node package*.json ./\n\nUSER node\nRUN npm install && npm cache clean --force\n\nCOPY --chown=node:node . .\nEXPOSE 3000\nCMD [ "node", "server.js" ]\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"node13",children:["node",":lts-alpine3",".13"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'# \uD14C\uC2A4\uD2B8 \uB2F9\uC2DC LTS === 14\nFROM node:lts-alpine3.13\n\nRUN mkdir -p /usr/src/app \\\n  && chown node:node -R /usr/src/app\n\nWORKDIR /usr/src/app\nCOPY --chown=node:node package*.json ./\n\nUSER node\nRUN npm install && npm cache clean --force\n\nCOPY --chown=node:node . .\nEXPOSE 3000\nCMD [ "node", "server.js" ]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\uACB0\uACFC1",children:"\uACB0\uACFC1"}),"\n",(0,s.jsx)(n.p,{children:"\uCEE8\uD14C\uC774\uB108\uB294 \uD14C\uC2A4\uD2B8\uB418\uB294 \uC774\uBBF8\uC9C0\uB9CC\uC744 \uB744\uC6E0\uACE0, docker 4CPUs, 6G RAM \uC5D0\uC11C \uC2E4\uD589\uD588\uB2E4."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"autocannon -c 100 -d 40 -p 10 localhost:3000"})}),"\n",(0,s.jsx)(n.p,{children:"\uBD80\uD47C \uAE30\uB300\uB9CC\uD07C \uACB0\uACFC\uAC00 \uAC19\uAC8C \uB098\uC654\uC73C\uBA74 \uC88B\uACA0\uC9C0\uB9CC \uACB0\uACFC \uCD94\uAC00\uB97C \uBABB\uD560\uB9CC\uD07C Latency, Req/Sec, Bytes/Sec \uBAA8\uB4E0 \uC218\uCE58\uC5D0\uC11C \uC5CE\uCE58\uB77D \uB4A4\uCE58\uB77D\uD558\uB294 \uBAA8\uC2B5\uC744 \uBCF4\uC600\uB2E4."}),"\n",(0,s.jsx)(n.h2,{id:"\uD14C\uC2A4\uD2B82",children:"\uD14C\uC2A4\uD2B82"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"noticeably improves \uB294 CPU intensive Task \uB97C \uBE44\uAD50\uD574\uBD10\uC57C\uD558\uB294 \uAC83\uC77C\uAE4C\uB780 \uC758\uBB38\uB9CC \uB0A8\uC558\uB2E4."}),"\n",(0,s.jsxs)(n.li,{children:["node official image \uB97C \uD655\uC778\uD574\uBCF4\uB2C8 ",(0,s.jsx)(n.a,{href:"https://github.com/nodejs/docker-node/blob/main/16/alpine3.13/Dockerfile",children:"nodejs.org\uC758 \uBC30\uD3EC\uBCF8"}),"\uC744 \uD480\uC5B4 \uC0AC\uC6A9\uD558\uB294 \uAC83\uC73C\uB85C \uBCF4\uC600\uB2E4."]}),"\n",(0,s.jsx)(n.li,{children:"\uB530\uB77C\uC11C \uC774\uBBF8\uC9C0\uB97C alpine \uD328\uD0A4\uC9C0\uB97C \uC0AC\uC6A9\uD560 \uC218 \uC788\uAC8C \uC7AC\uAD6C\uC131\uD558\uACE0 \uD14C\uC2A4\uD2B8\uD588\uB2E4."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"alpine313",children:"alpine:3.13"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'FROM alpine:3.13\n\nRUN apk add --update nodejs npm\nRUN addgroup -g 1000 node \\\n  && adduser -u 1000 -G node -s /bin/sh -D node \\\n  && mkdir -p /usr/src/app \\\n  && chown node:node -R /usr/src/app\n\nWORKDIR /usr/src/app\nCOPY --chown=node:node package*.json ./\n\nUSER node\nRUN npm install && npm cache clean --force\n\nCOPY --chown=node:node . .\nEXPOSE 3000\nCMD [ "node", "server.js" ]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\uACB0\uACFC2",children:"\uACB0\uACFC2"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\uB354 \uB290\uB838\uB2E4."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\uACB0\uB860",children:"\uACB0\uB860"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["noticeably improves, ~20% \uB780 \uBB38\uAD6C\uB85C \uC778\uD574 ",(0,s.jsx)(n.code,{children:"fastify/benchmarks"})," \uB85C\uC9C1\uC73C\uB85C \uB3C4\uCEE4\uB77C\uC774\uC9D5\uD558\uC5EC \uD14C\uC2A4\uD2B8\uD574\uBCF4\uC558\uC73C\uB098 \uBE44\uC2B7\uD55C \uD37C\uD3EC\uBA3C\uC2A4\uB97C \uBCF4\uC5EC\uC8FC\uC5C8\uB2E4."]}),"\n",(0,s.jsx)(n.li,{children:"\uC704\uC758 \uC218\uCE58\uB97C \uAC80\uC99D\uD560 \uC218 \uC788\uB294 \uD14C\uC2A4\uD2B8\uBCA0\uB4DC\uAC00 \uC788\uB2E4\uBA74 \uB3CC\uB824\uBCF4\uACE0 \uC2F6\uB2E4. (\uB9C1\uD06C \uC788\uC73C\uC2DC\uBA74 \uACF5\uC720\uBD80\uD0C1\uB4DC\uB9BD\uB2C8\uB2E4.)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\uCC38\uC870",children:"\uCC38\uC870"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Build flag \uBE44\uAD50: ",(0,s.jsx)(n.a,{href:"https://wiki.kldp.org/wiki.php/GccOptimizationOptions",children:"GCC Optimization Options"})]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://git.alpinelinux.org/aports/tree/main/nodejs/APKBUILD?h=3.13-stable",children:"alpine3.13 nodejs apkbuild"})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},28453(e,n,i){i.d(n,{R:()=>r,x:()=>t});var l=i(96540);let s={},a=l.createContext(s);function r(e){let n=l.useContext(a);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),l.createElement(a.Provider,{value:n},e.children)}},28999(e){e.exports=JSON.parse('{"permalink":"/2021/11/17/nodejs-alpine3-13-benchmark","source":"@site/blog/2021/11/17/nodejs-alpine3-13-benchmark.md","title":"nodejs alpine3.13 \uD14C\uC2A4\uD2B8","description":"\uAC1C\uC694","date":"2021-11-17T23:24:45.000Z","tags":[{"inline":false,"label":"javascript","permalink":"/tags/javascript","description":"Any application that can be written in JavaScript, will eventually be written in JavaScript"},{"inline":true,"label":"nodejs","permalink":"/tags/nodejs"},{"inline":true,"label":"alpine","permalink":"/tags/alpine"},{"inline":true,"label":"docker","permalink":"/tags/docker"}],"readingTime":2.41,"hasTruncateMarker":false,"authors":[{"name":"Eunkwang Shin","title":"Owner","url":"https://github.com/gracefullight","socials":{"linkedin":"https://www.linkedin.com/in/gracefullight/","github":"https://github.com/gracefullight","email":"mailto:gracefullight.dev@gmail.com"},"description":"Full Stack JavaScript Developer | Half-time Open Sourcerer.","page":{"permalink":"/authors/me"},"imageURL":"https://avatars.githubusercontent.com/u/11773683?v=4","key":"me"}],"frontMatter":{"title":"nodejs alpine3.13 \uD14C\uC2A4\uD2B8","authors":"me","tags":["javascript","nodejs","alpine","docker"],"date":"2021-11-17T23:24:45.000Z"},"unlisted":false,"prevItem":{"title":"feconf 2021","permalink":"/2021/12/02/feconf-2021"},"nextItem":{"title":"yarn berry \uB9C8\uC774\uADF8\uB808\uC774\uC158 \uCCB4\uD06C\uB9AC\uC2A4\uD2B8","permalink":"/2021/09/11/yarn-berry-\uB9C8\uC774\uADF8\uB808\uC774\uC158-\uCCB4\uD06C\uB9AC\uC2A4\uD2B8"}}')}}]);