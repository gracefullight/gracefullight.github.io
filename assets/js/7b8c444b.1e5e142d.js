"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([["23754"],{17235(e,n,l){l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});var i=l(93565),r=l(74848),s=l(28453);let a={title:"\uCFE0\uBC84\uB124\uD2F0\uC2A4 \uB864\uB9C1 \uC5C5\uB370\uC774\uD2B8\uC640 \uBC30\uD3EC",authors:"me",tags:["k8s","docker"],date:new Date("2019-12-27T20:43:20.000Z")},t,c={authorsImageUrls:[void 0]},d=[{value:"Deployment",id:"deployment",level:2},{value:"RollingUpdate",id:"rollingupdate",level:3},{value:"maxUnavailable",id:"maxunavailable",level:4},{value:"maxSurge",id:"maxsurge",level:4},{value:"Probe",id:"probe",level:3},{value:"livenessProbe",id:"livenessprobe",level:4},{value:"readinessProbe",id:"readinessprobe",level:4},{value:"\uC751\uB2F5 \uC911\uC778 \uD30C\uB4DC \uAD50\uCCB4",id:"\uC751\uB2F5-\uC911\uC778-\uD30C\uB4DC-\uAD50\uCCB4",level:3},{value:"\uD30C\uB4DC 1:1 \uAD50\uCCB4",id:"\uD30C\uB4DC-11-\uAD50\uCCB4",level:3},{value:"Blue/Green",id:"bluegreen",level:3}];function o(e){let n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"deployment",children:"Deployment"}),"\n",(0,r.jsxs)(n.p,{children:["Deployment \uC758 \uD30C\uB4DC \uAD50\uCCB4 \uC804\uB7B5\uC5D0\uB294 ",(0,r.jsx)(n.strong,{children:"RollingUpdate"})," \uC640 ",(0,r.jsx)(n.strong,{children:"Recreate"})," \uAC00 \uC788\uB2E4.\n\uAE30\uBCF8 \uAC12\uC740 ",(0,r.jsx)(n.strong,{children:"RollingUpdate"})," \uC774\uBA70 \uAC04\uB2E8\uD55C \uC124\uC815\uC774 \uC801\uC6A9\uB41C \uB514\uD50C\uB85C\uC774\uBA3C\uD2B8\uB294 \uC544\uB798\uC640 \uAC19\uC744 \uAC83\uC774\uB2E4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test-rolling-update\n  label:\n    app: test\nspec:\n  replicas: 4\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 3\n      maxSerge: 4\n  selector:\n    matchLabels:\n      app: test\n  template:\n    metadata:\n      labels:\n        app: test\n    spec:\n      containers:\n        - name: test\n          image: echo\n          ports:\n            - containerPort: 8080\n"})}),"\n",(0,r.jsx)(n.p,{children:"\uC5EC\uAE30\uC11C \uB864\uB9C1\uC5C5\uB370\uC774\uD2B8 \uC18D\uC131\uC744 \uC880 \uB354 \uC790\uC138\uD788 \uC54C\uC544\uBCF4\uC790."}),"\n",(0,r.jsx)(n.h3,{id:"rollingupdate",children:"RollingUpdate"}),"\n",(0,r.jsx)(n.h4,{id:"maxunavailable",children:"maxUnavailable"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uB864\uB9C1 \uC5C5\uB370\uC774\uD2B8 \uC911 \uB3D9\uC2DC\uC5D0 \uC0AD\uC81C\uD560 \uC218 \uC788\uB294 \uD30C\uB4DC\uC758 \uCD5C\uB300 \uAC2F\uC218"}),"\n",(0,r.jsx)(n.li,{children:"\uAE30\uBCF8 \uAC12\uC740 replicas\uC758 25% \uC774\uB2E4."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"replicas: 4"}),"\uC758 \uACBD\uC6B0 1\uAC1C \uD30C\uB4DC \uC0AD\uC81C, ",(0,r.jsx)(n.code,{children:"replicas: 8"}),"\uC758 \uACBD\uC6B0 2\uAC1C \uD30C\uB4DC \uB3D9\uC2DC \uC0AD\uC81C"]}),"\n",(0,r.jsx)(n.li,{children:"\uD37C\uC13C\uD2B8 \uBC0F \uC9C1\uC811 \uC9C0\uC815\uC774 \uAC00\uB2A5\uD558\uB2E4."}),"\n",(0,r.jsx)(n.li,{children:"\uC704\uC758 \uC608\uC2DC \uB514\uD50C\uB85C\uC774\uBA3C\uD2B8\uC5D0\uC11C \uB864\uB9C1\uC5C5\uB370\uC774\uD2B8 \uC2DC\uC791 \uC2DC \uD30C\uB4DC 3\uAC1C\uAC00 \uBC14\uB85C \uC8FD\uB294\uB2E4."}),"\n",(0,r.jsxs)(n.li,{children:["\uC774 \uAC12\uC744 \uB192\uAC8C \uC124\uC815\uD558\uBA74 \uB3D9\uC2DC\uC5D0 \uAD50\uCCB4\uB418\uB294 \uD30C\uB4DC\uAC00 \uB298\uC5B4\uB098\uBBC0\uB85C \uB864\uB9C1 \uC5C5\uB370\uC774\uD2B8 \uC2DC\uAC04\uC774 \uC904\uC5B4\uB4E0\uB2E4.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uD558\uC9C0\uB9CC \uB864\uB9C1\uC5C5\uB370\uC774\uD2B8 \uC911\uC5D0 \uB0A8\uC544 \uC788\uB294 \uD30C\uB4DC\uC5D0 \uC694\uCCAD \uC218\uAC00 \uBAB0\uB9B4 \uC218 \uC788\uB2E4."}),"\n",(0,r.jsxs)(n.li,{children:["\uB530\uB77C\uC11C ",(0,r.jsx)(n.code,{children:"1"}),"\uB85C \uC124\uC815\uD574 \uD30C\uB4DC\uB97C \uD558\uB098\uC529 \uAD50\uCCB4\uD558\uB294 \uAC83\uC774 \uC548\uC804\uD560 \uC218 \uC788\uB2E4."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"maxsurge",children:"maxSurge"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uB864\uB9C1 \uC5C5\uB370\uC774\uD2B8 \uC911 \uB3D9\uC2DC\uC5D0 \uC0DD\uC131\uD558\uB294 \uD30C\uB4DC \uAC2F\uC218"}),"\n",(0,r.jsx)(n.li,{children:"\uAE30\uBCF8 \uAC12\uC740 replicas\uC758 25% \uC774\uB2E4."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"replicas: 4"}),"\uBA74\uC11C ",(0,r.jsx)(n.code,{children:"maxSurge: 4"}),"\uBA74 \uB864\uB9C1 \uC5C5\uB370\uC774\uD2B8 \uC2DC\uC791 \uC2DC \uC0C8 \uBC84\uC804\uC758 \uD30C\uB4DC\uAC00 4\uAC1C \uCD94\uAC00\uB85C \uC0DD\uC131\uB41C\uB2E4."]}),"\n",(0,r.jsxs)(n.li,{children:["\uC774 \uAC12\uC744 \uB192\uAC8C \uC124\uC815\uD558\uBA74 \uD544\uC694\uD55C \uD30C\uB4DC\uB97C \uBE68\uB9AC \uC0DD\uC131\uD558\uBBC0\uB85C \uD30C\uB4DC \uAD50\uCCB4 \uC2DC\uAC04\uC774 \uB2E8\uCD95\uB41C\uB2E4.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uD558\uC9C0\uB9CC \uD544\uC694\uD55C \uC2DC\uC2A4\uD15C \uC790\uC6D0\uC774 \uAE09\uC99D\uD560 \uC218 \uC788\uB2E4."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"probe",children:"Probe"}),"\n",(0,r.jsxs)(n.p,{children:["\uC138\uBD80 \uC124\uC815\uC740 ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#configure-probes",children:"Docs"}),"\uB97C \uCC38\uC870\uD558\uC790"]}),"\n",(0,r.jsx)(n.h4,{id:"livenessprobe",children:"livenessProbe"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uC560\uD50C\uB9AC\uCF00\uC774\uC158 \uD5EC\uC2A4 \uCCB4\uD06C \uAE30\uB2A5"}),"\n",(0,r.jsx)(n.li,{children:"\uC560\uD50C\uB9AC\uCF00\uC774\uC158\uC774 \uC758\uC874\uD558\uB294 \uCEE8\uD14C\uC774\uB108 \uC548\uC758 \uD30C\uC77C\uC758 \uC874\uC7AC\uC5EC\uBD80 \uD655\uC778"}),"\n",(0,r.jsx)(n.li,{children:"Unhealthy \uC0C1\uD0DC\uC758 \uACBD\uC6B0 \uD30C\uB4DC \uC7AC\uC2DC\uC791"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"readinessprobe",children:"readinessProbe"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uCEE8\uD14C\uC774\uB108 \uC678\uBD80\uC5D0\uC11C HTTP \uB4F1\uC758 \uD2B8\uB798\uD53D\uC744 \uBC1C\uC0DD\uC2DC\uCF1C \uCC98\uB9AC\uD560 \uC218 \uC788\uB294 \uC0C1\uD0DC\uC778\uC9C0 \uD655\uC778"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tcpSocket"}),"\uC73C\uB85C \uD3EC\uD2B8 \uC9C0\uC815\uB3C4 \uAC00\uB2A5\uD558\uB2E4."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\uC751\uB2F5-\uC911\uC778-\uD30C\uB4DC-\uAD50\uCCB4",children:"\uC751\uB2F5 \uC911\uC778 \uD30C\uB4DC \uAD50\uCCB4"}),"\n",(0,r.jsxs)(n.p,{children:["\uC751\uB2F5 \uC911\uC778 \uD30C\uB4DC\uAC00 \uAD50\uCCB4\uB418\uB294 \uACBD\uC6B0 ",(0,r.jsx)(n.code,{children:"SIGTERM"})," \uC2E0\uD638\uB97C \uBCF4\uB0B4 \uD30C\uB4DC\uAC00 \uC0AD\uC81C\uB418\uB294\uB370,\n",(0,r.jsx)(n.code,{children:"Graceful Shutdown"})," \uC0C1\uD0DC\uB85C \uB9CC\uB4E4\uAE30 \uC704\uD574\uC11C \uC885\uB8CC \uCC98\uB9AC\uAC00 \uC624\uB798 \uAC78\uB9AC\uB294 \uD30C\uB4DC\uC5D4 ",(0,r.jsx)(n.strong,{children:"terminationGracePeriodSeconds"})," \uB97C \uC124\uC815\uD574\uC8FC\uB294 \uAC83\uC774 \uC88B\uB2E4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spec:\n  # \uAE30\uBCF8\uAC12 30\n  terminationGracePeriodSeconds: 40\n  containers:\n    - name: maria\n      image: maria:latest\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"Nginx"}),"\uCC98\uB7FC ",(0,r.jsx)(n.code,{children:"SIGTERM"})," \uC2DC\uADF8\uB110\uC744 \uBC1B\uACE0 \uBC14\uB85C \uC885\uB8CC\uB418\uB294 \uC5B4\uD50C\uB9AC\uCF00\uC774\uC158\uC774 \uC788\uB294 \uD30C\uB4DC\uB77C\uBA74, \uB77C\uC774\uD50C\uC0AC\uC774\uD074 \uD6C5\uC744 \uD65C\uC6A9\uD574 \uC548\uC804\uD558\uAC8C \uC885\uB8CC\uC2DC\uD0A4\uB294 \uAC83\uC774 \uC911\uC694\uD558\uB2E4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'spec:\n  containers:\n    - name: nginx\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n      lifecycle:\n        # \uD30C\uB4DC \uC885\uB8CC \uC804 \uD6C5\n        preStop:\n          exec:\n            command: ["/usr/sbin/nginx", "-s", "quit"]\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\uD30C\uB4DC-11-\uAD50\uCCB4",children:"\uD30C\uB4DC 1:1 \uAD50\uCCB4"}),"\n",(0,r.jsxs)(n.p,{children:["\uADF8\uB807\uB2E4\uBA74 ",(0,r.jsx)(n.code,{children:"replicas: 1"}),"\uC778 \uD30C\uB4DC\uB97C 1:1 \uAD50\uCCB4 \uC2DC\uC5D0\uB294 \uC5B4\uB5A4 \uC804\uB7B5\uC744 \uAC00\uC838\uAC00\uC57C\uD560\uAE4C\n\uB2F5\uC740 \uC544\uB798\uC640 \uAC19\uB2E4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"strategy:\n  type: RollingUpdate\n  rollingUpdate:\n    # \uB864\uB9C1 \uC5C5\uB370\uC774\uD2B8 \uC2DC \uC0AD\uC81C \uB418\uB294 \uD30C\uB4DC \uC218\n    maxUnavailable: 0\n    # \uB864\uB9C1 \uC5C5\uB370\uC774\uD2B8 \uC2DC \uC0C8\uB85C \uC0DD\uC131\uB418\uB294 \uD30C\uB4DC \uC218\n    maxSurge: 1\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\uC5EC\uAE30\uC5D0 \uD30C\uB4DC\uAC00 \uD2B8\uB798\uD53D\uC744 \uBC1B\uC744 \uC218 \uC788\uB294\uC9C0 ",(0,r.jsx)(n.code,{children:"readinessProbe"}),"\uB97C \uCD94\uAC00\uD574\uC8FC\uBA74 \uB41C\uB2E4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"readinessProbe:\n  httpGet:\n    path: /ping\n    port: 80\n  initialDelaySeconds: 5\n  periodSeconds: 5\n  successThreshold: 1\n  failureThreshold: 3\n  timeoutSeconds: 3\n"})}),"\n",(0,r.jsxs)(n.p,{children:["5\uCD08 \uD6C4\uC5D0 5\uCD08\uB9C8\uB2E4 ",(0,r.jsx)(n.code,{children:"/ping"})," \uC744 \uBCF4\uB0B4 \uC131\uACF5\uC5EC\uBD80\uB97C \uD655\uC778\uD55C\uB2E4.\n\uD0C0\uC784\uC544\uC6C3\uC740 3\uCD08\uBA70 3\uBC88\uAE4C\uC9C0 \uC7AC\uC2DC\uB3C4\uD55C\uB2E4."]}),"\n",(0,r.jsx)(n.h3,{id:"bluegreen",children:"Blue/Green"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uB514\uD50C\uB85C\uC774\uBA3C\uD2B8\uB97C 2\uAC1C \uB9CC\uB4E4\uACE0, \uC11C\uBE44\uC2A4\uC758 selector \uAC12\uC744 \uB77C\uBCA8\uC5D0 \uB530\uB77C \uBCC0\uACBD\uD558\uC790."}),"\n",(0,r.jsx)(n.li,{children:"\uC11C\uBE44\uC2A4\uBA54\uC2DC\uB97C \uC5F0\uB3D9\uD558\uBA74 \uCE74\uB098\uB9AC\uC544 \uBC30\uD3EC \uBC29\uC2DD\uB3C4 \uAC00\uB2A5\uD558\uB2E4."}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},28453(e,n,l){l.d(n,{R:()=>a,x:()=>t});var i=l(96540);let r={},s=i.createContext(r);function a(e){let n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}},93565(e){e.exports=JSON.parse('{"permalink":"/2019/12/27/kubernetes-rolling-update","source":"@site/blog/2019/12/27/kubernetes-rolling-update.md","title":"\uCFE0\uBC84\uB124\uD2F0\uC2A4 \uB864\uB9C1 \uC5C5\uB370\uC774\uD2B8\uC640 \uBC30\uD3EC","description":"Deployment","date":"2019-12-27T20:43:20.000Z","tags":[{"inline":true,"label":"k8s","permalink":"/tags/k-8-s"},{"inline":true,"label":"docker","permalink":"/tags/docker"}],"readingTime":2.22,"hasTruncateMarker":false,"authors":[{"name":"Eunkwang Shin","title":"Owner","url":"https://github.com/gracefullight","socials":{"linkedin":"https://www.linkedin.com/in/gracefullight/","github":"https://github.com/gracefullight","email":"mailto:gracefullight.dev@gmail.com"},"description":"Full Stack JavaScript Developer | Half-time Open Sourcerer.","page":{"permalink":"/authors/me"},"imageURL":"https://avatars.githubusercontent.com/u/11773683?v=4","key":"me"}],"frontMatter":{"title":"\uCFE0\uBC84\uB124\uD2F0\uC2A4 \uB864\uB9C1 \uC5C5\uB370\uC774\uD2B8\uC640 \uBC30\uD3EC","authors":"me","tags":["k8s","docker"],"date":"2019-12-27T20:43:20.000Z"},"unlisted":false,"prevItem":{"title":"Brew, \uB9E5 \uCD94\uCC9C \uD328\uD0A4\uC9C0","permalink":"/2019/12/29/mac-recommended-packages"},"nextItem":{"title":"Pythonic - \uAE30\uBCF8\uAE30","permalink":"/2019/12/15/Pythonic-the-basics"}}')}}]);