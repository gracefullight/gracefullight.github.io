"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([[70157],{47221:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>o,frontMatter:()=>t,metadata:()=>r,toc:()=>h});var l=a(11527),s=a(53363);const t={title:"SSHD \ubcf4\uc548 - fail2ban, port \ubcc0\uacbd",authors:"me",tags:["fail2ban","linux"],date:new Date("2017-09-22T07:50:15.000Z")},i="\uc2e4\ud328\ud55c \ub85c\uadf8\uc778 IP \ud655\uc778",r={permalink:"/2017/09/22/SSHD-\ubcf4\uc548-fail2ban-port-\ubcc0\uacbd",source:"@site/blog/2017/09/22/SSHD-\ubcf4\uc548-fail2ban-port-\ubcc0\uacbd.md",title:"SSHD \ubcf4\uc548 - fail2ban, port \ubcc0\uacbd",description:"\uae30\ubcf8 \ud3ec\ud2b8\ub97c \uc0ac\uc6a9 \uc911\uc774\ub77c\uba74 \uc5b4\ub9c8\uc5b4\ub9c8\ud55c IP \ubaa9\ub85d\uc774 \ub098\uc62c \uac83\uc774\ub2e4.",date:"2017-09-22T07:50:15.000Z",tags:[{label:"fail2ban",permalink:"/tags/fail-2-ban"},{label:"linux",permalink:"/tags/linux"}],readingTime:1.425,hasTruncateMarker:!1,authors:[{name:"Eunkwang Shin",title:"Owner",url:"https://github.com/gracefullight",imageURL:"https://avatars.githubusercontent.com/u/11773683?v=4",key:"me"}],frontMatter:{title:"SSHD \ubcf4\uc548 - fail2ban, port \ubcc0\uacbd",authors:"me",tags:["fail2ban","linux"],date:"2017-09-22T07:50:15.000Z"},unlisted:!1,prevItem:{title:"Alpine Linux AWS Cli \uc124\uce58",permalink:"/2017/09/22/Alpine-Linux-AWS-Cli-\uc124\uce58"},nextItem:{title:"\ucef4\ud4e8\ud130\uc2dc\uc2a4\ud15c\uad6c\uc870",permalink:"/2017/09/19/\ucef4\ud4e8\ud130\uc2dc\uc2a4\ud15c\uad6c\uc870"}},c={authorsImageUrls:[void 0]},h=[{value:"SSH \uc124\uc815 \ubcc0\uacbd",id:"ssh-\uc124\uc815-\ubcc0\uacbd",level:2},{value:"SElinux \ud3ec\ud2b8 \ucd94\uac00",id:"selinux-\ud3ec\ud2b8-\ucd94\uac00",level:2},{value:"\ubc29\ud654\ubcbd \ud3ec\ud2b8 \ucd94\uac00",id:"\ubc29\ud654\ubcbd-\ud3ec\ud2b8-\ucd94\uac00",level:2},{value:"SSH \uc7ac\uc2dc\uc791",id:"ssh-\uc7ac\uc2dc\uc791",level:2},{value:"\uc124\uce58",id:"\uc124\uce58",level:2},{value:"SSH \uc124\uc815 \ucd94\uac00",id:"ssh-\uc124\uc815-\ucd94\uac00",level:2},{value:"\uc11c\ube44\uc2a4 \uc2dc\uc791",id:"\uc11c\ube44\uc2a4-\uc2dc\uc791",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"$ cat /var/log/secure | grep 'sshd.*Failed' | grep -Po \"[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+\" | sort | uniq -c\n\n# \uc2e4\ud328 \uce74\uc6b4\ud2b8\uc640 IP\n6 100.34.214.24\n6 101.109.152.219\n6 101.164.141.36\n"})}),"\n",(0,l.jsx)(n.p,{children:"\uae30\ubcf8 \ud3ec\ud2b8\ub97c \uc0ac\uc6a9 \uc911\uc774\ub77c\uba74 \uc5b4\ub9c8\uc5b4\ub9c8\ud55c IP \ubaa9\ub85d\uc774 \ub098\uc62c \uac83\uc774\ub2e4."}),"\n",(0,l.jsx)(n.h1,{id:"ssh-\ud3ec\ud2b8-\ubcc0\uacbd",children:"SSH \ud3ec\ud2b8 \ubcc0\uacbd"}),"\n",(0,l.jsx)(n.h2,{id:"ssh-\uc124\uc815-\ubcc0\uacbd",children:"SSH \uc124\uc815 \ubcc0\uacbd"}),"\n",(0,l.jsx)(n.p,{children:"/etc/ssh/sshd_config \uc5d0 \ud3ec\ud2b8 \uc124\uc815\uc744 \ubcc0\uacbd\ud55c\ub2e4."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",metastring:'title="/etc/ssh/sshd_config"',children:"Port 2020\n"})}),"\n",(0,l.jsx)(n.h2,{id:"selinux-\ud3ec\ud2b8-\ucd94\uac00",children:"SElinux \ud3ec\ud2b8 \ucd94\uac00"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"$ semanage port -a -t ssh_port_t -p tcp 2020\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\ubc29\ud654\ubcbd-\ud3ec\ud2b8-\ucd94\uac00",children:"\ubc29\ud654\ubcbd \ud3ec\ud2b8 \ucd94\uac00"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"$ firewall-cmd --permanent --zone=public --add-port=2020/tcp\n$ firewall-cmd --reload\n"})}),"\n",(0,l.jsx)(n.h2,{id:"ssh-\uc7ac\uc2dc\uc791",children:"SSH \uc7ac\uc2dc\uc791"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"$ systemctl restart sshd\n"})}),"\n",(0,l.jsx)(n.h1,{id:"fail2ban",children:"Fail2ban"}),"\n",(0,l.jsx)(n.p,{children:"\uc77c\uc815 \uc2dc\ub3c4 \uc774\uc0c1\uc744 \uc2e4\ud328\ud558\uba74 \ud574\ub2f9 IP \ub97c \ucc28\ub2e8\uc2dc\ud0a4\ub294 Fail2ban \uc744 \uc124\uce58\ud558\uc790"}),"\n",(0,l.jsx)(n.h2,{id:"\uc124\uce58",children:"\uc124\uce58"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# repo\uac00 \uc5c6\ub2e4\uba74\n# $ yum install -y epel-release\n\n$ yum install -y fail2ban\n"})}),"\n",(0,l.jsx)(n.h2,{id:"ssh-\uc124\uc815-\ucd94\uac00",children:"SSH \uc124\uc815 \ucd94\uac00"}),"\n",(0,l.jsx)(n.p,{children:"/etc/fail2ban/jail.local \ub610\ub294 jail.conf \ub97c \uc5f4\uc5b4 [sshd] \uc758 enabled \uc18d\uc131\uc744 true \ub85c \ubcc0\uacbd\ud55c\ub2e4."}),"\n",(0,l.jsx)(n.h2,{id:"\uc11c\ube44\uc2a4-\uc2dc\uc791",children:"\uc11c\ube44\uc2a4 \uc2dc\uc791"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"$ systemctl enable fail2ban\n$ systemctl start fail2ban\n"})}),"\n",(0,l.jsx)(n.h1,{id:"\ub354-\uc26c\uc6b4-\ubc29\ubc95",children:"\ub354 \uc26c\uc6b4 \ubc29\ubc95"}),"\n",(0,l.jsx)(n.p,{children:"\uc258\uc2a4\ud06c\ub9bd\ud2b8\ub85c \ud3ec\ud2b8\ubcc0\uacbd, \ubc29\ud654\ubcbd \ub8f0 \ucd94\uac00, Fail2ban \uae4c\uc9c0 \ud55c \ubc29\uc5d0 \ub05d\ub0b4\ubc84\ub9ac\uc790."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"$ wget https://raw.githubusercontent.com/FunctionClub/Fail2ban/master/fail2ban.sh && bash fail2ban.sh 2>&1 | tee fail2ban.log\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\uba85\ub839\ubb38\uc5d0 \ub530\ub77c \uc785\ub825\ub9cc \ud574\uc8fc\uba74 \ub41c\ub2e4. \uc790\uc138\ud55c \uc124\uba85\uc740 ",(0,l.jsx)(n.a,{href:"https://github.com/FunctionClub/Fail2ban",children:"FunctionClub/Fail2ban"})," \ucc38\uace0\ud558\uc790."]})]})}function o(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},53363:(e,n,a)=>{a.d(n,{Z:()=>r,a:()=>i});var l=a(50959);const s={},t=l.createContext(s);function i(e){const n=l.useContext(t);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),l.createElement(t.Provider,{value:n},e.children)}}}]);