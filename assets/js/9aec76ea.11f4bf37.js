"use strict";(self.webpackChunkgracefullight_github_io=self.webpackChunkgracefullight_github_io||[]).push([[71050],{59754:(e,t,r)=>{r.d(t,{Zo:()=>s,kt:()=>d});var n=r(76687);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=n.createContext({}),u=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},s=function(e){var t=u(e.components);return n.createElement(i.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),h=u(r),d=a,m=h["".concat(i,".").concat(d)]||h[d]||c[d]||l;return r?n.createElement(m,o(o({ref:t},s),{},{components:r})):n.createElement(m,o({ref:t},s))}));function d(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=r.length,o=new Array(l);o[0]=h;var p={};for(var i in t)hasOwnProperty.call(t,i)&&(p[i]=t[i]);p.originalType=e,p.mdxType="string"==typeof e?e:a,o[1]=p;for(var u=2;u<l;u++)o[u]=r[u];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},82863:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>c,frontMatter:()=>l,metadata:()=>p,toc:()=>u});var n=r(96428),a=(r(76687),r(59754));const l={title:"Laravel 5.5\uc5d0 JWT (Json Web Token) Auth \ucd94\uac00\ud558\uae30",authors:"me",tags:["php","laravel","jwt","oauth2"],date:new Date("2017-11-03T07:59:40.000Z")},o=void 0,p={permalink:"/2017/11/03/Laravel-5-5-JWT-Auth-Guide",source:"@site/blog/2017/11/03/Laravel-5-5-JWT-Auth-Guide.md",title:"Laravel 5.5\uc5d0 JWT (Json Web Token) Auth \ucd94\uac00\ud558\uae30",description:"\uac80\uc0c9\ud574 \ub098\uc628 \ud3ec\uc2a4\ud2b8\ub4e4\uc740 5.4\ubc84\uc804\uc5d0 \ub300\ud574\uc11c\ub9cc \ub098\uc640\uc788\uc5b4\uc11c, 5.5\uc5d0\uc11c\ub294 \uc544\ubb34\uc9dd\uc5d0 \uc4f8\ubaa8\uac00 \uc5c6\uc5c8\ub2e4.",date:"2017-11-03T07:59:40.000Z",formattedDate:"November 3, 2017",tags:[{label:"php",permalink:"/tags/php"},{label:"laravel",permalink:"/tags/laravel"},{label:"jwt",permalink:"/tags/jwt"},{label:"oauth2",permalink:"/tags/oauth-2"}],readingTime:2.495,hasTruncateMarker:!1,authors:[{name:"Gracefullight",title:"Owner",url:"https://github.com/gracefullight",imageURL:"https://avatars.githubusercontent.com/u/11773683?v=4",key:"me"}],frontMatter:{title:"Laravel 5.5\uc5d0 JWT (Json Web Token) Auth \ucd94\uac00\ud558\uae30",authors:"me",tags:["php","laravel","jwt","oauth2"],date:"2017-11-03T07:59:40.000Z"},prevItem:{title:"Vue multi page app\uc5d0\uc11c \ucf54\ub4dc\uac00 \ubbf8\ub9ac\ubcf4\uc774\ub294 \ud604\uc0c1 \uc81c\uac70",permalink:"/2017/11/08/Vue-multi-page-app\uc5d0\uc11c-\ucf54\ub4dc\uac00-\ubbf8\ub9ac\ubcf4\uc774\ub294-\ud604\uc0c1-\uc81c\uac70"},nextItem:{title:"Docker jenkins \uc124\uce58\uc2dc permission \uc624\ub958",permalink:"/2017/10/28/Docker-jenkins-\uc124\uce58\uc2dc-permission-\uc624\ub958"}},i={authorsImageUrls:[void 0]},u=[{value:"jwt-auth",id:"jwt-auth",level:2},{value:"service provider \ub4f1\ub85d",id:"service-provider-\ub4f1\ub85d",level:2},{value:"\uc124\uc815\ud30c\uc77c publish",id:"\uc124\uc815\ud30c\uc77c-publish",level:2},{value:"secret key \uc0dd\uc131",id:"secret-key-\uc0dd\uc131",level:2},{value:"API Route \uc124\uc815",id:"api-route-\uc124\uc815",level:2},{value:"Member Model \uc124\uc815",id:"member-model-\uc124\uc815",level:2},{value:"login",id:"login",level:2},{value:"Authorized Routes",id:"authorized-routes",level:2},{value:"Accept Header",id:"accept-header",level:3},{value:"token \ud0dc\uc6b0\uae30",id:"token-\ud0dc\uc6b0\uae30",level:3},{value:"routes",id:"routes",level:3},{value:"logout",id:"logout",level:2},{value:"refresh",id:"refresh",level:2}],s={toc:u};function c(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},s,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"\uac80\uc0c9\ud574 \ub098\uc628 \ud3ec\uc2a4\ud2b8\ub4e4\uc740 5.4\ubc84\uc804\uc5d0 \ub300\ud574\uc11c\ub9cc \ub098\uc640\uc788\uc5b4\uc11c, 5.5\uc5d0\uc11c\ub294 \uc544\ubb34\uc9dd\uc5d0 \uc4f8\ubaa8\uac00 \uc5c6\uc5c8\ub2e4.\n\ub77c\ub77c\ubca8\uc5d0\uc11c \uc883\uc778\uc99d\uc744 \uc2dc\uc791\ud574\ubcf4\uc790."),(0,a.kt)("h1",{id:"\uc124\uce58"},"\uc124\uce58"),(0,a.kt)("h2",{id:"jwt-auth"},"jwt-auth"),(0,a.kt)("p",null,"171103 \uae30\uc900\uc73c\ub85c dev-develop \ubc84\uc804\uc758 \ud328\ud0a4\uc9c0\ub97c \uc124\uce58\ud574\uc57c\ud55c\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ composer require tymon/jwt-auth:1.0.0-rc.1\n")),(0,a.kt)("h2",{id:"service-provider-\ub4f1\ub85d"},"service provider \ub4f1\ub85d"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="config/app.php"',title:'"config/app.php"'},"<?php\n\n'providers' => [\n  ...\n  Tymon\\JWTAuth\\Providers\\LaravelServiceProvider::class,\n],\n\n'alias' => [\n  ...\n  'JWTAuth' => Tymon\\JWTAuth\\Facades\\JWTAuth::class\n],\n")),(0,a.kt)("h2",{id:"\uc124\uc815\ud30c\uc77c-publish"},"\uc124\uc815\ud30c\uc77c publish"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'$ php artisan vendor:publish --provider="Tymon\\JWTAuth\\Providers\\LaravelServiceProvider" --force\n')),(0,a.kt)("h2",{id:"secret-key-\uc0dd\uc131"},"secret key \uc0dd\uc131"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ php artisan jwt:secret\n")),(0,a.kt)("h1",{id:"\uc5f0\ub3d9"},"\uc5f0\ub3d9"),(0,a.kt)("h2",{id:"api-route-\uc124\uc815"},"API Route \uc124\uc815"),(0,a.kt)("p",null,"API \uac00\ub4dc\uc640 \uc720\uc800 \ubaa8\ub378\uc744 \uc124\uc815\ud558\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="config/auth.php"',title:'"config/auth.php"'},"<?php\nreturn [\n  'defaults' => [\n    'guard' => 'api', // \uae30\ubcf8 \uac00\ub4dc\ub97c api\ub85c \ubcc0\uacbd\n    'passwords' => 'users',\n  ],\n\n  'guards' => [\n    ...\n    'api' => [\n      'driver' => 'jwt', // api \uac00\ub4dc\ub97c jwt \uc778\uc99d\uc744 \uc0ac\uc6a9\n      'provider' => 'users',\n    ],\n  ],\n\n  'providers' => [\n    'users' => [\n      'driver' => 'eloquent',\n      'model' => App\\Models\\Member::class, // \uc720\uc800 \ubaa8\ub378\uc744 \ud574\ub2f9 \ubaa8\ub378\ub85c \ubcc0\uacbd\n    ],\n  ],\n  ...\n];\n")),(0,a.kt)("h2",{id:"member-model-\uc124\uc815"},"Member Model \uc124\uc815"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="app/Models/Member.php"',title:'"app/Models/Member.php"'},"<?php\n...\n// jwt\ub97c \ubaa8\ub378\uc5d0\uc11c \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 \ucd94\uac00\ud55c\ub2e4.\nuse Illuminate\\Foundation\\Auth\\User as Authenticatable;\nuse Tymon\\JWTAuth\\Contracts\\JWTSubject;\n...\n\nclass Member extends Authenticatable implements JWTSubject\n{\n  // \uc544\ub798 \ub450 \uba54\uc18c\ub4dc\uac00 \uad6c\ud604\ub418\uc5b4\uc57c \uc2e4\ud589\ub41c\ub2e4.\n  public function getJWTIdentifier() {\n    return $this->getKey();\n  }\n\n  public function getJWTCustomClaims() {\n    return [];\n  }\n}\n")),(0,a.kt)("h1",{id:"\uc0ac\uc6a9\ud558\uae30"},"\uc0ac\uc6a9\ud558\uae30"),(0,a.kt)("h2",{id:"login"},"login"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="app/Http/MemberController.php"',title:'"app/Http/MemberController.php"'},"<?php\npublic function login(Request $request) {\n  $credentials = $this->validate($request, [\n    'id' => 'required|string',\n    'password' => 'required|string'\n  ]);\n\n  if ($token = $this->guard()->attempt($credentials)) {\n    return $this->respondWithToken($token);\n  }\n\n  return response()->json(['message' => 'Unauthorized'], 401);\n}\n\nprotected function respondWithToken($token) {\n  return response()->json([\n    'access_token' => $token,\n    'token_type' => 'bearer',\n    'expires_in' => $this->guard()->factory()->getTTL() * 60\n  ]);\n}\n\npublic function guard() {\n  return Auth::guard();\n}\n")),(0,a.kt)("h2",{id:"authorized-routes"},"Authorized Routes"),(0,a.kt)("h3",{id:"accept-header"},"Accept Header"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"application/json")," \ub85c \uc124\uc815\ud574\uc57c \uc624\ub958\uac00 \uc608\uc058\uac8c \ubc18\ud658\ub41c\ub2e4.")),(0,a.kt)("h3",{id:"token-\ud0dc\uc6b0\uae30"},"token \ud0dc\uc6b0\uae30"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# header \uc774\uc6a9\ud55c \ubc29\ubc95\nAuthorization: Bearer yourtokens...\n\n# Querystring\uc73c\ub85c\ub3c4 \uc778\uc99d \uac00\ub2a5\nhttps://gracefullight.github.io/me?token=yourtokens...\n")),(0,a.kt)("h3",{id:"routes"},"routes"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="routes/api.php"',title:'"routes/api.php"'},"Route::group(['middleware' => 'auth:api'], function() {\n  Route::get('member/logout', 'MemberController@logout');\n  Route::get('member/me', 'MemberController@me');\n});\n")),(0,a.kt)("h2",{id:"logout"},"logout"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="app/Http/MemberController.php"',title:'"app/Http/MemberController.php"'},"<?php\npublic function logout(Request $request) {\n  $this->guard()->logout();\n  return response(null, 204);\n}\n")),(0,a.kt)("h2",{id:"refresh"},"refresh"),(0,a.kt)("p",null,"refresh\ub294 auth:api \ubbf8\ub4e4\uc6e8\uc5b4 \uc5c6\uc774 \ucc98\ub9ac\ub418\uc5b4\uc57c\ud55c\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="app/Http/MemberController.php"',title:'"app/Http/MemberController.php"'},"<?php\npublic function refresh() {\n  return $this->respondWithToken($this->guard()->refresh());\n}\n")),(0,a.kt)("h1",{id:"\uc5ec\ub2f4"},"\uc5ec\ub2f4"),(0,a.kt)("p",null,"Expired\uac70\ub098 Unauthoriezed\uacbd\uc6b0 status code\ub85c \uccb4\ud06c\ud558\uba74 \ub41c\ub2e4.\n5.5\ubc84\uc804 \uba54\ub274\uc5bc\uc774 \ubd80\uc871\ud558\ub2e4."))}c.isMDXComponent=!0}}]);